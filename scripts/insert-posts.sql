-- Supabase Dashboard > SQL Editorì—ì„œ ì‹¤í–‰

-- í¬ìŠ¤íŠ¸ 1: MFA ê°œìš”
INSERT INTO blog_posts (
  title,
  slug,
  content,
  excerpt,
  status,
  is_featured,
  is_pinned,
  user_id,
  published_at,
  created_at,
  updated_at
) VALUES (
  'ëª¨ë†€ë¦¬ì‹ì˜ í•œê³„ë¥¼ ë„˜ì–´ì„œ - ì™œ ë§ˆì´í¬ë¡œ í”„ë¡ íŠ¸ì—”ë“œë¥¼ ì„ íƒí–ˆëŠ”ê°€',
  'mfa-why-micro-frontend-' || extract(epoch from now())::bigint,
  '# ëª¨ë†€ë¦¬ì‹ì˜ í•œê³„ë¥¼ ë„˜ì–´ì„œ - ì™œ ë§ˆì´í¬ë¡œ í”„ë¡ íŠ¸ì—”ë“œë¥¼ ì„ íƒí–ˆëŠ”ê°€

## ì„œë¡ : ì´ ê¸€ì„ ì“°ëŠ” ì´ìœ 

ê¸°ìˆ  ë¸”ë¡œê·¸ì—ëŠ” ë‘ ì¢…ë¥˜ê°€ ìˆë‹¤ê³  ìƒê°í•¨.

í•˜ë‚˜ëŠ” "ì´ë ‡ê²Œ í•˜ë©´ ë©ë‹ˆë‹¤" ë¥˜ì˜ íŠœí† ë¦¬ì–¼.
ë‹¤ë¥¸ í•˜ë‚˜ëŠ” "ì™œ ì´ë ‡ê²Œ í–ˆê³ , ê·¸ ê³¼ì •ì—ì„œ ë­˜ ë°°ì› ëŠ”ê°€"ë¥¼ ë‹´ì€ íšŒê³ .

ì´ ê¸€ì€ í›„ìì„.

ë§ˆì´í¬ë¡œ í”„ë¡ íŠ¸ì—”ë“œë¥¼ ì ìš©í•˜ë©´ì„œ ê²ªì€ ì‚½ì§ˆ, ê³ ë¯¼, ê¹¨ë‹¬ìŒì„ ì†”ì§í•˜ê²Œ ê³µìœ í•˜ë ¤ê³  í•¨. ì™„ë²½í•œ ì •ë‹µì´ ì•„ë‹˜. ë‚˜ì˜ ìƒí™©ì—ì„œ ë‚˜ì˜ ì„ íƒì´ì—ˆì„ ë¿ì„.

## 1. ë¬¸ì œì˜ ì‹œì‘: ëª¨ë†€ë¦¬ì‹ì˜ ë‹¬ì½¤í•¨

### 1-1. ì²˜ìŒì—ëŠ” ì¢‹ì•˜ìŒ

2024ë…„ ì´ˆ, ê°œì¸ í¬íŠ¸í´ë¦¬ì˜¤ í”„ë¡œì íŠ¸ë¥¼ ì‹œì‘í•¨. ì´ë ¥ì„œ, ë¸”ë¡œê·¸, í¬íŠ¸í´ë¦¬ì˜¤ ì„¸ ê¸°ëŠ¥ì„ í•˜ë‚˜ì˜ ì•±ìœ¼ë¡œ ë§Œë“¤ì—ˆìŒ.

```
portfolio-app/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”œâ”€â”€ resume/
â”‚   â”‚   â”œâ”€â”€ blog/
â”‚   â”‚   â””â”€â”€ portfolio/
```

ëª¨ë†€ë¦¬ì‹ì˜ ì¥ì ì€ ë¶„ëª…í–ˆìŒ:
- ì„¤ì • í•˜ë‚˜ë©´ ë
- ì½”ë“œ ê³µìœ  ì‰¬ì›€
- ë°°í¬ ë‹¨ìˆœí•¨

3ê°œì›”ê°„ì€ í–‰ë³µí–ˆìŒ.

### 1-2. ê·¸ëŸ°ë° ìŠ¬ìŠ¬ ë¶ˆí¸í•´ì§

**ë¹Œë“œ ì‹œê°„**
```bash
# ì²˜ìŒ: 45ì´ˆ
# 3ê°œì›” í›„: 3ë¶„ 20ì´ˆ
# 6ê°œì›” í›„: 7ë¶„ 15ì´ˆ
```

ë¸”ë¡œê·¸ì— TipTap ì—ë””í„°ë¥¼ ì¶”ê°€í•˜ê³ , í¬íŠ¸í´ë¦¬ì˜¤ì— Three.jsë¥¼ ë„£ìœ¼ë‹ˆê¹Œ ë¹Œë“œ ì‹œê°„ì´ ê¸°í•˜ê¸‰ìˆ˜ì ìœ¼ë¡œ ëŠ˜ì–´ë‚¨.

ì»¤í”¼ ë§ˆì‹œê³  ì™€ë„ ì•„ì§ ë¹Œë“œ ì¤‘ì´ì—ˆìŒ.

**CSS ì¶©ëŒ**
```css
/* resume/Skills.css */
.card { padding: 20px; }
/* ì´ê²Œ ë¸”ë¡œê·¸ì˜ .cardë„ ì˜í–¥ì„ ì¤Œ */
```

ì´ë ¥ì„œ ìŠ¤íƒ€ì¼ ìˆ˜ì •í–ˆëŠ”ë° ë¸”ë¡œê·¸ê°€ ê¹¨ì§. ì‚¬ì†Œí•˜ì§€ë§Œ ì§œì¦ë‚˜ëŠ” ë¬¸ì œì˜€ìŒ.

**ì˜ì¡´ì„± ì§€ì˜¥**
```json
{
  "dependencies": {
    "@tiptap/react": "^2.0.0",
    "three": "^0.150.0",
    // ... 60ê°œê°€ ë„˜ëŠ” ì˜ì¡´ì„±
  }
}
```

node_modulesê°€ 800MBë¥¼ ë„˜ìŒ. ì´ë ¥ì„œë§Œ ìˆ˜ì •í•˜ê³  ì‹¶ì€ë° ì™œ TipTapì„ ì„¤ì¹˜í•´ì•¼ í•˜ëŠ”ì§€ ì˜ë¬¸ì´ ë“¤ê¸° ì‹œì‘í•¨.

### 1-3. ê³ ì°°: ëª¨ë†€ë¦¬ì‹ì˜ ë³¸ì§ˆì  í•œê³„

ì—¬ê¸°ì„œ ì ì‹œ ë©ˆì¶”ê³  ìƒê°í•´ë´„.

ëª¨ë†€ë¦¬ì‹ì´ ë‚˜ìœ ê±´ê°€? ì•„ë‹˜. ëª¨ë†€ë¦¬ì‹ì€ **íŠ¹ì • ìƒí™©ì—ì„œ** ìµœì ì˜ ì„ íƒì„.

- íŒ€ì´ ì‘ì„ ë•Œ
- ê¸°ëŠ¥ ê°„ ê²°í•©ë„ê°€ ë†’ì„ ë•Œ
- ë¹ ë¥´ê²Œ MVPë¥¼ ë§Œë“¤ì–´ì•¼ í•  ë•Œ

ë¬¸ì œëŠ” **ìƒí™©ì´ ë³€í–ˆëŠ”ë° êµ¬ì¡°ëŠ” ê·¸ëŒ€ë¡œ**ì˜€ë‹¤ëŠ” ê²ƒì„.

ë‚´ í”„ë¡œì íŠ¸ëŠ”:
- ì„¸ ê¸°ëŠ¥ì˜ ê°œë°œ ì‚¬ì´í´ì´ ì™„ì „íˆ ë‹¤ë¦„ (ì´ë ¥ì„œëŠ” 1ë…„ì— ëª‡ ë²ˆ, ë¸”ë¡œê·¸ëŠ” ë§¤ì£¼)
- ê¸°ëŠ¥ ê°„ ê²°í•©ë„ê°€ ë‚®ìŒ (ì´ë ¥ì„œì™€ ë¸”ë¡œê·¸ëŠ” ì„œë¡œë¥¼ ëª°ë¼ë„ ë¨)
- ê° ê¸°ëŠ¥ì˜ ê¸°ìˆ  ìŠ¤íƒì´ ë‹¤ë¦„ (ë¸”ë¡œê·¸ëŠ” ì—ë””í„°, í¬íŠ¸í´ë¦¬ì˜¤ëŠ” 3D)

**êµ¬ì¡°ì™€ ìƒí™©ì˜ ë¶ˆì¼ì¹˜**ê°€ ê³ í†µì˜ ì›ì¸ì´ì—ˆìŒ.

ì´ê±¸ ê¹¨ë‹«ëŠ” ë° 3ê°œì›”ì´ ê±¸ë ¸ìŒ. ì²˜ìŒë¶€í„° ì•Œì•˜ìœ¼ë©´ ì¢‹ì•˜ê² ì§€ë§Œ, ì§ì ‘ ê²ªì–´ë´ì•¼ ì•„ëŠ” ê²ƒë“¤ì´ ìˆìŒ.

## 2. ê²°ì •ì  ê³„ê¸°: ì‹¤ë¬´ ê²½í—˜

### 2-1. KOMCA í”„ë¡œì íŠ¸

íšŒì‚¬ì—ì„œ KOMCA(í•œêµ­ìŒì•…ì €ì‘ê¶Œí˜‘íšŒ) í”„ë¡œì íŠ¸ë¥¼ 6ê°œì›”ê°„ ì§„í–‰í•¨. Admin, User, Container ì„¸ ì•±ì„ ë§ˆì´í¬ë¡œ í”„ë¡ íŠ¸ì—”ë“œë¡œ êµ¬ì„±í•œ ì‹¤ë¬´ í”„ë¡œì íŠ¸ì˜€ìŒ.

```
komca/
â”œâ”€â”€ container/     # Host
â”œâ”€â”€ admin/         # Remote
â”œâ”€â”€ user/          # Remote
â””â”€â”€ lib/           # ê³µí†µ
```

ì²˜ìŒì—ëŠ” "ì™œ ì´ë ‡ê²Œ ë³µì¡í•˜ê²Œ í•˜ì§€?" ì‹¶ì—ˆìŒ. ì„¤ì •ë„ ë§ê³ , íŒŒì¼ë„ ë§ê³ .

ê·¸ëŸ°ë° 3ê°œì›”ì¯¤ ì§€ë‚˜ë‹ˆê¹Œ ê¹¨ë‹¬ìŒì´ ì™”ìŒ.

- Admin ìˆ˜ì •í•´ë„ UserëŠ” ì˜í–¥ ì—†ìŒ
- Adminë§Œ ë°°í¬í•˜ë©´ ë
- Admin ë¹Œë“œ 30ì´ˆ

**"ì•„... ì´ê²Œ ë¶„ë¦¬ì˜ í˜ì´êµ¬ë‚˜."**

### 2-2. ê³ ì°°: ê²½í—˜ ì—†ì´ëŠ” ì´í•´ ëª» í•¨

ì†”ì§íˆ ë§í•˜ë©´, KOMCA ì „ì— ë§ˆì´í¬ë¡œ í”„ë¡ íŠ¸ì—”ë“œ ê¸€ì„ ì½ì–´ë„ ì™€ë‹¿ì§€ ì•Šì•˜ìŒ.

"êµ³ì´ ì™œ ë‚˜ëˆ„ì§€? ë³µì¡í•˜ê¸°ë§Œ í•˜ì–ì•„."

ì´ê²Œ ë‹¹ì‹œ ë‚´ ìƒê°ì´ì—ˆìŒ.

ê·¸ëŸ°ë° ì§ì ‘ 6ê°œì›” ë™ì•ˆ ì¨ë³´ë‹ˆê¹Œ ë‹¬ëìŒ. ê¸€ë¡œ ì½ëŠ” ê²ƒê³¼ ì§ì ‘ ê²ªëŠ” ê²ƒì€ ì™„ì „íˆ ë‹¤ë¥¸ ì°¨ì›ì˜ ì´í•´ì„.

ì´ê±´ ê°œë°œë¿ ì•„ë‹ˆë¼ ëª¨ë“  ë¶„ì•¼ì— ì ìš©ë˜ëŠ” ê²ƒ ê°™ìŒ. **ê²½í—˜í•˜ì§€ ì•Šìœ¼ë©´ ì§„ì •ìœ¼ë¡œ ì´í•´í•  ìˆ˜ ì—†ìŒ.**

## 3. ê¸°ìˆ  ì„ íƒì˜ ê³¼ì •

### 3-1. í›„ë³´êµ° ë¶„ì„

ë§ˆì´í¬ë¡œ í”„ë¡ íŠ¸ì—”ë“œë¥¼ êµ¬í˜„í•˜ëŠ” ë°©ë²•ì€ ì—¬ëŸ¬ ê°€ì§€ì„.

**iframe**
- ì™„ë²½í•œ ê²©ë¦¬
- í•˜ì§€ë§Œ ì„±ëŠ¥ ì €í•˜, í†µì‹  ë³µì¡, SEO ë¶ˆë¦¬

"ë ˆê±°ì‹œ ì‹œìŠ¤í…œ í†µí•©ì—ë‚˜ ì í•©í•˜ì§€ ì•Šì„ê¹Œ?" ë¼ê³  ìƒê°í•¨. Pass.

**Single-SPA**
- í”„ë ˆì„ì›Œí¬ ë¬´ê´€ (React, Vue, Angular í˜¼ìš© ê°€ëŠ¥)
- í•˜ì§€ë§Œ ì„¤ì • ë³µì¡, Reactë§Œ ì“¸ ê±´ë° ì˜¤ë²„í‚¬

"ì—¬ëŸ¬ í”„ë ˆì„ì›Œí¬ ì„ì„ ì¼ ì—†ëŠ”ë° êµ³ì´?" Pass.

**Module Federation**
- Webpack 5 ë‚´ì¥
- ëŸ°íƒ€ì„ ì½”ë“œ ê³µìœ 
- KOMCAì—ì„œ ê²€ì¦ë¨

"ì´ë¯¸ ì¨ë´¤ê³ , ì˜ ë™ì‘í•˜ëŠ” ê±° í™•ì¸í•¨." ì„ íƒ.

### 3-2. ê³ ì°°: ê¸°ìˆ  ì„ íƒì˜ ê¸°ì¤€

**ê¸°ìˆ  ì„ íƒì˜ ê¸°ì¤€ì€ ë­ê°€ ë˜ì–´ì•¼ í• ê¹Œ?**

í”íˆ í•˜ëŠ” ì‹¤ìˆ˜:
- "ìš”ì¦˜ ëœ¨ëŠ” ê±°ë‹ˆê¹Œ" (íŠ¸ë Œë“œ)
- "ìƒˆë¡œ ë‚˜ì˜¨ ê±°ë‹ˆê¹Œ" (ì‹ ê¸°ìˆ )
- "ë‹¤ë“¤ ì“°ë‹ˆê¹Œ" (ìœ í–‰)

ë‚´ê°€ ì„¸ìš´ ê¸°ì¤€:
1. **ê²€ì¦ë¨**: ì‹¤ë¬´ì—ì„œ ì¨ë´¤ê±°ë‚˜, ì»¤ë®¤ë‹ˆí‹°ì—ì„œ ì¶©ë¶„íˆ ê²€ì¦ë¨
2. **ì í•©í•¨**: ë‚´ ìƒí™©ì— ë§ìŒ
3. **ìœ ì§€ë³´ìˆ˜ ê°€ëŠ¥í•¨**: í˜¼ìì„œë„ ê´€ë¦¬ ê°€ëŠ¥í•œ ë³µì¡ë„

**íŠ¸ë Œë“œë³´ë‹¤ ì•ˆì •ì„±. í˜¸ê¸°ì‹¬ë³´ë‹¤ ì‹¤ìš©ì„±.**

ì´ê²Œ ë‚´ê°€ ë°°ìš´ ê¸°ìˆ  ì„ íƒì˜ ì›ì¹™ì„.

### 3-3. ê³ ì°°: ì˜¤ë²„ì—”ì§€ë‹ˆì–´ë§ì— ëŒ€í•˜ì—¬

ì†”ì§íˆ ë§í•˜ë©´, ê°œì¸ í¬íŠ¸í´ë¦¬ì˜¤ì— ë§ˆì´í¬ë¡œ í”„ë¡ íŠ¸ì—”ë“œëŠ” **ì˜¤ë²„ì—”ì§€ë‹ˆì–´ë§**ì„.

í˜¼ì ê°œë°œí•˜ëŠ” ì‘ì€ í”„ë¡œì íŠ¸ì— Host, Remote1, Remote2, Remote3, lib... 5ê°œ í”„ë¡œì íŠ¸ë¥¼ ë§Œë“¤ë‹¤ë‹ˆ.

ê·¸ëŸ°ë°ë„ ì„ íƒí•œ ì´ìœ ê°€ ìˆìŒ:

1. **í•™ìŠµ ëª©ì **: ì‹¤ë¬´ì—ì„œ ë°°ìš´ ê±¸ ë‚´ ê²ƒìœ¼ë¡œ ë§Œë“¤ê³  ì‹¶ì—ˆìŒ
2. **í¬íŠ¸í´ë¦¬ì˜¤**: "MFA êµ¬ì¶• ê²½í—˜ ìˆìŒ" ì–´í•„
3. **ì‹¤í—˜ì¥**: ì‹¤ë¬´ì—ì„œ ëª» í•´ë³¸ ê²ƒë“¤ ì‹œë„

**ì˜¤ë²„ì—”ì§€ë‹ˆì–´ë§ì´ í•­ìƒ ë‚˜ìœ ê±´ ì•„ë‹˜.** ëª©ì ì´ ìˆë‹¤ë©´.

## 4. ì•„í‚¤í…ì²˜ ì„¤ê³„

### 4-1. êµ¬ì¡°

```
mfa/
â”œâ”€â”€ host/           # Container (Port 3000)
â”œâ”€â”€ remote1/        # Resume (Port 3001)
â”œâ”€â”€ remote2/        # Blog (Port 3002)
â”œâ”€â”€ remote3/        # Portfolio (Port 3003)
â””â”€â”€ lib/            # ê³µí†µ ë¼ì´ë¸ŒëŸ¬ë¦¬ (NPM ë°°í¬)
```

### 4-2. Hub-Spoke êµ¬ì¡° ì„ íƒ

```
       Remote1
         â†‘
Host â† â†’ Remote2
         â†“
       Remote3
```

Remoteë“¤ì´ ì„œë¡œ í†µì‹ í•˜ëŠ” P2P êµ¬ì¡°ë„ ê³ ë ¤í–ˆì§€ë§Œ í¬ê¸°í•¨.

ì´ìœ :
- ì˜ì¡´ì„± ë³µì¡í•´ì§
- ìˆœí™˜ ì°¸ì¡° ìœ„í—˜
- ë””ë²„ê¹… ì•…ëª½

Hostê°€ ëª¨ë“  ê²ƒì„ ê´€ì¥í•˜ëŠ” Hub-Spoke êµ¬ì¡°ê°€ ë‹¨ìˆœí•˜ê³  ëª…í™•í•¨.

**ê³ ì°°: ë‹¨ìˆœí•¨ì˜ ê°€ì¹˜**

ê°œë°œí•˜ë‹¤ ë³´ë©´ "ì´ê²ƒë„ ë„£ê³  ì €ê²ƒë„ ë„£ê³ " í•˜ê³  ì‹¶ì–´ì§.

ê·¸ëŸ°ë° ê²½í—˜ìƒ **ë‹¨ìˆœí•œ êµ¬ì¡°ê°€ ì˜¤ë˜ ê°.**

**ì²˜ìŒë¶€í„° ì™„ë²½í•˜ë ¤ê³  í•˜ì§€ ë§ ê²ƒ.** ë‹¨ìˆœí•˜ê²Œ ì‹œì‘í•˜ê³ , í•„ìš”í•  ë•Œ í™•ì¥í•˜ëŠ” ê²Œ ë§ìŒ.

## 5. ì‚½ì§ˆê³¼ ê¹¨ë‹¬ìŒ

### 5-1. ì‚½ì§ˆ 1: Shared Dependencies

**ë¬¸ì œ:**
Reactê°€ ë‘ ë²ˆ ë¡œë“œë˜ì–´ hooks ì—ëŸ¬ ë°œìƒ.

```
Error: Invalid hook call.
You might have more than one copy of React in the same app
```

**í•´ê²°:**
```javascript
shared: {
  react: {
    singleton: true,  // í•µì‹¬!
  },
}
```

**ê³ ì°°: ë¬¸ì„œë¥¼ "ì½ëŠ” ê²ƒ"ê³¼ "ì´í•´í•˜ëŠ” ê²ƒ"ì€ ë‹¤ë¦„.**

ê·¸ë˜ì„œ **ì‚½ì§ˆì´ ì¤‘ìš”í•¨.** ì‚½ì§ˆ ì—†ì´ ì„±ì¥ ì—†ìŒ.

### 5-2. ì‚½ì§ˆ 2: publicPath

**ë¬¸ì œ:**
ë¡œì»¬ì—ì„œëŠ” ì˜ ë˜ëŠ”ë° Vercel ë°°í¬í•˜ë©´ Remote ë¡œë”© ì‹¤íŒ¨.

**í•´ê²°:**
```javascript
output: {
  publicPath: "/",  // ëª…ì‹œì  ì„¤ì •
}
```

**ê³ ì°°: "ì¼ë‹¨ ë˜ë‹ˆê¹Œ"ì˜ ìœ„í—˜ì„±**

**"ì™œ ë˜ëŠ”ì§€" ëª¨ë¥´ë©´ "ì™œ ì•ˆ ë˜ëŠ”ì§€"ë„ ëª¨ë¦„.**

## 6. ì„±ëŠ¥ ë¹„êµ

### ë¹Œë“œ ì‹œê°„

```
[ ëª¨ë†€ë¦¬ì‹ ]
ì „ì²´: 7ë¶„ 15ì´ˆ

[ ë§ˆì´í¬ë¡œ í”„ë¡ íŠ¸ì—”ë“œ ]
ë¸”ë¡œê·¸ë§Œ ìˆ˜ì •í•˜ë©´: 45ì´ˆ
```

**10ë°° ì´ìƒ ë¹ ë¥¸ ê°œë°œ ì‚¬ì´í´.**

### ë²ˆë“¤ í¬ê¸°

```
[ ëª¨ë†€ë¦¬ì‹ ]
main.js: 850KB (gzipped)

[ ë§ˆì´í¬ë¡œ í”„ë¡ íŠ¸ì—”ë“œ ]
Host: 180KB
í•„ìš”í•œ Remoteë§Œ ì¶”ê°€ ë¡œë“œ

ì´ˆê¸° ë¡œë“œ: 78% ê°ì†Œ
```

### ê³ ì°°: ì„±ëŠ¥ë§Œì´ ì „ë¶€ê°€ ì•„ë‹˜

**ì§„ì§œ ê°€ì¹˜ëŠ” "êµ¬ì¡°ì  ë¶„ë¦¬"ì— ìˆìŒ.**

- ë¸”ë¡œê·¸ ë²„ê·¸ê°€ ì´ë ¥ì„œì— ì˜í–¥ ì•ˆ ì¤Œ
- ë¸”ë¡œê·¸ë§Œ ë¡¤ë°± ê°€ëŠ¥

ì„±ëŠ¥ ê°œì„ ì€ ë¶€ê°€ì ì¸ íš¨ê³¼ì˜€ê³ , **ë³¸ì§ˆì ì¸ ê°€ì¹˜ëŠ” "ë…ë¦½ì„±"**ì´ì—ˆìŒ.

## 7. ê²°ë¡ 

### MFAë¥¼ ì„ íƒí•´ì•¼ í•˜ëŠ” ì‚¬ëŒ

âœ… ì—¬ëŸ¬ íŒ€ì´ ë…ë¦½ì ìœ¼ë¡œ ê°œë°œí•´ì•¼ í•  ë•Œ
âœ… ê¸°ëŠ¥ë³„ ê°œë°œ/ë°°í¬ ì‚¬ì´í´ì´ ë‹¤ë¥¼ ë•Œ
âœ… í•™ìŠµ ëª©ì  (ë‚˜ì²˜ëŸ¼)

### ì¶”ì²œí•˜ì§€ ì•ŠëŠ” ê²½ìš°

âŒ í˜¼ì ê°œë°œí•˜ëŠ” ì‘ì€ í”„ë¡œì íŠ¸ (ì˜¤ë²„ì—”ì§€ë‹ˆì–´ë§)
âŒ ë¹ ë¥¸ MVPê°€ í•„ìš”í•  ë•Œ

### ë§ˆì§€ë§‰ ê³ ì°°

ë§ˆì´í¬ë¡œ í”„ë¡ íŠ¸ì—”ë“œê°€ ì •ë‹µì´ ì•„ë‹˜. ëª¨ë†€ë¦¬ì‹ë„ ì •ë‹µì´ ì•„ë‹˜.

**ìƒí™©ì— ë§ëŠ” ì„ íƒì´ ì •ë‹µì„.**

ê¸°ìˆ ì€ ë„êµ¬ì„. ë„êµ¬ì— ì§‘ì°©í•˜ì§€ ë§ê³ , ë¬¸ì œì— ì§‘ì¤‘í•´ì•¼ í•¨.

---

*Written by ì†í˜¸ì„±*',
  'ë§ˆì´í¬ë¡œ í”„ë¡ íŠ¸ì—”ë“œë¥¼ ì ìš©í•˜ë©´ì„œ ê²ªì€ ì‚½ì§ˆ, ê³ ë¯¼, ê¹¨ë‹¬ìŒì„ ì†”ì§í•˜ê²Œ ê³µìœ í•¨. ëª¨ë†€ë¦¬ì‹ì˜ í•œê³„ë¥¼ ëŠë¼ê³  MFAë¥¼ ì„ íƒí•˜ê¸°ê¹Œì§€ì˜ ê³¼ì •.',
  'published',
  true,
  false,
  '9878b01c-1d9e-4b54-8323-f77735445b39',
  now(),
  now(),
  now()
);

-- í¬ìŠ¤íŠ¸ 2: ë¼ìš°íŒ… ì‚½ì§ˆê¸°
INSERT INTO blog_posts (
  title,
  slug,
  content,
  excerpt,
  status,
  is_featured,
  is_pinned,
  user_id,
  published_at,
  created_at,
  updated_at
) VALUES (
  'ìƒˆë¡œê³ ì¹¨í•˜ë©´ ì™œ í°í™”ë©´ì´ì•¼?! - MFA ë¼ìš°íŒ… 2ì£¼ê°„ì˜ ì‚½ì§ˆê³¼ ê¹¨ë‹¬ìŒ',
  'mfa-routing-white-screen-' || extract(epoch from now())::bigint,
  '# ìƒˆë¡œê³ ì¹¨í•˜ë©´ ì™œ í°í™”ë©´ì´ì•¼?! - MFA ë¼ìš°íŒ… 2ì£¼ê°„ì˜ ì‚½ì§ˆê³¼ ê¹¨ë‹¬ìŒ

## ì„œë¡ : ê°€ì¥ ê³ í†µìŠ¤ëŸ¬ì› ë˜ ë¬¸ì œ

MFA ê°œë°œ ì¤‘ ê°€ì¥ í˜ë“¤ì—ˆë˜ ë¶€ë¶„ì´ ë­ëƒê³  ë¬¼ìœ¼ë©´, ë§ì„¤ì„ ì—†ì´ **ë¼ìš°íŒ…**ì´ë¼ê³  ë‹µí•¨.

ì¦ìƒì€ ë‹¨ìˆœí–ˆìŒ:
1. Hostì—ì„œ ë¸”ë¡œê·¸ ê¸€ ìƒì„¸ í˜ì´ì§€ ì ‘ì† â†’ ì •ìƒ
2. F5 (ìƒˆë¡œê³ ì¹¨) ëˆ„ë¦„
3. í°í™”ë©´ ğŸ˜±

ì²˜ìŒì—” "ë²„ê·¸ê² ì§€" í•˜ê³  ê°€ë³ê²Œ ìƒê°í•¨. 2ì£¼ í›„, ë¼ìš°í„° ì½”ë“œë¥¼ ë°¤ìƒˆ ëš«ì–´ì§€ê²Œ ì³ë‹¤ë³´ê³  ìˆì—ˆìŒ.

## 1. ë¬¸ì œ ìƒí™© ë¶„ì„

### ì •ìƒ ë™ì‘ vs ë¹„ì •ìƒ ë™ì‘

```
[ ì •ìƒ ë™ì‘ ]
1. Host ì ‘ì† (/)
2. ë¸”ë¡œê·¸ ë©”ë‰´ í´ë¦­ (/blog)
3. ê¸€ í´ë¦­ (/blog/post/hello-world)
â†’ ëª¨ë‘ ì •ìƒ!

[ ë¹„ì •ìƒ ë™ì‘ ]
4. F5 (ìƒˆë¡œê³ ì¹¨)
â†’ í°í™”ë©´
```

### ë” í˜¼ë€ìŠ¤ëŸ¬ì› ë˜ ì 

**ë¡œì»¬ì—ì„œëŠ” ì˜ ë¨.** í”„ë¡œë•ì…˜(Vercel)ì—ì„œë§Œ ë¬¸ì œ.

"ë¡œì»¬ì—ì„œ ë˜ë©´ í”„ë¡œë•ì…˜ì—ì„œë„ ë˜ì–´ì•¼ í•˜ëŠ” ê±° ì•„ë‹ˆì•¼?"

ì´ ìƒê°ì´ 1ì£¼ì¼ì„ ë‚ ë¦¼.

### ê³ ì°°: í™˜ê²½ ì°¨ì´ì˜ í•¨ì •

ì—¬ê¸°ì„œ ì²« ë²ˆì§¸ ê¹¨ë‹¬ìŒì´ ìˆì—ˆìŒ.

**"ë¡œì»¬ì—ì„œ ë¨ â‰  í”„ë¡œë•ì…˜ì—ì„œ ë¨"**

"ë¡œì»¬ì—ì„œ ë˜ë‹ˆê¹Œ ë˜ê² ì§€"ëŠ” **ê°€ì¥ ìœ„í—˜í•œ ê°€ì •**ì„.

## 2. ì›ì¸ íƒìƒ‰: 1ì£¼ì°¨

### ì˜ëª»ëœ ê°€ì„¤ë“¤

**ê°€ì„¤ 1: Vercel ì„¤ì • ë¬¸ì œ?**
â†’ SPA ë¼ìš°íŒ… ì„¤ì • ì •ìƒ. ê¸°ê°.

**ê°€ì„¤ 2: remoteEntry.js ë¡œë”© ì‹¤íŒ¨?**
â†’ ë„¤íŠ¸ì›Œí¬ íƒ­ í™•ì¸, ëª¨ë“  íŒŒì¼ 200 OK. ê¸°ê°.

**ê°€ì„¤ 3: React Router ë²„ì „ ì¶©ëŒ?**
â†’ ë²„ì „ í†µì¼í•´ë„ ì—¬ì „íˆ ë¬¸ì œ. ê¸°ê°.

### ê³ ì°°: ê°€ì„¤ ê²€ì¦ì˜ í•¨ì •

**ê°€ì„¤ì„ ì„¸ìš°ê¸° ì „ì— í˜„ìƒì„ ì •í™•íˆ íŒŒì•…í•´ì•¼ í•¨.**

ë‚˜ëŠ” "ì™œ ì•ˆ ë˜ëŠ”ì§€" ì¶”ì¸¡ë§Œ í•˜ê³  ìˆì—ˆìŒ. ì •ì‘ "ì •í™•íˆ ë­ê°€ ì•ˆ ë˜ëŠ”ì§€"ëŠ” ëª¨ë¥´ê³  ìˆì—ˆìŒ.

**ì¦ìƒë§Œ ë³´ê³  ì›ì¸ì„ ì¶”ì¸¡í•˜ë©´ ì‚½ì§ˆí•¨.**

### ë””ë²„ê¹… ë¡œê·¸ ì¶”ê°€

ê²°êµ­ ê¸°ë³¸ìœ¼ë¡œ ëŒì•„ê°. console.log.

```tsx
function App() {
  const location = useLocation();

  useEffect(() => {
    console.log("[Remote2] í˜„ì¬ ê²½ë¡œ:", location.pathname);
  }, [location.pathname]);
}
```

ìƒˆë¡œê³ ì¹¨ í›„ ì½˜ì†”:
```
[Remote2] í˜„ì¬ ê²½ë¡œ: /post/hello-world
```

**"ì–´? /blog/post/hello-worldê°€ ì•„ë‹ˆë¼ /post/hello-world?"**

1ì£¼ì¼ ë§Œì— ì‹¤ë§ˆë¦¬ê°€ ì¡í˜. console.log í•˜ë‚˜ë¡œ.

### ê³ ì°°: ê¸°ë³¸ê¸°ì˜ ì¤‘ìš”ì„±

**í™”ë ¤í•œ ë””ë²„ê¹… ë„êµ¬ë³´ë‹¤ ê¸°ë³¸ console.logê°€ ë‚˜ì„ ë•Œê°€ ìˆìŒ.**

**ë³µì¡í•œ ë¬¸ì œì¼ìˆ˜ë¡ ë‹¨ìˆœí•œ ì ‘ê·¼ì´ í•„ìš”í•¨.**

## 3. ì›ì¸ ë°œê²¬

### Hostì˜ ë¼ìš°íŒ… ë°©ì‹

Hostì˜ ë¼ìš°íŠ¸:
```tsx
<Route path="/blog/*" element={<BlogApp />} />
```

`/blog/*`ì˜ ì˜ë¯¸:
- `/blog` ì´í›„ì˜ ëª¨ë“  ê²½ë¡œë¥¼ ë§¤ì¹­
- **ë‚˜ë¨¸ì§€ ë¶€ë¶„**ì„ í•˜ìœ„ ë¼ìš°í„°ì— ì „ë‹¬

```
ë¸Œë¼ìš°ì € URL: /blog/post/hello-world
Hostê°€ ë§¤ì¹­: /blog
Remoteê°€ ë°›ëŠ” ê²½ë¡œ: /post/hello-world  â† ì—¬ê¸°!
```

**Hostê°€ `/blog`ë¥¼ "ë¨¹ê³ " ë‚˜ë¨¸ì§€ë§Œ Remoteì—ê²Œ ì¤Œ.**

### Remoteì˜ ì˜ëª»ëœ ë¼ìš°íŠ¸

ê¸°ì¡´ Remoteì˜ ë¼ìš°íŠ¸:
```tsx
<Route path="/blog/post/:slug" element={<PostDetail />} />
```

Remoteê°€ ë°›ëŠ” ê²½ë¡œ: `/post/hello-world`
Remoteì˜ ë¼ìš°íŠ¸: `/blog/post/:slug`

**ë§¤ì¹­ ì•ˆ ë¨.** ê·¸ë˜ì„œ í°í™”ë©´.

### ì™œ í´ë¦­ ì´ë™ì€ ëì„ê¹Œ?

í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ë¼ìš°íŒ…:
1. ì´ë¯¸ Remoteê°€ ë¡œë“œë˜ì–´ ìˆìŒ
2. Link í´ë¦­ â†’ URL ë³€ê²½
3. Remote ë‚´ë¶€ì—ì„œ ë¼ìš°íŠ¸ ì²˜ë¦¬
4. **Hostë¥¼ ê±°ì¹˜ì§€ ì•ŠìŒ**

ìƒˆë¡œê³ ì¹¨:
1. ë¸Œë¼ìš°ì €ê°€ ì„œë²„ì— ìš”ì²­
2. Hostê°€ ë‹¤ì‹œ ë¡œë“œ
3. Hostê°€ `/blog/*` ë§¤ì¹­ â†’ Remote ë¡œë“œ
4. **Remoteê°€ `/post/hello-world`ë¥¼ ë°›ìŒ**

**ìƒˆë¡œê³ ì¹¨ = ì„œë²„ì— ë‹¤ì‹œ ìš”ì²­ = ì²˜ìŒë¶€í„° ë‹¤ì‹œ ì‹œì‘**

### ê³ ì°°: SPA ë¼ìš°íŒ…ì˜ ë³¸ì§ˆ

**SPA ë¼ìš°íŒ…ì€ "ëˆˆì†ì„"ì„.**

URLì€ ë°”ë€Œì§€ë§Œ, ì‹¤ì œë¡œ ë°›ëŠ” ê±´ í•­ìƒ ê°™ì€ index.htmlì„.

## 4. í•´ê²°ì±… íƒìƒ‰: 2ì£¼ì°¨

### ì‹¤íŒ¨í•œ ì‹œë„ë“¤

**ì‹œë„ 1: í™˜ê²½ë³€ìˆ˜**
```tsx
const PREFIX = process.env.NODE_ENV === "production" ? "" : "/blog";
```
ë¬¸ì œ: ë¡œì»¬ì—ì„œ Host í†µí•© ì‹¤í–‰í•˜ë©´ êµ¬ë¶„ ë¶ˆê°€.

**ì‹œë„ 2: URL ê¸°ë°˜ ê°ì§€**
ë¬¸ì œ: Remoteë„ vercel.app ë„ë©”ì¸ì´ë¼ êµ¬ë¶„ ë¶ˆê°€.

### ê³ ì°°: ë¬¸ì œ ì •ì˜ì˜ ì¤‘ìš”ì„±

**ë¬¸ì œë¥¼ ì •í™•íˆ ì •ì˜í•´ì•¼ í•´ê²°ì±…ì´ ë³´ì„.**

ë‚´ê°€ í’€ì–´ì•¼ í•  ë¬¸ì œ:
> "Remoteê°€ Host í†µí•©ìœ¼ë¡œ ì‹¤í–‰ ì¤‘ì¸ì§€, ë‹¨ë…ìœ¼ë¡œ ì‹¤í–‰ ì¤‘ì¸ì§€ ì–´ë–»ê²Œ ì•„ëŠ”ê°€?"

**Hostê°€ ì§ì ‘ ì•Œë ¤ì£¼ë©´ ë˜ì–ì•„!**

### ìµœì¢… í•´ê²°ì±…: sessionStorage í”Œë˜ê·¸

```typescript
// lib/src/utils/storage.ts
export const storage = {
  setHostApp: () => {
    sessionStorage.setItem("mfa:host-app", "true");
  },

  isHostApp: (): boolean => {
    return sessionStorage.getItem("mfa:host-app") === "true";
  },
};
```

```tsx
// host/src/bootstrap.tsx
storage.setHostApp();  // "ë‚˜ Hostì•¼!"
```

```tsx
// remote2/src/routes.tsx
const PREFIX = storage.isHostApp() ? "" : "/blog";

<Route path={`${PREFIX}/post/:slug`} element={<PostDetail />} />
```

ë“œë””ì–´ í•´ê²°!

### ê³ ì°°: ë‹¨ìˆœí•œ í•´ê²°ì±…ì˜ ê°€ì¹˜

2ì£¼ê°„ ì‚½ì§ˆí•œ ë¬¸ì œì˜ í•´ê²°ì±…: sessionStorageì— í”Œë˜ê·¸ í•˜ë‚˜ ì‹¬ê¸°.

ì½”ë“œë¡œ ì¹˜ë©´ 10ì¤„ë„ ì•ˆ ë¨.

**"ì™œ ì§„ì‘ ì´ ìƒê°ì„ ëª» í–ˆì§€?"**

ë¬¸ì œì— íŒŒë¬»í˜€ ìˆìœ¼ë©´ ì‹œì•¼ê°€ ì¢ì•„ì§.

## 5. ì¶”ê°€ ì‘ì—…ë“¤

### ëª¨ë“  Linkì— PREFIX ì ìš©

ë¼ìš°íŠ¸ë§Œ ë°”ê¾¸ë©´ ëì´ ì•„ë‹ˆì—ˆìŒ.

```tsx
// âŒ ì˜ëª»ëœ ë°©ì‹
<Link to="/blog/post/hello-world">ê¸€ ë³´ê¸°</Link>

// âœ… ì˜¬ë°”ë¥¸ ë°©ì‹
<Link to={`${PREFIX}/post/hello-world`}>ê¸€ ë³´ê¸°</Link>
```

### constants.tsì˜ í•¨ì •

```typescript
// constants.ts
export const PREFIX = storage.isHostApp() ? "" : "/blog";
```

ë¬¸ì œ: ëª¨ë“ˆ ë¡œë“œ ì‹œì ì— í‰ê°€ë¨.

```
1. Host ë¡œë“œ
2. Remote ëª¨ë“ˆ ë¡œë“œ (ì´ë•Œ constants.ts í‰ê°€)
3. ì•„ì§ setHostApp() í˜¸ì¶œ ì „!
4. isHostApp() = false â†’ PREFIX = "/blog"
5. ì´ë¯¸ PREFIXëŠ” "/blog"ë¡œ ê³ ì • â† ë¬¸ì œ!
```

í•´ê²°: ê° íŒŒì¼ì—ì„œ ì§ì ‘ ê³„ì‚°.

### ê³ ì°°: íƒ€ì´ë° ì´ìŠˆì˜ ì–´ë ¤ì›€

**íƒ€ì´ë° ì´ìŠˆëŠ” ê°€ì¥ ë””ë²„ê¹…í•˜ê¸° ì–´ë ¤ìš´ ë²„ê·¸ ìœ í˜•ì„.**

**íƒ€ì´ë°ì— ì˜ì¡´í•˜ëŠ” ì½”ë“œëŠ” í”¼í•´ì•¼ í•¨.**

## 6. ë°°ìš´ ê²ƒë“¤ ì •ë¦¬

### ê¸°ìˆ ì  êµí›ˆ

1. **ë¡œì»¬ì—ì„œ ë¨ â‰  í”„ë¡œë•ì…˜ì—ì„œ ë¨**
2. **SPA ë¼ìš°íŒ…ì€ ëˆˆì†ì„, ìƒˆë¡œê³ ì¹¨ì€ ì²˜ìŒë¶€í„° ë‹¤ì‹œ**
3. **íƒ€ì´ë° ì´ìŠˆëŠ” ëª…ì‹œì  ìˆœì„œ ë³´ì¥ìœ¼ë¡œ í•´ê²°**
4. **í•˜ë“œì½”ë”©ì€ ì‹œí•œí­íƒ„**

### ë§ˆì¸ë“œì…‹ êµí›ˆ

1. **ê°€ì„¤ ì„¸ìš°ê¸° ì „ì— í˜„ìƒ ì •í™•íˆ íŒŒì•…**
2. **ë³µì¡í•œ ë¬¸ì œì¼ìˆ˜ë¡ ë‹¨ìˆœí•œ ì ‘ê·¼**
3. **ê¸°ë³¸ê¸°(console.log)ë¥¼ ë¬´ì‹œí•˜ì§€ ë§ ê²ƒ**
4. **ë¬¸ì œë¥¼ ì •í™•íˆ ì •ì˜í•˜ë©´ í•´ê²°ì±…ì´ ë³´ì„**
5. **ì‚½ì§ˆ = í•™ìŠµ**

### ê³ ì°°: ì‚½ì§ˆì˜ ê°€ì¹˜

2ì£¼ ë™ì•ˆ ì‚½ì§ˆí–ˆìŒ. í˜ë“¤ì—ˆìŒ.

ê·¸ëŸ°ë° ëŒì•„ë³´ë©´, **ì´ 2ì£¼ê°€ ê°€ì¥ ë§ì´ ë°°ìš´ ì‹œê°„**ì´ì—ˆìŒ.

- SPA ë¼ìš°íŒ…ì˜ ë³¸ì§ˆì„ ì´í•´í•¨
- Module Federationì˜ ë™ì‘ ë°©ì‹ì„ ì´í•´í•¨
- ë””ë²„ê¹… ì ‘ê·¼ë²•ì„ ë°°ì›€

**ì‚½ì§ˆ ì—†ì´ ì–»ì€ ì§€ì‹ì€ ê¸ˆë°© ìŠìŒ.** ì‚½ì§ˆí•˜ë©´ì„œ ì–»ì€ ì§€ì‹ì€ ì˜¤ë˜ ê°.

ê·¸ë˜ì„œ ì‚½ì§ˆì„ ë‘ë ¤ì›Œí•˜ì§€ ì•Šìœ¼ë ¤ê³  í•¨. ì‚½ì§ˆì€ ì„±ì¥ì˜ ê¸°íšŒì„.

---

*Written by ì†í˜¸ì„±*',
  'MFA ë¼ìš°íŒ…ì—ì„œ ê°€ì¥ ê³ í†µìŠ¤ëŸ¬ì› ë˜ "ìƒˆë¡œê³ ì¹¨ í°í™”ë©´" ë¬¸ì œ. 2ì£¼ê°„ì˜ ì‚½ì§ˆ ê³¼ì •ê³¼ í•´ê²°ì±…, ê·¸ë¦¬ê³  ê·¸ ê³¼ì •ì—ì„œ ë°°ìš´ ê²ƒë“¤.',
  'published',
  true,
  false,
  '9878b01c-1d9e-4b54-8323-f77735445b39',
  now(),
  now(),
  now()
);

-- í¬ìŠ¤íŠ¸ 3: ì¸ì¦ì²´ê³„
INSERT INTO blog_posts (
  title,
  slug,
  content,
  excerpt,
  status,
  is_featured,
  is_pinned,
  user_id,
  published_at,
  created_at,
  updated_at
) VALUES (
  'Hostì—ì„œ ë¡œê·¸ì¸í•˜ë©´ Remoteì—ì„œë„ ë¡œê·¸ì¸ë˜ì–´ì•¼ì§€! - MFA ì¸ì¦ì²´ê³„ êµ¬ì¶•ê¸°',
  'mfa-auth-system-' || extract(epoch from now())::bigint,
  '# Hostì—ì„œ ë¡œê·¸ì¸í•˜ë©´ Remoteì—ì„œë„ ë¡œê·¸ì¸ë˜ì–´ì•¼ì§€! - MFA ì¸ì¦ì²´ê³„ êµ¬ì¶•ê¸°

## ì„œë¡ : ë‹¹ì—°í•œ ê²Œ ë‹¹ì—°í•˜ì§€ ì•Šì•˜ìŒ

"Hostì—ì„œ ë¡œê·¸ì¸í–ˆìœ¼ë©´ Remoteì—ì„œë„ ë¡œê·¸ì¸ëœ ê±° ì•„ë‹ˆì•¼?"

MFA ê°œë°œ ì „ì—ëŠ” ì´ê²Œ ë‹¹ì—°í•˜ë‹¤ê³  ìƒê°í–ˆìŒ.

**ì•„ë‹ˆì—ˆìŒ.**

ê° ì•±ì´ ë…ë¦½ì ì´ë¼ëŠ” ê±´, ì¸ì¦ ìƒíƒœë„ ë…ë¦½ì ì´ë¼ëŠ” ëœ»ì´ì—ˆìŒ. ì´ ê¹¨ë‹¬ìŒì— ë„ë‹¬í•˜ê¸°ê¹Œì§€ ë©°ì¹ ì´ ê±¸ë ¸ìŒ.

## 1. ë¬¸ì œ ì¸ì‹

### ì´ˆê¸° ìƒí™©

Remote2(ë¸”ë¡œê·¸)ì—ì„œ Supabase Authë¥¼ ì—°ê²°í•¨.

```typescript
// remote2/src/network/supabase.ts
export const supabase = createClient(supabaseUrl, supabaseKey);
```

ë¡œê·¸ì¸ êµ¬í˜„:
```typescript
const { data, error } = await supabase.auth.signInWithPassword({
  email,
  password,
});
```

Remote2ì—ì„œ ë¡œê·¸ì¸í•˜ë©´? **Remote2ì—ì„œëŠ” ë¡œê·¸ì¸ë¨.**

Hostì—ì„œ í™•ì¸í•˜ë©´? **ë¡œê·¸ì¸ ì•ˆ ë¨.**

### ì™œ?

ê° ì•±ì€ ë³„ë„ì˜ Supabase í´ë¼ì´ì–¸íŠ¸ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ê°–ê³  ìˆìŒ.

```
Host         â†’ supabase1 ì¸ìŠ¤í„´ìŠ¤ â†’ ì„¸ì…˜ A
Remote1      â†’ supabase2 ì¸ìŠ¤í„´ìŠ¤ â†’ ì„¸ì…˜ B
Remote2      â†’ supabase3 ì¸ìŠ¤í„´ìŠ¤ â†’ ì„¸ì…˜ C
```

**ì¸ìŠ¤í„´ìŠ¤ê°€ ë‹¤ë¥´ë©´ ì„¸ì…˜ë„ ë‹¤ë¦„.**

### ê³ ì°°: ë…ë¦½ì„±ì˜ ì–‘ë©´

ë§ˆì´í¬ë¡œ í”„ë¡ íŠ¸ì—”ë“œì˜ í•µì‹¬ì€ "ë…ë¦½ì„±"ì„.

ê·¸ëŸ°ë° **ë…ë¦½ì„±ì€ ì–‘ë‚ ì˜ ê²€**ì„.

ì¥ì : ì„œë¡œ ì˜í–¥ ì•ˆ ì¤Œ, ë…ë¦½ ë°°í¬ ê°€ëŠ¥
ë‹¨ì : **ê³µìœ í•´ì•¼ í•  ê²ƒë„ ê³µìœ  ì•ˆ ë¨**

ì¸ì¦ ìƒíƒœëŠ” ê³µìœ ë˜ì–´ì•¼ í•˜ëŠ” ê²ƒì´ì—ˆìŒ. ê·¸ê±¸ ê¹¨ë‹«ëŠ” ë° ì‹œê°„ì´ ê±¸ë ¸ìŒ.

## 2. í•´ê²°ì±… íƒìƒ‰

### ì˜µì…˜ 1: ê° ì•±ì—ì„œ ë…ë¦½ ë¡œê·¸ì¸

```
Hostì—ì„œ ë¡œê·¸ì¸ â†’ Hostë§Œ ì¸ì¦ë¨
ë¸”ë¡œê·¸ ë“¤ì–´ê°€ë©´ â†’ ë‹¤ì‹œ ë¡œê·¸ì¸
ì´ë ¥ì„œ ë“¤ì–´ê°€ë©´ â†’ ë˜ ë¡œê·¸ì¸
```

ìœ ì € ì…ì¥ì—ì„œ ìµœì•…ì„. ê¸°ê°.

### ì˜µì…˜ 2: ì¤‘ì•™ì§‘ì¤‘ì‹ ì¸ì¦

```
Hostë§Œ ë¡œê·¸ì¸ ì²˜ë¦¬
Remoteë“¤ì€ Hostì˜ ì¸ì¦ ìƒíƒœë¥¼ ë°›ì•„ì„œ ì‚¬ìš©
```

ì´ê²Œ ë§ëŠ” ë°©í–¥ ê°™ì•˜ìŒ.

### ì˜µì…˜ 3: í† í° ê³µìœ 

```
ë¡œê·¸ì¸ â†’ í† í° ì €ì¥ (localStorage)
ëª¨ë“  ì•±ì´ ê°™ì€ í† í° ì°¸ì¡°
```

localStorageëŠ” ê°™ì€ ë„ë©”ì¸ì—ì„œ ê³µìœ ë¨. ì´ê±¸ í™œìš©í•˜ë©´?

## 3. êµ¬í˜„: Supabase ì„¸ì…˜ ê³µìœ 

### í•µì‹¬ ë°œê²¬

Supabase AuthëŠ” ê¸°ë³¸ì ìœ¼ë¡œ **localStorageì— ì„¸ì…˜ì„ ì €ì¥**í•¨.

```
localStorage:
  sb-xxxxx-auth-token: {"access_token": "...", ...}
```

ê°™ì€ ë„ë©”ì¸ì´ë©´ localStorage ê³µìœ ë¨.

**"ê·¸ëŸ¬ë©´ ê°™ì€ Supabase í´ë¼ì´ì–¸íŠ¸ ì„¤ì •ì„ ì“°ë©´ ë˜ëŠ” ê±° ì•„ë‹ˆì•¼?"**

### ê³µí†µ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ ì¶”ì¶œ

```typescript
// lib/src/network/supabase.ts
export const createSupabaseClient = (url: string, key: string) => {
  return createClient(url, key, {
    auth: {
      persistSession: true,
      storageKey: ''mfa-auth-token'',  // í†µì¼ëœ í‚¤!
      autoRefreshToken: true,
    },
  });
};
```

ëª¨ë“  ì•±ì—ì„œ ê°™ì€ ì„¤ì •:
```typescript
// host, remote1, remote2, remote3
import { createSupabaseClient } from ''@sonhoseong/mfa-lib'';
const supabase = createSupabaseClient(url, key);
```

### ë™ì‘ í™•ì¸

1. Hostì—ì„œ ë¡œê·¸ì¸
2. localStorageì— `mfa-auth-token` ì €ì¥ë¨
3. Remote2 ì§„ì…
4. Supabase í´ë¼ì´ì–¸íŠ¸ê°€ `mfa-auth-token` ì½ìŒ
5. **ìë™ìœ¼ë¡œ ì¸ì¦ë¨!**

### ê³ ì°°: í‘œì¤€ì˜ í˜

Supabaseê°€ localStorage ê¸°ë°˜ì´ë¼ì„œ ê°€ëŠ¥í–ˆìŒ.

ë§Œì•½ ë©”ëª¨ë¦¬ ê¸°ë°˜ì´ì—ˆë‹¤ë©´? í›¨ì”¬ ë³µì¡í–ˆì„ ê²ƒì„.

**í”„ë ˆì„ì›Œí¬/ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì„ íƒí•  ë•Œ "ì–´ë–»ê²Œ ë™ì‘í•˜ëŠ”ì§€"ë¥¼ ì•Œì•„ì•¼ í•˜ëŠ” ì´ìœ ì„.**

## 4. ì¸ì¦ ìƒíƒœ ë™ê¸°í™”

### ìƒˆë¡œìš´ ë¬¸ì œ

Hostì—ì„œ ë¡œê·¸ì•„ì›ƒí•˜ë©´?

```
Host: ë¡œê·¸ì•„ì›ƒ ì‹¤í–‰ â†’ localStorage í´ë¦¬ì–´
Remote2: ì•„ì§ ë©”ëª¨ë¦¬ì— ì´ì „ ì„¸ì…˜ ìœ ì§€ â†’ ë¡œê·¸ì¸ëœ ê²ƒì²˜ëŸ¼ ë³´ì„
```

**ì‹¤ì‹œê°„ ë™ê¸°í™”ê°€ ì•ˆ ë¨.**

### í•´ê²°: Auth State Change ë¦¬ìŠ¤ë„ˆ

```typescript
// lib/src/hooks/useAuthSync.ts
export const useAuthSync = (supabase: SupabaseClient) => {
  const [user, setUser] = useState<User | null>(null);

  useEffect(() => {
    // í˜„ì¬ ì„¸ì…˜ í™•ì¸
    supabase.auth.getSession().then(({ data }) => {
      setUser(data.session?.user ?? null);
    });

    // ë³€ê²½ ê°ì§€
    const { data: { subscription } } = supabase.auth.onAuthStateChange(
      (event, session) => {
        setUser(session?.user ?? null);
      }
    );

    return () => subscription.unsubscribe();
  }, [supabase]);

  return user;
};
```

**í•µì‹¬: `onAuthStateChange`**

ì´ ë¦¬ìŠ¤ë„ˆê°€ localStorage ë³€ê²½ì„ ê°ì§€í•´ì„œ ìƒíƒœë¥¼ ë™ê¸°í™”í•¨.

### í…ŒìŠ¤íŠ¸

1. Hostì—ì„œ ë¡œê·¸ì•„ì›ƒ
2. localStorage í´ë¦¬ì–´ë¨
3. `onAuthStateChange` ë°œìƒ
4. Remote2ì˜ ìƒíƒœ ì—…ë°ì´íŠ¸
5. UIê°€ ë¡œê·¸ì•„ì›ƒ ìƒíƒœë¡œ ë³€ê²½ë¨

**ë“œë””ì–´ ë™ê¸°í™” ì™„ë£Œ!**

## 5. ê¶Œí•œ ê´€ë¦¬

### ë¬¸ì œ

ë¸”ë¡œê·¸ ê¸€ ì‘ì„±ì€ ë¡œê·¸ì¸ ìœ ì €ë§Œ ê°€ëŠ¥í•´ì•¼ í•¨.

ê¸€ ì‚­ì œëŠ” ì‘ì„±ìë§Œ ê°€ëŠ¥í•´ì•¼ í•¨.

### í”„ë¡ íŠ¸ì—”ë“œ ê°€ë“œ

```typescript
// remote2/src/components/AuthGuard.tsx
export const AuthGuard = ({ children }: { children: ReactNode }) => {
  const user = useAuthSync(supabase);

  if (!user) {
    return <Navigate to="/login" replace />;
  }

  return <>{children}</>;
};
```

```tsx
<Route
  path="/post/new"
  element={
    <AuthGuard>
      <PostEditor />
    </AuthGuard>
  }
/>
```

### ë°±ì—”ë“œ(Supabase RLS)

í”„ë¡ íŠ¸ì—”ë“œ ê°€ë“œë§Œìœ¼ë¡œëŠ” ë¶€ì¡±í•¨. API ì§ì ‘ í˜¸ì¶œí•˜ë©´ ëš«ë¦¼.

```sql
-- Supabase RLS ì •ì±…
CREATE POLICY "Users can create own posts"
ON blog_posts
FOR INSERT
WITH CHECK (auth.uid() = user_id);

CREATE POLICY "Users can update own posts"
ON blog_posts
FOR UPDATE
USING (auth.uid() = user_id);
```

### ê³ ì°°: ì´ì¤‘ ê²€ì¦ì˜ ì¤‘ìš”ì„±

```
í”„ë¡ íŠ¸ì—”ë“œ ê°€ë“œ: UX ê°œì„  (ê¶Œí•œ ì—†ìœ¼ë©´ í™”ë©´ ì•ˆ ë³´ì—¬ì¤Œ)
ë°±ì—”ë“œ ê²€ì¦: ì‹¤ì œ ë³´ì•ˆ (API ì§ì ‘ í˜¸ì¶œ ë°©ì–´)
```

**í”„ë¡ íŠ¸ì—”ë“œëŠ” UX, ë°±ì—”ë“œëŠ” ë³´ì•ˆ.**

ì´ ì›ì¹™ì„ ì§€í‚¤ëŠ” ê²Œ ì¤‘ìš”í•¨. í”„ë¡ íŠ¸ì—”ë“œë§Œ ë¯¿ìœ¼ë©´ ë³´ì•ˆ êµ¬ë© ìƒê¹€.

## 6. JWT í† í° ë¶„ì„

### í† í° êµ¬ì¡° ì´í•´

Supabaseì˜ access_tokenì€ JWTì„.

```typescript
// JWT ë””ì½”ë”© (ë¼ì´ë¸ŒëŸ¬ë¦¬ ì—†ì´)
const decodeJwt = (token: string) => {
  const payload = token.split(''.'')[1];
  return JSON.parse(atob(payload));
};
```

```json
{
  "sub": "9878b01c-1d9e-4b54-8323-f77735445b39",
  "email": "test@example.com",
  "exp": 1735689600,
  "role": "authenticated"
}
```

### í† í° ë§Œë£Œ ì²˜ë¦¬

```typescript
const isTokenExpired = (token: string): boolean => {
  const decoded = decodeJwt(token);
  return decoded.exp * 1000 < Date.now();
};
```

Supabaseê°€ ìë™ìœ¼ë¡œ ë¦¬í”„ë ˆì‹œí•˜ì§€ë§Œ, ì´í•´í•˜ê³  ìˆìœ¼ë©´ ë””ë²„ê¹…ì— ë„ì›€ë¨.

## 7. ì‚½ì§ˆ ê¸°ë¡

### ì‚½ì§ˆ 1: ë‹¤ë¥¸ ë„ë©”ì¸ì—ì„œ í…ŒìŠ¤íŠ¸

ë¡œì»¬ì—ì„œ HostëŠ” localhost:3000, Remote2ëŠ” localhost:3002.

**ì„œë¸Œë„ë©”ì¸ ì•„ë‹ˆê³  í¬íŠ¸ë§Œ ë‹¤ë¥¸ ê±´ ê°™ì€ Originìœ¼ë¡œ ì·¨ê¸‰ ì•ˆ ë¨!**

ê°œë°œ ì¤‘ì—ëŠ” ë¬¸ì œ ì—†ë‹¤ê°€ íŠ¹ì • ì„¤ì •ì—ì„œ localStorage ê³µìœ  ì•ˆ ë˜ëŠ” ìƒí™© ë°œìƒ.

í•´ê²°: webpack devServerì˜ `allowedHosts` ì„¤ì • ì¡°ì •.

### ì‚½ì§ˆ 2: ì„¸ì…˜ ë§Œë£Œ í›„ ë¬´í•œ ë¦¬ë‹¤ì´ë ‰íŠ¸

```
í† í° ë§Œë£Œ â†’ ë¡œê·¸ì¸ í˜ì´ì§€ â†’ ìë™ ë¡œê·¸ì¸ ì‹œë„ â†’ ì‹¤íŒ¨ â†’ ë¡œê·¸ì¸ í˜ì´ì§€ â†’ ...
```

ë¬´í•œ ë£¨í”„ ë°œìƒ.

í•´ê²°: ë¦¬ë‹¤ì´ë ‰íŠ¸ ì „ì— ì„¸ì…˜ ìƒíƒœ ëª…í™•íˆ í™•ì¸.

```typescript
// ì„¸ì…˜ì´ "ì—†ìŒ"ê³¼ "ë§Œë£Œë¨"ì„ êµ¬ë¶„
const session = await supabase.auth.getSession();
if (!session.data.session) {
  // ì„¸ì…˜ ì—†ìŒ â†’ ë¡œê·¸ì¸ í•„ìš”
} else if (isTokenExpired(session.data.session.access_token)) {
  // í† í° ë§Œë£Œ â†’ ë¦¬í”„ë ˆì‹œ ì‹œë„
  await supabase.auth.refreshSession();
}
```

## 8. ìµœì¢… ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Supabase Auth              â”‚
â”‚         (ì¤‘ì•™ ì¸ì¦ ì„œë²„)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          localStorage                   â”‚
â”‚   mfa-auth-token (ê³µìœ  ì„¸ì…˜ ì €ì¥ì†Œ)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†•              â†•              â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Host     â”‚  â”‚   Remote1   â”‚  â”‚   Remote2   â”‚
â”‚ (ë¡œê·¸ì¸ UI) â”‚  â”‚  (ì´ë ¥ì„œ)   â”‚  â”‚   (ë¸”ë¡œê·¸)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**í•µì‹¬: localStorageë¥¼ ì„¸ì…˜ ê³µìœ  ì €ì¥ì†Œë¡œ í™œìš©**

## 9. ë°°ìš´ ê²ƒë“¤

### ê¸°ìˆ ì  êµí›ˆ

1. **ê°™ì€ ë„ë©”ì¸ì˜ localStorageëŠ” ê³µìœ ë¨**
2. **Supabase AuthëŠ” localStorage ê¸°ë°˜**
3. **onAuthStateChangeë¡œ ì‹¤ì‹œê°„ ë™ê¸°í™” ê°€ëŠ¥**
4. **í”„ë¡ íŠ¸ì—”ë“œ ê°€ë“œ â‰  ë³´ì•ˆ (RLS í•„ìˆ˜)**

### ì•„í‚¤í…ì²˜ êµí›ˆ

1. **MFAì—ì„œ "ê³µìœ "ëŠ” ëª…ì‹œì ìœ¼ë¡œ ì„¤ê³„í•´ì•¼ í•¨**
2. **ë…ë¦½ì„±ê³¼ ê³µìœ ì˜ ê· í˜•ì„ ì°¾ì•„ì•¼ í•¨**
3. **ì¸ì¦ì€ ê°€ëŠ¥í•˜ë©´ Hostì—ì„œ ì¤‘ì•™ ê´€ë¦¬**

### ê³ ì°°: ì¸ì¦ì˜ ë³¸ì§ˆ

ì¸ì¦ì€ "ë„ˆ ëˆ„êµ¬ì•¼?"ë¥¼ í™•ì¸í•˜ëŠ” ê²ƒì„.

MFAì—ì„œëŠ” ì´ ì§ˆë¬¸ì„ **ì–´ë””ì„œ, ì–´ë–»ê²Œ** í•˜ëŠëƒê°€ ì¤‘ìš”í•¨.

ê° ì•±ì—ì„œ ê°ì ë¬¼ì–´ë³´ë©´? ìœ ì €ê°€ ë¯¸ì¹¨.
í•œ ê³³ì—ì„œ ë¬¼ì–´ë³´ê³  ê³µìœ í•˜ë©´? ìì—°ìŠ¤ëŸ¬ì›€.

**ê¸°ìˆ ì€ ìœ ì € ê²½í—˜ì„ ìœ„í•œ ê²ƒì„.** ì´ê±¸ ìŠìœ¼ë©´ ì•ˆ ë¨.

---

*Written by ì†í˜¸ì„±*',
  'MFA í™˜ê²½ì—ì„œ Hostì™€ Remote ê°„ ì¸ì¦ ìƒíƒœë¥¼ ì–´ë–»ê²Œ ê³µìœ í–ˆëŠ”ì§€. Supabase Auth, localStorage, ì„¸ì…˜ ë™ê¸°í™”ê¹Œì§€ì˜ ì—¬ì •.',
  'published',
  true,
  false,
  '9878b01c-1d9e-4b54-8323-f77735445b39',
  now(),
  now(),
  now()
);

-- í¬ìŠ¤íŠ¸ 4: ìƒíƒœê´€ë¦¬
INSERT INTO blog_posts (
  title,
  slug,
  content,
  excerpt,
  status,
  is_featured,
  is_pinned,
  user_id,
  published_at,
  created_at,
  updated_at
) VALUES (
  'MFAì—ì„œ Redux ì“°ë©´ ì•ˆ ëœë‹¤ê³ ? - ë§ˆì´í¬ë¡œ í”„ë¡ íŠ¸ì—”ë“œ ìƒíƒœê´€ë¦¬ ì „ëµ',
  'mfa-state-management-' || extract(epoch from now())::bigint,
  '# MFAì—ì„œ Redux ì“°ë©´ ì•ˆ ëœë‹¤ê³ ? - ë§ˆì´í¬ë¡œ í”„ë¡ íŠ¸ì—”ë“œ ìƒíƒœê´€ë¦¬ ì „ëµ

## ì„œë¡ : í˜¼ë€ì˜ ì‹œì‘

MFA ì•„í‚¤í…ì²˜ë¥¼ ê²€ìƒ‰í•˜ë©´ ì´ëŸ° ê¸€ë“¤ì´ ë‚˜ì˜´:

- "ë§ˆì´í¬ë¡œ í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ì „ì—­ ìƒíƒœë¥¼ ì“°ë©´ ì•ˆ ë©ë‹ˆë‹¤"
- "ê° ì•±ì€ ë…ë¦½ì ì¸ ìƒíƒœë¥¼ ê°€ì ¸ì•¼ í•©ë‹ˆë‹¤"
- "ReduxëŠ” ëª¨ë†€ë¦¬ì‹ì˜ ì‚°ë¬¼ì…ë‹ˆë‹¤"

**"ê·¸ëŸ¬ë©´ Redux ì“°ë©´ ì•ˆ ë˜ëŠ” ê±°ì•¼?"**

ê²°ë¡ ë¶€í„°: **ì“¸ ìˆ˜ ìˆìŒ. ë‹¨, ë°©ë²•ì´ ë‹¤ë¦„.**

## 1. ë¬¸ì œ ì •ì˜

### MFAì—ì„œ ìƒíƒœê´€ë¦¬ê°€ ì–´ë ¤ìš´ ì´ìœ 

ëª¨ë†€ë¦¬ì‹:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       Single Store          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ ìœ ì € â”‚ ë¸”ë¡œê·¸â”‚ ì„¤ì • â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

í•˜ë‚˜ì˜ ìŠ¤í† ì–´ì—ì„œ ëª¨ë“  ìƒíƒœ ê´€ë¦¬. ê°„ë‹¨í•¨.

MFA:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Host   â”‚  â”‚ Remote1 â”‚  â”‚ Remote2 â”‚
â”‚ Store A â”‚  â”‚ Store B â”‚  â”‚ Store C â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     ?            ?            ?
```

ê° ì•±ì— ìŠ¤í† ì–´ê°€ ìˆìŒ. **ê³µìœ ê°€ ì•ˆ ë¨.**

### ì‹¤ì œë¡œ ê²ªì€ ë¬¸ì œ

1. Hostì—ì„œ ìœ ì € ì •ë³´ ì €ì¥
2. Remote2(ë¸”ë¡œê·¸)ì—ì„œ ìœ ì € ì •ë³´ í•„ìš” (ê¸€ ì‘ì„±ì í‘œì‹œ)
3. **Remote2ì˜ Redux ìŠ¤í† ì–´ì—ëŠ” ìœ ì € ì •ë³´ ì—†ìŒ**

```typescript
// remote2/src/components/PostEditor.tsx
const user = useSelector((state) => state.user);
// user === undefined ğŸ˜±
```

## 2. ì„ íƒì§€ ë¶„ì„

### ì˜µì…˜ 1: ë‹¨ì¼ ì „ì—­ ìŠ¤í† ì–´

ëª¨ë“  ì•±ì´ í•˜ë‚˜ì˜ Redux ìŠ¤í† ì–´ ê³µìœ .

```typescript
// Hostì—ì„œ ìŠ¤í† ì–´ ìƒì„±
const store = configureStore({ ... });

// Remoteì—ê²Œ ì „ë‹¬
<RemoteApp store={store} />
```

**ë¬¸ì œ:**
- Remoteê°€ Host ìŠ¤í† ì–´ì— ì™„ì „íˆ ì˜ì¡´
- ë…ë¦½ ì‹¤í–‰ ë¶ˆê°€
- ìˆœí™˜ ì˜ì¡´ì„± ìœ„í—˜

### ì˜µì…˜ 2: ì´ë²¤íŠ¸ ê¸°ë°˜ í†µì‹ 

Custom Eventsë¡œ ì•± ê°„ í†µì‹ .

```typescript
// Host
window.dispatchEvent(new CustomEvent(''user-login'', { detail: user }));

// Remote
window.addEventListener(''user-login'', (e) => {
  dispatch(setUser(e.detail));
});
```

**ë¬¸ì œ:**
- ì´ë²¤íŠ¸ ê´€ë¦¬ ë³µì¡
- íƒ€ì… ì•ˆì •ì„± ì—†ìŒ
- ë””ë²„ê¹… ì–´ë ¤ì›€

### ì˜µì…˜ 3: ê°ì ìŠ¤í† ì–´ + í•„ìš”í•œ ê²ƒë§Œ ê³µìœ 

**ì´ê±¸ ì„ íƒí•¨.**

ê° ì•±ì€ ìì‹ ì˜ ìŠ¤í† ì–´ë¥¼ ê°–ë˜, ê³µìœ ê°€ í•„ìš”í•œ ìƒíƒœë§Œ ë³„ë„ë¡œ ê´€ë¦¬.

## 3. ìƒíƒœ ë¶„ë¥˜

### ê³µìœ  ìƒíƒœ vs ë¡œì»¬ ìƒíƒœ

**ê³µìœ ê°€ í•„ìš”í•œ ìƒíƒœ:**
- ìœ ì € ì •ë³´ (ì¸ì¦)
- í…Œë§ˆ ì„¤ì •
- ì „ì—­ ì•Œë¦¼

**ë¡œì»¬ ìƒíƒœ:**
- ë¸”ë¡œê·¸ ê¸€ ëª©ë¡
- í¼ ì…ë ¥ê°’
- UI í† ê¸€ ìƒíƒœ

### ê³ ì°°: ìƒíƒœ ë¶„ë¥˜ì˜ ê¸°ì¤€

**"ì´ ìƒíƒœê°€ ì—†ìœ¼ë©´ ë‹¤ë¥¸ ì•±ì´ ë™ì‘ ëª» í•˜ëŠ”ê°€?"**

- Yes â†’ ê³µìœ  ìƒíƒœ
- No â†’ ë¡œì»¬ ìƒíƒœ

ëŒ€ë¶€ë¶„ì˜ ìƒíƒœëŠ” ë¡œì»¬ì„. ê³µìœ  ìƒíƒœëŠ” ìµœì†Œí™”í•´ì•¼ í•¨.

**ê³µìœ  ìƒíƒœê°€ ë§ì•„ì§€ë©´ ê²°í•©ë„ ë†’ì•„ì§ â†’ MFA ì¥ì  ì‚¬ë¼ì§.**

## 4. êµ¬í˜„ ì „ëµ

### 4-1. ë¡œì»¬ ìƒíƒœ: Redux Toolkit

ê° ì•±ì—ì„œ ìì‹ ë§Œì˜ ìŠ¤í† ì–´ ìš´ì˜.

```typescript
// remote2/src/store/index.ts
import { configureStore } from ''@reduxjs/toolkit'';
import postReducer from ''./slices/postSlice'';

export const store = configureStore({
  reducer: {
    posts: postReducer,
  },
});
```

```typescript
// remote2/src/store/slices/postSlice.ts
const postSlice = createSlice({
  name: ''posts'',
  initialState: {
    items: [],
    loading: false,
    error: null,
  },
  reducers: {
    // ...
  },
  extraReducers: (builder) => {
    // async thunk ì²˜ë¦¬
  },
});
```

### 4-2. ê³µìœ  ìƒíƒœ: localStorage + Context

```typescript
// lib/src/context/SharedContext.tsx
interface SharedState {
  user: User | null;
  theme: ''light'' | ''dark'';
}

const STORAGE_KEY = ''mfa-shared-state'';

const getInitialState = (): SharedState => {
  const stored = localStorage.getItem(STORAGE_KEY);
  return stored ? JSON.parse(stored) : { user: null, theme: ''light'' };
};

export const SharedProvider = ({ children }: { children: ReactNode }) => {
  const [state, setState] = useState<SharedState>(getInitialState);

  const updateState = (partial: Partial<SharedState>) => {
    setState((prev) => {
      const next = { ...prev, ...partial };
      localStorage.setItem(STORAGE_KEY, JSON.stringify(next));
      return next;
    });
  };

  return (
    <SharedContext.Provider value={{ state, updateState }}>
      {children}
    </SharedContext.Provider>
  );
};
```

### 4-3. ì•± ê°„ ë™ê¸°í™”

localStorageì˜ `storage` ì´ë²¤íŠ¸ í™œìš©.

```typescript
useEffect(() => {
  const handleStorageChange = (e: StorageEvent) => {
    if (e.key === STORAGE_KEY && e.newValue) {
      setState(JSON.parse(e.newValue));
    }
  };

  window.addEventListener(''storage'', handleStorageChange);
  return () => window.removeEventListener(''storage'', handleStorageChange);
}, []);
```

**Hostì—ì„œ ë¡œê·¸ì¸ â†’ localStorage ì—…ë°ì´íŠ¸ â†’ Remoteë“¤ ìë™ ë™ê¸°í™”**

## 5. Redux Toolkit í™œìš©

### createAsyncThunk

```typescript
// remote2/src/store/slices/postSlice.ts
export const fetchPosts = createAsyncThunk(
  ''posts/fetchPosts'',
  async (_, { rejectWithValue }) => {
    try {
      const response = await getPosts();
      return response.data;
    } catch (error) {
      return rejectWithValue(error.message);
    }
  }
);

const postSlice = createSlice({
  // ...
  extraReducers: (builder) => {
    builder
      .addCase(fetchPosts.pending, (state) => {
        state.loading = true;
        state.error = null;
      })
      .addCase(fetchPosts.fulfilled, (state, action) => {
        state.loading = false;
        state.items = action.payload;
      })
      .addCase(fetchPosts.rejected, (state, action) => {
        state.loading = false;
        state.error = action.payload as string;
      });
  },
});
```

### ê³ ì°°: Redux Toolkitì€ ì§„ì§œ í¸í•¨

Redux ì‹«ì–´í•˜ëŠ” ì‚¬ëŒë“¤ ë§ìŒ. ë³´ì¼ëŸ¬í”Œë ˆì´íŠ¸ ë§ì•„ì„œ.

**Redux Toolkitì€ ë‹¤ë¦„.**

- createSlice: reducer + action í•œ ë²ˆì—
- createAsyncThunk: ë¹„ë™ê¸° ì²˜ë¦¬ í‘œì¤€í™”
- RTK Query: ë°ì´í„° íŒ¨ì¹­ ìë™í™”

**ë„êµ¬ê°€ ë°œì „í•˜ë©´ ê¸°ì¡´ í¸ê²¬ì„ ì¬ê²€í† í•´ì•¼ í•¨.**

## 6. íƒ€ì… ì•ˆì „ì„±

### ë£¨íŠ¸ íƒ€ì… ì •ì˜

```typescript
// remote2/src/store/index.ts
export type RootState = ReturnType<typeof store.getState>;
export type AppDispatch = typeof store.dispatch;
```

### íƒ€ì…ë“œ í›…

```typescript
// remote2/src/store/hooks.ts
import { useDispatch, useSelector, TypedUseSelectorHook } from ''react-redux'';
import type { RootState, AppDispatch } from ''./index'';

export const useAppDispatch = () => useDispatch<AppDispatch>();
export const useAppSelector: TypedUseSelectorHook<RootState> = useSelector;
```

### ì‚¬ìš©

```typescript
// ì»´í¬ë„ŒíŠ¸ì—ì„œ
const posts = useAppSelector((state) => state.posts.items);
const dispatch = useAppDispatch();

dispatch(fetchPosts());  // íƒ€ì… ì²´í¬ë¨!
```

## 7. ì‚½ì§ˆ ê¸°ë¡

### ì‚½ì§ˆ 1: Redux DevTools ì¶©ëŒ

ê° ì•±ì´ Redux DevToolsì— ë¶™ìœ¼ë ¤ê³  í•˜ë©´ ì¶©ëŒ.

```
[DevTools] Store "posts" already exists.
```

í•´ê²°:
```typescript
configureStore({
  // ...
  devTools: {
    name: ''Remote2-Blog'',  // ì•±ë³„ ê³ ìœ  ì´ë¦„
  },
});
```

### ì‚½ì§ˆ 2: hydration ë¶ˆì¼ì¹˜

SSRì€ ì•ˆ ì“°ì§€ë§Œ, ì´ˆê¸° ìƒíƒœ ë¶ˆì¼ì¹˜ ë¬¸ì œëŠ” ìˆì—ˆìŒ.

```
localStorageì—ëŠ” ìœ ì € ì •ë³´ ìˆìŒ
ì²« ë Œë”ë§ ì‹œ nullë¡œ ì‹œì‘
hydration í›„ ìœ ì € ì •ë³´ í‘œì‹œ
â†’ ê¹œë¹¡ì„ ë°œìƒ
```

í•´ê²°: ì´ˆê¸° ìƒíƒœë¥¼ localStorageì—ì„œ ì½ì–´ì˜¤ê¸°
```typescript
const getPreloadedState = () => ({
  user: JSON.parse(localStorage.getItem(''mfa-shared-state'') || ''null''),
});

const store = configureStore({
  // ...
  preloadedState: getPreloadedState(),
});
```

### ì‚½ì§ˆ 3: ìˆœí™˜ ì°¸ì¡°

```
libê°€ Remoteì˜ íƒ€ì…ì„ ì°¸ì¡°
Remoteê°€ libë¥¼ ì°¸ì¡°
â†’ ë¹Œë“œ ì‹¤íŒ¨
```

í•´ê²°: ê³µìœ  íƒ€ì…ì€ libì—ë§Œ ì •ì˜, RemoteëŠ” lib íƒ€ì… importë§Œ.

## 8. ìµœì¢… ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                localStorage                     â”‚
â”‚            (ê³µìœ  ìƒíƒœ ì €ì¥ì†Œ)                    â”‚
â”‚       mfa-shared-state: { user, theme }         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†•              â†•              â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Host     â”‚  â”‚   Remote1   â”‚  â”‚   Remote2   â”‚
â”‚             â”‚  â”‚             â”‚  â”‚             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Context â”‚ â”‚  â”‚ â”‚ Context â”‚ â”‚  â”‚ â”‚ Context â”‚ â”‚
â”‚ â”‚ (ê³µìœ )  â”‚ â”‚  â”‚ â”‚ (ê³µìœ )  â”‚ â”‚  â”‚ â”‚ (ê³µìœ )  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Redux   â”‚ â”‚  â”‚ â”‚ Redux   â”‚ â”‚  â”‚ â”‚ Redux   â”‚ â”‚
â”‚ â”‚ (ë¡œì»¬)  â”‚ â”‚  â”‚ â”‚ (ë¡œì»¬)  â”‚ â”‚  â”‚ â”‚ (ë¡œì»¬)  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**í•µì‹¬: ê³µìœ  ìƒíƒœëŠ” Context + localStorage, ë¡œì»¬ ìƒíƒœëŠ” Redux**

## 9. ë°°ìš´ ê²ƒë“¤

### ê¸°ìˆ ì  êµí›ˆ

1. **MFAì—ì„œë„ Redux ì‚¬ìš© ê°€ëŠ¥ (ì•±ë³„ ìŠ¤í† ì–´)**
2. **ê³µìœ  ìƒíƒœëŠ” ìµœì†Œí™”**
3. **localStorage + storage ì´ë²¤íŠ¸ë¡œ ë™ê¸°í™”**
4. **Redux Toolkitì€ ë³´ì¼ëŸ¬í”Œë ˆì´íŠ¸ ê±°ì˜ ì—†ìŒ**

### ì„¤ê³„ êµí›ˆ

1. **ìƒíƒœë¥¼ ê³µìœ /ë¡œì»¬ë¡œ ëª…í™•íˆ ë¶„ë¥˜**
2. **ê³µìœ  ìƒíƒœê°€ ë§ìœ¼ë©´ ì„¤ê³„ ì¬ê²€í† **
3. **ë…ë¦½ì„±ê³¼ ê³µìœ ì˜ ê· í˜•**

### ê³ ì°°: ìƒíƒœê´€ë¦¬ì˜ ë³¸ì§ˆ

ìƒíƒœê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬(Redux, MobX, Zustand ë“±)ëŠ” ë„êµ¬ì„.

**ë„êµ¬ë³´ë‹¤ ì¤‘ìš”í•œ ê±´ "ì–´ë–¤ ìƒíƒœë¥¼ ì–´ë””ì„œ ê´€ë¦¬í•  ê²ƒì¸ê°€"ë¥¼ ê²°ì •í•˜ëŠ” ê²ƒ.**

- ì–´ë–¤ ìƒíƒœê°€ í•„ìš”í•œê°€?
- ê·¸ ìƒíƒœëŠ” ì–´ë””ì„œ ë°œìƒí•˜ëŠ”ê°€?
- ëˆ„ê°€ ê·¸ ìƒíƒœë¥¼ ì‚¬ìš©í•˜ëŠ”ê°€?
- ì–´ë””ì— ì €ì¥í•  ê²ƒì¸ê°€?

ì´ ì§ˆë¬¸ë“¤ì— ë‹µí•˜ë©´ ìì—°ìŠ¤ëŸ½ê²Œ êµ¬ì¡°ê°€ ë‚˜ì˜´.

**ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„ íƒì€ ê·¸ ë‹¤ìŒ ë¬¸ì œì„.**

---

*Written by ì†í˜¸ì„±*',
  'MFA í™˜ê²½ì—ì„œ Reduxë¥¼ ì“¸ ìˆ˜ ìˆì„ê¹Œ? ê³µìœ  ìƒíƒœì™€ ë¡œì»¬ ìƒíƒœë¥¼ ë¶„ë¦¬í•˜ê³ , localStorageì™€ Contextë¥¼ ì¡°í•©í•œ ìƒíƒœê´€ë¦¬ ì „ëµ.',
  'published',
  true,
  false,
  '9878b01c-1d9e-4b54-8323-f77735445b39',
  now(),
  now(),
  now()
);

-- í¬ìŠ¤íŠ¸ 5: Webpack Module Federation
INSERT INTO blog_posts (
  title,
  slug,
  content,
  excerpt,
  status,
  is_featured,
  is_pinned,
  user_id,
  published_at,
  created_at,
  updated_at
) VALUES (
  'ì„¤ì • íŒŒì¼ë§Œ 500ì¤„? - Webpack Module Federation ì„¤ì • ì™„ì „ ì •ë³µ',
  'mfa-webpack-module-federation-' || extract(epoch from now())::bigint,
  '# ì„¤ì • íŒŒì¼ë§Œ 500ì¤„? - Webpack Module Federation ì„¤ì • ì™„ì „ ì •ë³µ

## ì„œë¡ : Webpackê³¼ì˜ ì „ìŸ

MFAë¥¼ ì‹œì‘í•˜ë©´ì„œ ê°€ì¥ ë‘ë ¤ì› ë˜ ê±´ Webpack ì„¤ì •ì´ì—ˆìŒ.

"Webpack ì„¤ì • ë³µì¡í•´ì„œ Vite ì“°ì"ëŠ” ë§ì„ ë§ì´ ë“¤ì—ˆìŒ. ì‹¤ì œë¡œ Viteê°€ íŠ¸ë Œë“œì´ê¸°ë„ í•˜ê³ .

ê·¸ëŸ°ë° Module Federationì€ Webpack 5ì˜ ê¸°ëŠ¥ì´ì—ˆìŒ. Viteì—ì„œëŠ” í”ŒëŸ¬ê·¸ì¸ìœ¼ë¡œ ì¨ì•¼ í–ˆê³ , ì•„ì§ ì•ˆì •ì ì´ì§€ ì•Šë‹¤ëŠ” í‰ì´ ë§ì•˜ìŒ.

**ê²°êµ­ Webpackì„ ì„ íƒí•¨.** ê·¸ë¦¬ê³  3ì¼ê°„ ì„¤ì • íŒŒì¼ê³¼ ì‹¸ì› ìŒ.

## 1. ì™œ Module Federationì¸ê°€

### ëŸ°íƒ€ì„ í†µí•© vs ë¹Œë“œíƒ€ì„ í†µí•©

**ë¹Œë“œíƒ€ì„ í†µí•© (npm íŒ¨í‚¤ì§€)**
```
npm install @company/shared-lib
```
- ë¹Œë“œí•  ë•Œ ì½”ë“œ ë³µì‚¬
- ì—…ë°ì´íŠ¸í•˜ë ¤ë©´ ë‹¤ì‹œ ë¹Œë“œ
- **ëª¨ë“  ì•±ì„ ë‹¤ì‹œ ë°°í¬í•´ì•¼ í•¨**

**ëŸ°íƒ€ì„ í†µí•© (Module Federation)**
```
remotes: {
  blog: ''blog@http://localhost:3002/remoteEntry.js''
}
```
- ì‹¤í–‰í•  ë•Œ ì½”ë“œ ë¡œë“œ
- Remoteë§Œ ì—…ë°ì´íŠ¸í•˜ë©´ ë
- **ë…ë¦½ ë°°í¬ ê°€ëŠ¥**

### ê³ ì°°: ì–¸ì œ ë­˜ ì“¸ê¹Œ

npm íŒ¨í‚¤ì§€: ìì£¼ ì•ˆ ë°”ë€ŒëŠ” ê³µí†µ ìœ í‹¸ë¦¬í‹°
Module Federation: ë…ë¦½ì ìœ¼ë¡œ ë°°í¬í•´ì•¼ í•˜ëŠ” ì•±/ê¸°ëŠ¥

ë‚˜ì˜ ê²½ìš°:
- lib (ê³µí†µ ì»´í¬ë„ŒíŠ¸) â†’ npm íŒ¨í‚¤ì§€ (ì•ˆì •ì , ìì£¼ ì•ˆ ë°”ë€œ)
- Host, Remoteë“¤ â†’ Module Federation (ë…ë¦½ ë°°í¬ í•„ìš”)

## 2. ì„¤ì • íŒŒì¼ êµ¬ì¡°

### íŒŒì¼ ë¶„ë¦¬ ì „ëµ

```
webpack.common.js  // ê³µí†µ ì„¤ì •
webpack.dev.js     // ê°œë°œ í™˜ê²½
webpack.prod.js    // í”„ë¡œë•ì…˜ í™˜ê²½
```

**ì™œ ë¶„ë¦¬?**

ì²˜ìŒì—ëŠ” í•˜ë‚˜ì˜ íŒŒì¼ì— ë‹¤ ë„£ì—ˆìŒ.

```javascript
// webpack.config.js (400ì¤„ì§œë¦¬ ê´´ë¬¼)
module.exports = (env, argv) => {
  if (argv.mode === ''development'') {
    // ê°œë°œ ì„¤ì • 100ì¤„
  } else {
    // í”„ë¡œë•ì…˜ ì„¤ì • 100ì¤„
  }
  // ê³µí†µ ì„¤ì • 200ì¤„
};
```

ìœ ì§€ë³´ìˆ˜ ì§€ì˜¥ì´ì—ˆìŒ.

**ë¶„ë¦¬ í›„:**
```javascript
// webpack.dev.js
const { merge } = require(''webpack-merge'');
const common = require(''./webpack.common.js'');

module.exports = merge(common, {
  mode: ''development'',
  devServer: { ... },
});
```

**ê³ ì°°: ì„¤ì • íŒŒì¼ë„ ì½”ë“œì„**

"ì–´ì°¨í”¼ ì„¤ì • íŒŒì¼ì¸ë°" í•˜ê³  ëŒ€ì¶© ì§œë©´ ë‚˜ì¤‘ì— í›„íšŒí•¨.

**ì„¤ì • íŒŒì¼ë„ ìœ ì§€ë³´ìˆ˜ ëŒ€ìƒì„.** ê¹”ë”í•˜ê²Œ ê´€ë¦¬í•´ì•¼ í•¨.

## 3. webpack.common.js í•µì‹¬

### ê¸°ë³¸ êµ¬ì¡°

```javascript
const HtmlWebpackPlugin = require(''html-webpack-plugin'');
const { ModuleFederationPlugin } = require(''webpack'').container;
const path = require(''path'');

module.exports = {
  entry: ''./src/index.ts'',

  output: {
    path: path.resolve(__dirname, ''dist''),
    filename: ''[name].[contenthash].js'',
    publicPath: ''auto'',  // ì¤‘ìš”!
    clean: true,
  },

  resolve: {
    extensions: [''.tsx'', ''.ts'', ''.js''],
  },

  module: {
    rules: [
      {
        test: /\\.(ts|tsx)$/,
        use: ''babel-loader'',
        exclude: /node_modules/,
      },
      {
        test: /\\.css$/,
        use: [''style-loader'', ''css-loader''],
      },
    ],
  },

  plugins: [
    new HtmlWebpackPlugin({
      template: ''./public/index.html'',
    }),
  ],
};
```

### publicPath: ''auto'' ì˜ ë§ˆë²•

ì²˜ìŒì—ëŠ” ì´ë ‡ê²Œ í–ˆìŒ:
```javascript
publicPath: ''http://localhost:3002/''
```

ë¡œì»¬ì—ì„œëŠ” ì˜ ëìŒ. ë°°í¬í•˜ë©´?

**ë°•ì‚´ë‚¨.**

ì™œ? Vercel ì£¼ì†ŒëŠ” `https://blog-xxx.vercel.app/`ì¸ë°, publicPathëŠ” localhostë¥¼ ê°€ë¦¬í‚¤ê³  ìˆìœ¼ë‹ˆê¹Œ.

**í•´ê²°:**
```javascript
publicPath: ''auto''
```

Webpackì´ ì•Œì•„ì„œ í˜„ì¬ í˜¸ìŠ¤íŠ¸ ê¸°ì¤€ìœ¼ë¡œ ê²½ë¡œ ê³„ì‚°í•¨.

**ê³ ì°°: "auto"ì˜ í˜**

í•˜ë“œì½”ë”©ì€ í•­ìƒ ë¬¸ì œë¥¼ ë§Œë“¦. ê°€ëŠ¥í•˜ë©´ ë™ì ìœ¼ë¡œ.

## 4. Module Federation ì„¤ì •

### Host ì„¤ì •

```javascript
// host/webpack.common.js
new ModuleFederationPlugin({
  name: ''host'',

  remotes: {
    resume: ''resume@http://localhost:3001/remoteEntry.js'',
    blog: ''blog@http://localhost:3002/remoteEntry.js'',
    portfolio: ''portfolio@http://localhost:3003/remoteEntry.js'',
  },

  shared: {
    react: {
      singleton: true,
      requiredVersion: deps.react,
    },
    ''react-dom'': {
      singleton: true,
      requiredVersion: deps[''react-dom''],
    },
    ''react-router-dom'': {
      singleton: true,
      requiredVersion: deps[''react-router-dom''],
    },
  },
})
```

### Remote ì„¤ì •

```javascript
// remote2/webpack.common.js
new ModuleFederationPlugin({
  name: ''blog'',

  filename: ''remoteEntry.js'',

  exposes: {
    ''./App'': ''./src/App'',
    ''./LnbItems'': ''./src/exposes/LnbItems'',
  },

  shared: {
    react: {
      singleton: true,
      requiredVersion: deps.react,
    },
    // ...
  },
})
```

### í•µì‹¬ ì˜µì…˜ ì„¤ëª…

**name**
ëª¨ë“ˆ ì´ë¦„. ìœ ë‹ˆí¬í•´ì•¼ í•¨.

**filename**
Remoteì—ì„œ ìƒì„±í•˜ëŠ” ë§¤ë‹ˆí˜ìŠ¤íŠ¸ íŒŒì¼ëª…. Hostê°€ ì´ê±¸ ë¡œë“œí•¨.

**remotes**
Hostê°€ ë¡œë“œí•  Remote ëª©ë¡.
```
''ë³„ì¹­@ì›ê²©ì£¼ì†Œ/remoteEntry.js''
```

**exposes**
Remoteê°€ ì™¸ë¶€ì— ë…¸ì¶œí•  ëª¨ë“ˆ.
```
''./ë…¸ì¶œì´ë¦„'': ''./ì‹¤ì œê²½ë¡œ''
```

**shared**
ì•± ê°„ ê³µìœ í•  ì˜ì¡´ì„±.

## 5. shared ì„¤ì • ì‹¬í™”

### ë¬¸ì œ: Reactê°€ ë‘ ë²ˆ ë¡œë“œë¨

```
Warning: Invalid hook call.
You might have more than one copy of React in the same app.
```

**ì›ì¸:**
Hostì—ì„œ React ë¡œë“œ â†’ Remoteì—ì„œ ë˜ React ë¡œë“œ â†’ ë²„ì „ ì¶©ëŒ

### í•´ê²°: singleton

```javascript
shared: {
  react: {
    singleton: true,  // ë”± í•˜ë‚˜ë§Œ!
    strictVersion: true,  // ë²„ì „ ì•ˆ ë§ìœ¼ë©´ ì—ëŸ¬
    requiredVersion: ''^19.0.0'',
  },
}
```

**singleton: true**
ì „ì²´ ì•±ì—ì„œ í•´ë‹¹ ëª¨ë“ˆì„ í•˜ë‚˜ë§Œ ë¡œë“œ.

**strictVersion: true**
ë²„ì „ì´ ë‹¤ë¥´ë©´ ì—ëŸ¬. falseë©´ ê²½ê³ ë§Œ.

### eager ì˜µì…˜

```javascript
shared: {
  react: {
    singleton: true,
    eager: true,  // ì¦‰ì‹œ ë¡œë“œ
  },
}
```

**eager: true**ì˜ ì˜ë¯¸:
- ê¸°ë³¸ê°’(false): í•„ìš”í•  ë•Œ ë¡œë“œ (lazy)
- true: ì•± ì‹œì‘í•  ë•Œ ì¦‰ì‹œ ë¡œë“œ

**ì–¸ì œ eager: true?**
- Remoteë¥¼ ë‹¨ë… ì‹¤í–‰í•  ë•Œ
- ë²ˆë“¤ í¬ê¸°ë³´ë‹¤ ì´ˆê¸° ë¡œë“œ ì•ˆì •ì„±ì´ ì¤‘ìš”í•  ë•Œ

### ë²„ì „ ì¶©ëŒ í•´ê²°

```bash
npm ls react
# host: react@19.2.3
# remote1: react@19.2.1  â† ë‹¤ë¦„!
```

**ëª¨ë“  ì•±ì˜ ë²„ì „ í†µì¼:**
```json
// ëª¨ë“  package.json
{
  "dependencies": {
    "react": "^19.2.3"
  }
}
```

**ê³ ì°°: ì˜ì¡´ì„± ì§€ì˜¥**

MFAì—ì„œ ê°€ì¥ ë§ì´ ì‚½ì§ˆí•˜ëŠ” ë¶€ë¶„ì´ shared ì˜ì¡´ì„±ì„.

**"ë²„ì „ì„ í†µì¼í•˜ì"ëŠ” ì›ì¹™ì„ ì„¸ìš°ê³  ì§€í‚¤ëŠ” ê²Œ ì¤‘ìš”.**

## 6. ê°œë°œ ì„œë²„ ì„¤ì •

### webpack.dev.js

```javascript
const { merge } = require(''webpack-merge'');
const common = require(''./webpack.common.js'');

module.exports = merge(common, {
  mode: ''development'',

  devtool: ''inline-source-map'',

  devServer: {
    port: 3002,
    hot: true,
    historyApiFallback: true,  // SPA ë¼ìš°íŒ…!

    headers: {
      ''Access-Control-Allow-Origin'': ''*'',  // CORS
    },

    static: {
      directory: path.join(__dirname, ''public''),
    },
  },
});
```

### historyApiFallback

SPAì—ì„œ í•„ìˆ˜.

```
/blog/post/hello-world ì ‘ì†
â†’ ì„œë²„ì—ëŠ” ê·¸ëŸ° íŒŒì¼ ì—†ìŒ
â†’ 404?

historyApiFallback: true
â†’ index.html ë°˜í™˜
â†’ React Routerê°€ ì²˜ë¦¬
â†’ ì •ìƒ!
```

### CORS í—¤ë”

Host(3000)ì—ì„œ Remote(3002)ë¥¼ ë¡œë“œí•˜ë ¤ë©´ CORS í—ˆìš© í•„ìš”.

```javascript
headers: {
  ''Access-Control-Allow-Origin'': ''*'',
}
```

## 7. í”„ë¡œë•ì…˜ ì„¤ì •

### webpack.prod.js

```javascript
const { merge } = require(''webpack-merge'');
const common = require(''./webpack.common.js'');

module.exports = merge(common, {
  mode: ''production'',

  output: {
    publicPath: ''/'',  // Vercel ê¸°ì¤€
  },

  optimization: {
    splitChunks: {
      chunks: ''all'',
    },
    minimize: true,
  },

  performance: {
    hints: ''warning'',
    maxEntrypointSize: 512000,
    maxAssetSize: 512000,
  },
});
```

### splitChunks

```javascript
splitChunks: {
  chunks: ''all'',
  cacheGroups: {
    vendor: {
      test: /[\\\\/]node_modules[\\\\/]/,
      name: ''vendors'',
      chunks: ''all'',
    },
  },
},
```

node_modulesë¥¼ ë³„ë„ ë²ˆë“¤ë¡œ ë¶„ë¦¬ â†’ ìºì‹± íš¨ìœ¨í™”

## 8. í™˜ê²½ë³€ìˆ˜ ì„¤ì •

### dotenv-webpack

```javascript
// webpack.common.js
const Dotenv = require(''dotenv-webpack'');

module.exports = {
  plugins: [
    new Dotenv({
      systemvars: true,  // ì‹œìŠ¤í…œ í™˜ê²½ë³€ìˆ˜ë„ í¬í•¨
    }),
  ],
};
```

### .env íŒŒì¼

```bash
# .env
REACT_APP_SUPABASE_URL=https://xxx.supabase.co
REACT_APP_SUPABASE_ANON_KEY=xxx
```

### ì½”ë“œì—ì„œ ì‚¬ìš©

```typescript
const supabaseUrl = process.env.REACT_APP_SUPABASE_URL || '''';
```

### ê³ ì°°: í™˜ê²½ë³€ìˆ˜ ë„¤ì´ë°

REACT_APP_ ì ‘ë‘ì‚¬ë¥¼ ì“°ëŠ” ì´ìœ :
- CRA ì»¨ë²¤ì…˜ê³¼ í˜¸í™˜
- ì–´ë–¤ ê²Œ í”„ë¡ íŠ¸ì—”ë“œ í™˜ê²½ë³€ìˆ˜ì¸ì§€ ëª…í™•

**ì»¨ë²¤ì…˜ ë”°ë¥´ë©´ ì‚¶ì´ í¸í•´ì§.**

## 9. íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### ë¬¸ì œ 1: "Shared module is not available for eager consumption"

```
Uncaught Error: Shared module is not available for eager consumption
```

**ì›ì¸:** bootstrap íŒ¨í„´ ë¯¸ì ìš©

**í•´ê²°:**
```typescript
// index.ts
import(''./bootstrap'');

// bootstrap.tsx
import React from ''react'';
import { createRoot } from ''react-dom/client'';
import App from ''./App'';

createRoot(document.getElementById(''root'')!).render(<App />);
```

**ì™œ ì´ë ‡ê²Œ?**
shared ëª¨ë“ˆì€ ë¹„ë™ê¸°ë¡œ ë¡œë“œë¨. import()ë¡œ ê°ì‹¸ì„œ ë¡œë“œ ì™„ë£Œ í›„ ì‹¤í–‰.

### ë¬¸ì œ 2: "Container initialization failed"

**ì›ì¸:** Remoteê°€ ì•„ì§ ì•ˆ ë–´ìŒ

**í•´ê²°:** ì—ëŸ¬ ë°”ìš´ë”ë¦¬ + ë¡œë”© ì²˜ë¦¬
```tsx
<Suspense fallback={<Loading />}>
  <ErrorBoundary fallback={<RemoteError />}>
    <RemoteApp />
  </ErrorBoundary>
</Suspense>
```

### ë¬¸ì œ 3: HMR ì•ˆ ë¨

**ì›ì¸:** React Refresh ë¯¸ì„¤ì •

**í•´ê²°:**
```javascript
// webpack.dev.js
const ReactRefreshPlugin = require(''@pmmmwh/react-refresh-webpack-plugin'');

module.exports = merge(common, {
  plugins: [
    new ReactRefreshPlugin(),
  ],
});
```

## 10. ìµœì¢… ì„¤ì • ìš”ì•½

```
[ Host ]
- remotesë¡œ Remoteë“¤ ì„ ì–¸
- sharedë¡œ ê³µìœ  ì˜ì¡´ì„± ì„¤ì •
- singleton: true í•„ìˆ˜

[ Remote ]
- exposesë¡œ ì™¸ë¶€ ë…¸ì¶œ ëª¨ë“ˆ ì„ ì–¸
- filename: ''remoteEntry.js''
- shared ì„¤ì • Hostì™€ ë™ì¼í•˜ê²Œ

[ ê³µí†µ ]
- publicPath: ''auto''
- historyApiFallback: true
- bootstrap íŒ¨í„´ ì‚¬ìš©
- ì˜ì¡´ì„± ë²„ì „ í†µì¼
```

## 11. ë°°ìš´ ê²ƒë“¤

### ê¸°ìˆ ì  êµí›ˆ

1. **Module Federation = ëŸ°íƒ€ì„ í†µí•©**
2. **shared + singleton = React ì¶©ëŒ ë°©ì§€**
3. **publicPath: auto = ë°°í¬ í™˜ê²½ ëŒ€ì‘**
4. **bootstrap íŒ¨í„´ = ë¹„ë™ê¸° ë¡œë“œ ì²˜ë¦¬**

### ì„¤ì • ê´€ë¦¬ êµí›ˆ

1. **webpack íŒŒì¼ ë¶„ë¦¬ (common, dev, prod)**
2. **ì„¤ì •ë„ ì½”ë“œì²˜ëŸ¼ ê´€ë¦¬**
3. **í™˜ê²½ë³€ìˆ˜ëŠ” dotenvë¡œ**

### ê³ ì°°: Webpackì— ëŒ€í•œ í¸ê²¬

"Webpack ë³µì¡í•´ì„œ ì‹«ì–´" ë§ì´ ë“¤ì—ˆìŒ.

**ë³µì¡í•œ ê²Œ ì•„ë‹ˆë¼ ìµìˆ™í•˜ì§€ ì•Šì€ ê²ƒì„.**

Viteê°€ ë” ê°„ë‹¨í•œ ê±´ ë§ìŒ. ê·¸ëŸ°ë° Module Federation ê°™ì€ ê³ ê¸‰ ê¸°ëŠ¥ì´ í•„ìš”í•˜ë©´ ê²°êµ­ ê¹Šì´ ìˆëŠ” ë„êµ¬ê°€ í•„ìš”í•¨.

**"ë³µì¡í•˜ë‹¤"ëŠ” ì´ìœ ë¡œ ë„êµ¬ë¥¼ íšŒí”¼í•˜ì§€ ë§ ê²ƒ.** í•„ìš”í•˜ë©´ ë°°ì›Œì•¼ í•¨.

---

*Written by ì†í˜¸ì„±*',
  'Webpack Module Federation ì„¤ì •ì˜ ëª¨ë“  ê²ƒ. shared, exposes, remotes ì„¤ì •ê³¼ ì‚½ì§ˆ ê¸°ë¡.',
  'published',
  true,
  false,
  '9878b01c-1d9e-4b54-8323-f77735445b39',
  now(),
  now(),
  now()
);

-- í¬ìŠ¤íŠ¸ 6: ë¡œë”© ì²˜ë¦¬
INSERT INTO blog_posts (
  title,
  slug,
  content,
  excerpt,
  status,
  is_featured,
  is_pinned,
  user_id,
  published_at,
  created_at,
  updated_at
) VALUES (
  'ì›ê²© ì•± ë¡œë”© ì¤‘... ì„ ìš°ì•„í•˜ê²Œ - React.lazyì™€ Suspense ì™„ë²½ í™œìš©',
  'mfa-loading-suspense-' || extract(epoch from now())::bigint,
  '# ì›ê²© ì•± ë¡œë”© ì¤‘... ì„ ìš°ì•„í•˜ê²Œ - React.lazyì™€ Suspense ì™„ë²½ í™œìš©

## ì„œë¡ : ë¡œë”©ì€ UXì˜ í•µì‹¬

MFAì—ì„œ Remote ì•±ì„ ë¡œë“œí•˜ëŠ” ê±´ **ë„¤íŠ¸ì›Œí¬ ìš”ì²­**ì„.

ë„¤íŠ¸ì›Œí¬ ìš”ì²­ = ì‹œê°„ì´ ê±¸ë¦¼ = ìœ ì €ê°€ ê¸°ë‹¤ë¦¼

**ê¸°ë‹¤ë¦¬ëŠ” ë™ì•ˆ ë­˜ ë³´ì—¬ì¤„ ê²ƒì¸ê°€?**

ì´ê²Œ ë¡œë”© ì²˜ë¦¬ì˜ í•µì‹¬ì„.

## 1. ë¬¸ì œ ìƒí™©

### ë¡œë”© ì²˜ë¦¬ ì—†ì„ ë•Œ

```tsx
// Hostì—ì„œ Remote ë¡œë“œ
const BlogApp = React.lazy(() => import(''blog/App''));

// ê·¸ëƒ¥ ë Œë”ë§
<BlogApp />
```

ê²°ê³¼:
1. ìœ ì €ê°€ ë¸”ë¡œê·¸ ë©”ë‰´ í´ë¦­
2. ë„¤íŠ¸ì›Œí¬ì—ì„œ Remote ë¡œë“œ ì¤‘...
3. **3ì´ˆê°„ ì•„ë¬´ê²ƒë„ ì•ˆ ë³´ì„**
4. ê°‘ìê¸° ì½˜í…ì¸  ë“±ì¥

**ìœ ì €: "ì–´? ë²„ê·¸ì¸ê°€? í´ë¦­ ì•ˆ ëë‚˜?"**

í´ë¦­ì„ ì—¬ëŸ¬ ë²ˆ í•˜ê²Œ ë¨. ìµœì•…ì˜ UX.

### ê³ ì°°: í”¼ë“œë°±ì˜ ì¤‘ìš”ì„±

ìœ ì €ëŠ” **ë¬´ìŠ¨ ì¼ì´ ì¼ì–´ë‚˜ê³  ìˆëŠ”ì§€** ì•Œì•„ì•¼ í•¨.

ë¡œë”© ì¤‘ì´ë©´ ë¡œë”© ì¤‘ì´ë¼ê³  ì•Œë ¤ì¤˜ì•¼ í•¨.
ì—ëŸ¬ë©´ ì—ëŸ¬ë¼ê³  ì•Œë ¤ì¤˜ì•¼ í•¨.

**ì¹¨ë¬µì€ ìµœì•…ì˜ í”¼ë“œë°±ì„.**

## 2. React.lazy ì´í•´í•˜ê¸°

### ê¸°ë³¸ ì‚¬ìš©ë²•

```tsx
const BlogApp = React.lazy(() => import(''blog/App''));
```

**ë¬´ìŠ¨ ì¼ì´ ì¼ì–´ë‚˜ë‚˜?**
1. BlogApp ì»´í¬ë„ŒíŠ¸ê°€ ë Œë”ë§ë  ë•Œ
2. `import(''blog/App'')`ì´ ì‹¤í–‰ë¨
3. ë„¤íŠ¸ì›Œí¬ì—ì„œ ì½”ë“œ ë¡œë“œ
4. ë¡œë“œ ì™„ë£Œ í›„ ë Œë”ë§

### ë™ì  importì˜ ì˜ë¯¸

```tsx
// ì •ì  import: ì•± ì‹œì‘í•  ë•Œ ì „ë¶€ ë¡œë“œ
import BlogApp from ''blog/App'';

// ë™ì  import: í•„ìš”í•  ë•Œ ë¡œë“œ
const BlogApp = React.lazy(() => import(''blog/App''));
```

**ë™ì  importì˜ ì¥ì :**
- ì´ˆê¸° ë²ˆë“¤ í¬ê¸° ê°ì†Œ
- í•„ìš”í•  ë•Œë§Œ ë¡œë“œ
- Code Splitting ìë™í™”

## 3. Suspense ê¸°ë³¸

### ê¸°ë³¸ ì‚¬ìš©ë²•

```tsx
<Suspense fallback={<div>ë¡œë”© ì¤‘...</div>}>
  <BlogApp />
</Suspense>
```

**Suspenseì˜ ì—­í• :**
lazy ì»´í¬ë„ŒíŠ¸ê°€ ë¡œë”© ì¤‘ì¼ ë•Œ fallbackì„ ë³´ì—¬ì¤Œ.

### ë¡œë”© ì»´í¬ë„ŒíŠ¸ ë§Œë“¤ê¸°

```tsx
// src/components/Loading.tsx
export const Loading = () => {
  return (
    <div className="loading-container">
      <div className="spinner" />
      <p>ì½˜í…ì¸ ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
    </div>
  );
};
```

```css
.loading-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  min-height: 300px;
}

.spinner {
  width: 40px;
  height: 40px;
  border: 3px solid #f3f3f3;
  border-top: 3px solid #3498db;
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
```

```tsx
<Suspense fallback={<Loading />}>
  <BlogApp />
</Suspense>
```

## 4. MFAì—ì„œì˜ Suspense í™œìš©

### ë¬¸ì œ: Remote ë¡œë”©ì€ ë” ì˜¤ë˜ ê±¸ë¦¼

ì¼ë°˜ lazy ë¡œë”©: ê°™ì€ ë„ë©”ì¸ì—ì„œ ë²ˆë“¤ ë¡œë“œ
Remote ë¡œë”©: **ë‹¤ë¥¸ ì„œë²„ì—ì„œ ì½”ë“œ ë¡œë“œ**

```
ì¼ë°˜ lazy: 100ms ~ 500ms
Remote: 500ms ~ 3ì´ˆ
```

**ë” ê¸¸ê²Œ ë³´ì—¬ì¤„ ì¤€ë¹„ê°€ í•„ìš”í•¨.**

### ìŠ¤ì¼ˆë ˆí†¤ UI

```tsx
// src/components/BlogSkeleton.tsx
export const BlogSkeleton = () => {
  return (
    <div className="blog-skeleton">
      <div className="skeleton-header" />
      <div className="skeleton-content">
        <div className="skeleton-line" />
        <div className="skeleton-line" />
        <div className="skeleton-line short" />
      </div>
    </div>
  );
};
```

```css
.skeleton-line {
  height: 16px;
  background: linear-gradient(
    90deg,
    #f0f0f0 25%,
    #e0e0e0 50%,
    #f0f0f0 75%
  );
  background-size: 200% 100%;
  animation: shimmer 1.5s infinite;
}

@keyframes shimmer {
  0% { background-position: -200% 0; }
  100% { background-position: 200% 0; }
}
```

**ìŠ¤ì¼ˆë ˆí†¤ UIì˜ ì¥ì :**
- ì½˜í…ì¸  êµ¬ì¡°ë¥¼ ë¯¸ë¦¬ ë³´ì—¬ì¤Œ
- ë¡œë”©ì´ ë¹ ë¥´ê²Œ ëŠê»´ì§
- "ë­”ê°€ ë˜ê³  ìˆêµ¬ë‚˜" ì¸ì‹

### í˜ì´ì§€ë³„ ìŠ¤ì¼ˆë ˆí†¤

```tsx
// Hostì—ì„œ
const BlogApp = React.lazy(() => import(''blog/App''));
const ResumeApp = React.lazy(() => import(''resume/App''));

<Route
  path="/blog/*"
  element={
    <Suspense fallback={<BlogSkeleton />}>
      <BlogApp />
    </Suspense>
  }
/>

<Route
  path="/resume/*"
  element={
    <Suspense fallback={<ResumeSkeleton />}>
      <ResumeApp />
    </Suspense>
  }
/>
```

## 5. ì¤‘ì²© Suspense

### ë¬¸ì œ: Remote ì•ˆì—ì„œë„ lazy ë¡œë”©

```tsx
// Remote2 (Blog) ë‚´ë¶€
const PostDetail = React.lazy(() => import(''./pages/PostDetail''));

<Route
  path="/post/:slug"
  element={
    <Suspense fallback={<PostSkeleton />}>
      <PostDetail />
    </Suspense>
  }
/>
```

ì´ì œ ë¡œë”©ì´ ë‘ ë²ˆ ë°œìƒ:
1. Host â†’ Remote2 ë¡œë”©
2. Remote2 â†’ PostDetail ë¡œë”©

### í•´ê²°: Suspense ì¤‘ì²©

```tsx
// Host
<Suspense fallback={<BlogSkeleton />}>
  <BlogApp />  {/* ì•ˆì— ë˜ Suspense ìˆìŒ */}
</Suspense>
```

**SuspenseëŠ” ì¤‘ì²© ê°€ëŠ¥!**

ì™¸ë¶€ Suspense: Remote ì „ì²´ ë¡œë”©
ë‚´ë¶€ Suspense: í˜ì´ì§€ë³„ ë¡œë”©

### ê³ ì°°: ë¡œë”© ê²½í—˜ì˜ ì—°ì†ì„±

ìœ ì € ê²½í—˜:
1. ë¸”ë¡œê·¸ ë©”ë‰´ í´ë¦­ â†’ ë¸”ë¡œê·¸ ìŠ¤ì¼ˆë ˆí†¤
2. ë¸”ë¡œê·¸ ë¡œë“œ ì™„ë£Œ â†’ ê¸€ ëª©ë¡ í‘œì‹œ
3. ê¸€ í´ë¦­ â†’ ê¸€ ìƒì„¸ ìŠ¤ì¼ˆë ˆí†¤
4. ê¸€ ë¡œë“œ ì™„ë£Œ â†’ ê¸€ ë‚´ìš© í‘œì‹œ

**ê° ë‹¨ê³„ì—ì„œ ì ì ˆí•œ í”¼ë“œë°±.** ì´ê²Œ ì¢‹ì€ UX.

## 6. ë¡œë”© ìƒíƒœ ê³ ê¸‰ ì²˜ë¦¬

### ìµœì†Œ ë¡œë”© ì‹œê°„

```tsx
const DelayedLoading = ({ children, minDelay = 300 }) => {
  const [isReady, setIsReady] = useState(false);

  useEffect(() => {
    const timer = setTimeout(() => setIsReady(true), minDelay);
    return () => clearTimeout(timer);
  }, [minDelay]);

  return isReady ? children : null;
};
```

**ì™œ ìµœì†Œ ë¡œë”© ì‹œê°„?**

ë¡œë”©ì´ ë„ˆë¬´ ë¹¨ë¦¬ ëë‚˜ë©´ ê¹œë¹¡ì„ ë°œìƒ.
50ms ë™ì•ˆ ìŠ¤ì¼ˆë ˆí†¤ ë³´ì´ë‹¤ê°€ ì½˜í…ì¸  â†’ **ì˜¤íˆë ¤ ì‚°ë§Œí•¨**

ìµœì†Œ 300msëŠ” ë³´ì—¬ì£¼ëŠ” ê²Œ ìì—°ìŠ¤ëŸ¬ì›€.

### ë¡œë”© ì§€ì—° ì²˜ë¦¬

```tsx
const useDelayedLoading = (isLoading: boolean, delay = 200) => {
  const [showLoading, setShowLoading] = useState(false);

  useEffect(() => {
    let timer: NodeJS.Timeout;

    if (isLoading) {
      timer = setTimeout(() => setShowLoading(true), delay);
    } else {
      setShowLoading(false);
    }

    return () => clearTimeout(timer);
  }, [isLoading, delay]);

  return showLoading;
};
```

**ì™œ ë¡œë”© ì§€ì—°?**

200ms ì•ˆì— ëë‚˜ë©´ ë¡œë”© í‘œì‹œ ì•ˆ í•¨.
ë¹ ë¥¸ ì‘ë‹µì—ëŠ” ê¹œë¹¡ì„ ì—†ì´, ëŠë¦° ì‘ë‹µì—ë§Œ ë¡œë”© í‘œì‹œ.

## 7. í”„ë¦¬ë¡œë”©

### í˜¸ë²„ ì‹œ í”„ë¦¬ë¡œë“œ

```tsx
const BlogLink = () => {
  const preloadBlog = () => {
    import(''blog/App'');
  };

  return (
    <Link
      to="/blog"
      onMouseEnter={preloadBlog}
    >
      ë¸”ë¡œê·¸
    </Link>
  );
};
```

ìœ ì €ê°€ ë©”ë‰´ì— ë§ˆìš°ìŠ¤ ì˜¬ë¦¬ë©´ ë¯¸ë¦¬ ë¡œë“œ ì‹œì‘.

í´ë¦­í•  ë•ŒëŠ” ì´ë¯¸ ë¡œë“œ ì™„ë£Œ â†’ **ì¦‰ì‹œ í‘œì‹œ**

### Intersection Observerë¡œ í”„ë¦¬ë¡œë“œ

```tsx
const usePreloadOnVisible = (preloadFn: () => void) => {
  const ref = useRef<HTMLDivElement>(null);

  useEffect(() => {
    const observer = new IntersectionObserver(
      ([entry]) => {
        if (entry.isIntersecting) {
          preloadFn();
          observer.disconnect();
        }
      },
      { rootMargin: ''100px'' }
    );

    if (ref.current) {
      observer.observe(ref.current);
    }

    return () => observer.disconnect();
  }, [preloadFn]);

  return ref;
};
```

í™”ë©´ì— ë³´ì´ê¸° 100px ì „ì— í”„ë¦¬ë¡œë“œ ì‹œì‘.

## 8. ì‚½ì§ˆ ê¸°ë¡

### ì‚½ì§ˆ 1: Suspense ìœ„ì¹˜

```tsx
// âŒ ì˜ëª»ëœ ìœ„ì¹˜
<Suspense>
  <Router>
    <Routes>
      <Route path="/blog/*" element={<BlogApp />} />
    </Routes>
  </Router>
</Suspense>
```

ë¬¸ì œ: ì „ì²´ ì•±ì´ ë¡œë”© ìƒíƒœê°€ ë¨.

```tsx
// âœ… ì˜¬ë°”ë¥¸ ìœ„ì¹˜
<Router>
  <Routes>
    <Route
      path="/blog/*"
      element={
        <Suspense fallback={<Loading />}>
          <BlogApp />
        </Suspense>
      }
    />
  </Routes>
</Router>
```

**SuspenseëŠ” lazy ì»´í¬ë„ŒíŠ¸ë¥¼ ê°ì‹¸ëŠ” ìœ„ì¹˜ì—.**

### ì‚½ì§ˆ 2: fallback ê¹œë¹¡ì„

ë¹ ë¥¸ ì‘ë‹µì—ì„œ ìŠ¤ì¼ˆë ˆí†¤ì´ ì ê¹ ë³´ì˜€ë‹¤ê°€ ì‚¬ë¼ì§€ëŠ” í˜„ìƒ.

```tsx
// í•´ê²°: ìµœì†Œ í‘œì‹œ ì‹œê°„ ë³´ì¥
const [showFallback, setShowFallback] = useState(true);

useEffect(() => {
  const timer = setTimeout(() => {
    setShowFallback(false);
  }, 300);
  return () => clearTimeout(timer);
}, []);
```

### ì‚½ì§ˆ 3: key ë¬¸ì œ

ê°™ì€ ê²½ë¡œì¸ë° ë‹¤ë¥¸ ë°ì´í„°ë¥¼ ë¡œë“œí•´ì•¼ í•  ë•Œ:

```tsx
// âŒ ìºì‹œëœ ì»´í¬ë„ŒíŠ¸ê°€ ê·¸ëŒ€ë¡œ ë³´ì„
<Route path="/post/:slug" element={<PostDetail />} />
```

```tsx
// âœ… keyë¡œ ê°•ì œ ë¦¬ë Œë”ë§
<Route
  path="/post/:slug"
  element={
    <Suspense key={slug} fallback={<PostSkeleton />}>
      <PostDetail />
    </Suspense>
  }
/>
```

## 9. ìµœì¢… êµ¬ì¡°

```tsx
// Host App.tsx
const BlogApp = React.lazy(() => import(''blog/App''));
const ResumeApp = React.lazy(() => import(''resume/App''));
const PortfolioApp = React.lazy(() => import(''portfolio/App''));

const App = () => {
  return (
    <ErrorBoundary fallback={<AppError />}>
      <Router>
        <Layout>
          <Routes>
            <Route
              path="/blog/*"
              element={
                <Suspense fallback={<BlogSkeleton />}>
                  <ErrorBoundary fallback={<RemoteError name="ë¸”ë¡œê·¸" />}>
                    <BlogApp />
                  </ErrorBoundary>
                </Suspense>
              }
            />
            {/* ë‹¤ë¥¸ Remoteë“¤ë„ ê°™ì€ íŒ¨í„´ */}
          </Routes>
        </Layout>
      </Router>
    </ErrorBoundary>
  );
};
```

## 10. ë°°ìš´ ê²ƒë“¤

### ê¸°ìˆ ì  êµí›ˆ

1. **React.lazy + Suspense = ì„ ì–¸ì  ë¡œë”© ì²˜ë¦¬**
2. **ìŠ¤ì¼ˆë ˆí†¤ UIê°€ ìŠ¤í”¼ë„ˆë³´ë‹¤ ì¢‹ì€ UX**
3. **ì¤‘ì²© Suspenseë¡œ ì„¸ë¶„í™”ëœ ë¡œë”©**
4. **í”„ë¦¬ë¡œë”©ìœ¼ë¡œ ì²´ê° ì†ë„ í–¥ìƒ**

### UX êµí›ˆ

1. **ì¹¨ë¬µì€ ìµœì•…ì˜ í”¼ë“œë°±**
2. **ë¡œë”© ì¤‘ì„ì„ ëª…í™•íˆ ì•Œë ¤ì•¼ í•¨**
3. **ìµœì†Œ ë¡œë”© ì‹œê°„ìœ¼ë¡œ ê¹œë¹¡ì„ ë°©ì§€**
4. **ì½˜í…ì¸  êµ¬ì¡° ë¯¸ë¦¬ ë³´ì—¬ì£¼ê¸° (ìŠ¤ì¼ˆë ˆí†¤)**

### ê³ ì°°: ë¡œë”©ì€ ì‹¤íŒ¨ê°€ ì•„ë‹˜

"ë¡œë”©ì´ ë³´ì¸ë‹¤ = ëŠë¦¬ë‹¤"ë¼ê³  ìƒê°í•  ìˆ˜ ìˆìŒ.

**ì•„ë‹˜.**

ë¡œë”©ì€ ìì—°ìŠ¤ëŸ¬ìš´ ê²ƒì„. ë„¤íŠ¸ì›Œí¬ëŠ” ì›ë˜ ì‹œê°„ì´ ê±¸ë¦¼.

ì¤‘ìš”í•œ ê±´ **ë¡œë”©ì„ ìˆ¨ê¸°ëŠ” ê²Œ ì•„ë‹ˆë¼ ìš°ì•„í•˜ê²Œ ì²˜ë¦¬í•˜ëŠ” ê²ƒ.**

---

*Written by ì†í˜¸ì„±*',
  'MFAì—ì„œ Remote ì•± ë¡œë”©ì„ ìš°ì•„í•˜ê²Œ ì²˜ë¦¬í•˜ëŠ” ë°©ë²•. React.lazy, Suspense, ìŠ¤ì¼ˆë ˆí†¤ UI, í”„ë¦¬ë¡œë”©ê¹Œì§€.',
  'published',
  true,
  false,
  '9878b01c-1d9e-4b54-8323-f77735445b39',
  now(),
  now(),
  now()
);

-- í¬ìŠ¤íŠ¸ 7: ì—ëŸ¬ ì²˜ë¦¬
INSERT INTO blog_posts (
  title,
  slug,
  content,
  excerpt,
  status,
  is_featured,
  is_pinned,
  user_id,
  published_at,
  created_at,
  updated_at
) VALUES (
  'Remoteê°€ ì£½ìœ¼ë©´ Hostë„ ì£½ëŠ”ë‹¤? - MFA ì—ëŸ¬ ê²©ë¦¬ì™€ ë³µêµ¬ ì „ëµ',
  'mfa-error-handling-' || extract(epoch from now())::bigint,
  '# Remoteê°€ ì£½ìœ¼ë©´ Hostë„ ì£½ëŠ”ë‹¤? - MFA ì—ëŸ¬ ê²©ë¦¬ì™€ ë³µêµ¬ ì „ëµ

## ì„œë¡ : ê³µí¬ì˜ í°í™”ë©´

ì–´ëŠ ë‚  ì´ëŸ° ì¼ì´ ìˆì—ˆìŒ.

ë¸”ë¡œê·¸(Remote2)ì—ì„œ ì½”ë“œ ìˆ˜ì • ì¤‘ ì‹¤ìˆ˜ë¡œ ëŸ°íƒ€ì„ ì—ëŸ¬ë¥¼ ë§Œë“¤ì—ˆìŒ.

```
TypeError: Cannot read properties of undefined (reading ''title'')
```

ê·¸ëŸ°ë°... **Host ì „ì²´ê°€ í°í™”ë©´ì´ ë¨.**

ì´ë ¥ì„œë„ ì•ˆ ë³´ì´ê³ , í¬íŠ¸í´ë¦¬ì˜¤ë„ ì•ˆ ë³´ì´ê³ , ì „ë¶€ ì£½ìŒ.

**"ë¸”ë¡œê·¸ë§Œ ê³ ì¥ë‚¬ëŠ”ë° ì™œ ì „ì²´ê°€?"**

ì´ê²Œ MFAì—ì„œ ì—ëŸ¬ ê²©ë¦¬ê°€ ì¤‘ìš”í•œ ì´ìœ ì„.

## 1. ë¬¸ì œ ì´í•´

### Reactì˜ ì—ëŸ¬ ì „íŒŒ

Reactì—ì„œ ì—ëŸ¬ê°€ ë°œìƒí•˜ë©´:
1. í•´ë‹¹ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì—ëŸ¬ ë°œìƒ
2. **ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ë¡œ ì „íŒŒ**
3. ìµœìƒìœ„ê¹Œì§€ ì „íŒŒ
4. **ì „ì²´ ì•± í¬ë˜ì‹œ**

```
App (í¬ë˜ì‹œ!)
 â””â”€â”€ Layout (í¬ë˜ì‹œ!)
      â””â”€â”€ Routes (í¬ë˜ì‹œ!)
           â””â”€â”€ BlogApp (ì—ëŸ¬ ë°œìƒ!)
```

### MFAì—ì„œì˜ ë¬¸ì œ

```
Host (ì „ì²´ ì£½ìŒ)
 â””â”€â”€ Remote1 (ì—°ì‡„ ì£½ìŒ)
 â””â”€â”€ Remote2 (ì›í‰)  â† ì—¬ê¸°ì„œ ì—ëŸ¬
 â””â”€â”€ Remote3 (ì—°ì‡„ ì£½ìŒ)
```

**í•˜ë‚˜ì˜ Remote ì—ëŸ¬ê°€ ì „ì²´ ì‹œìŠ¤í…œì„ ì£½ì„.**

ì´ê±´ MFAì˜ "ë…ë¦½ì„±" ì›ì¹™ì— ì™„ì „íˆ ë°˜í•˜ëŠ” ê²ƒì„.

### ê³ ì°°: ê²©ë¦¬ì˜ í•„ìš”ì„±

ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ì—ì„œëŠ” ë‹¹ì—°í•œ ê²ƒì„.

- ê²°ì œ ì„œë¹„ìŠ¤ê°€ ì£½ì–´ë„ ìƒí’ˆ ëª©ë¡ì€ ë³´ì„
- ì¶”ì²œ ì„œë¹„ìŠ¤ê°€ ì£½ì–´ë„ ê²€ìƒ‰ì€ ë¨

**MFAì—ì„œë„ ê°™ì€ ì›ì¹™ì´ ì ìš©ë˜ì–´ì•¼ í•¨.**

- ë¸”ë¡œê·¸ê°€ ì£½ì–´ë„ ì´ë ¥ì„œëŠ” ë³´ì„
- í¬íŠ¸í´ë¦¬ì˜¤ê°€ ì£½ì–´ë„ ë¸”ë¡œê·¸ëŠ” ì‘ë™

## 2. Error Boundary ê¸°ì´ˆ

### Error Boundaryë€

React 16+ì—ì„œ ì œê³µí•˜ëŠ” ì—ëŸ¬ ì²˜ë¦¬ ë©”ì»¤ë‹ˆì¦˜.

**í´ë˜ìŠ¤ ì»´í¬ë„ŒíŠ¸ë¡œë§Œ êµ¬í˜„ ê°€ëŠ¥** (í˜„ì¬ê¹Œì§€ëŠ”)

```tsx
class ErrorBoundary extends React.Component<
  { children: ReactNode; fallback: ReactNode },
  { hasError: boolean }
> {
  constructor(props: any) {
    super(props);
    this.state = { hasError: false };
  }

  static getDerivedStateFromError(error: Error) {
    return { hasError: true };
  }

  componentDidCatch(error: Error, errorInfo: ErrorInfo) {
    console.error(''Error caught:'', error, errorInfo);
  }

  render() {
    if (this.state.hasError) {
      return this.props.fallback;
    }
    return this.props.children;
  }
}
```

### ê¸°ë³¸ ì‚¬ìš©

```tsx
<ErrorBoundary fallback={<div>ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤</div>}>
  <BlogApp />
</ErrorBoundary>
```

ì´ì œ BlogAppì—ì„œ ì—ëŸ¬ê°€ ë°œìƒí•´ë„ fallbackë§Œ í‘œì‹œë˜ê³ , ë‹¤ë¥¸ ë¶€ë¶„ì€ ì •ìƒ.

## 3. MFAìš© Error Boundary êµ¬í˜„

### ë” ë‚˜ì€ ì—ëŸ¬ UI

```tsx
// src/components/RemoteError.tsx
interface RemoteErrorProps {
  name: string;
  onRetry?: () => void;
}

export const RemoteError = ({ name, onRetry }: RemoteErrorProps) => {
  return (
    <div className="remote-error">
      <div className="error-icon">âš ï¸</div>
      <h2>{name}ì„(ë¥¼) ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŒ</h2>
      <p>
        ì¼ì‹œì ì¸ ë¬¸ì œê°€ ë°œìƒí–ˆìŒ.
        <br />
        ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.
      </p>
      {onRetry && (
        <button onClick={onRetry} className="retry-button">
          ë‹¤ì‹œ ì‹œë„
        </button>
      )}
    </div>
  );
};
```

### ì¬ì‹œë„ ê¸°ëŠ¥ ì¶”ê°€

```tsx
class ErrorBoundaryWithRetry extends React.Component<
  { children: ReactNode; name: string },
  { hasError: boolean; key: number }
> {
  constructor(props: any) {
    super(props);
    this.state = { hasError: false, key: 0 };
  }

  static getDerivedStateFromError() {
    return { hasError: true };
  }

  handleRetry = () => {
    this.setState((prev) => ({
      hasError: false,
      key: prev.key + 1,  // key ë³€ê²½ìœ¼ë¡œ ë¦¬ë§ˆìš´íŠ¸ ìœ ë„
    }));
  };

  render() {
    if (this.state.hasError) {
      return (
        <RemoteError
          name={this.props.name}
          onRetry={this.handleRetry}
        />
      );
    }

    return (
      <div key={this.state.key}>
        {this.props.children}
      </div>
    );
  }
}
```

### ê³ ì°°: ì¬ì‹œë„ì˜ ì˜ë¯¸

ì¼ì‹œì ì¸ ë„¤íŠ¸ì›Œí¬ ë¬¸ì œë¡œ Remote ë¡œë”©ì´ ì‹¤íŒ¨í•  ìˆ˜ ìˆìŒ.

ì¬ì‹œë„í•˜ë©´ í•´ê²°ë˜ëŠ” ê²½ìš°ê°€ ë§ìŒ.

**ìœ ì €ì—ê²Œ í•´ê²°ì±…ì„ ì œê³µí•˜ëŠ” ê²Œ ì¤‘ìš”í•¨.**

## 4. ì—ëŸ¬ ìˆ˜ì¤€ë³„ ì²˜ë¦¬

### ê³„ì¸µë³„ Error Boundary

```tsx
// ìµœìƒìœ„: ì•± ì „ì²´ ë³´í˜¸
<ErrorBoundary fallback={<AppCrashPage />}>
  <App />
</ErrorBoundary>

// ë ˆì´ì•„ì›ƒ ë ˆë²¨: ë©”ì¸ ì½˜í…ì¸  ë³´í˜¸
<ErrorBoundary fallback={<ContentError />}>
  <MainContent />
</ErrorBoundary>

// Remote ë ˆë²¨: ê° Remote ê²©ë¦¬
<ErrorBoundary fallback={<RemoteError name="ë¸”ë¡œê·¸" />}>
  <BlogApp />
</ErrorBoundary>
```

### ì‹¤ì œ êµ¬ì¡°

```tsx
const App = () => (
  <ErrorBoundary fallback={<AppCrashPage />}>
    <Router>
      <Layout>
        <ErrorBoundary fallback={<ContentError />}>
          <Routes>
            <Route
              path="/blog/*"
              element={
                <Suspense fallback={<BlogSkeleton />}>
                  <ErrorBoundary fallback={<RemoteError name="ë¸”ë¡œê·¸" />}>
                    <BlogApp />
                  </ErrorBoundary>
                </Suspense>
              }
            />
            {/* ë‹¤ë¥¸ Remoteë“¤ë„ ê°ê° ErrorBoundary */}
          </Routes>
        </ErrorBoundary>
      </Layout>
    </Router>
  </ErrorBoundary>
);
```

## 5. ì—ëŸ¬ ìœ í˜•ë³„ ì²˜ë¦¬

### ë¡œë”© ì—ëŸ¬ vs ëŸ°íƒ€ì„ ì—ëŸ¬

**ë¡œë”© ì—ëŸ¬:**
- Remoteì˜ remoteEntry.jsë¥¼ ëª» ê°€ì ¸ì˜´
- ë„¤íŠ¸ì›Œí¬ ë¬¸ì œ, ì„œë²„ ë‹¤ìš´ ë“±

**ëŸ°íƒ€ì„ ì—ëŸ¬:**
- Remote ì½”ë“œ ë‚´ë¶€ ë²„ê·¸
- API ì‘ë‹µ ì²˜ë¦¬ ì‹¤íŒ¨ ë“±

### ë¡œë”© ì—ëŸ¬ ê°ì§€

```tsx
const loadRemote = async (remoteName: string) => {
  try {
    const module = await import(remoteName);
    return module.default;
  } catch (error) {
    if (error instanceof Error) {
      if (error.message.includes(''Loading chunk'')) {
        throw new RemoteLoadError(remoteName, ''CHUNK_LOAD_FAILED'');
      }
      if (error.message.includes(''Failed to fetch'')) {
        throw new RemoteLoadError(remoteName, ''NETWORK_ERROR'');
      }
    }
    throw error;
  }
};
```

### ì—ëŸ¬ ìœ í˜•ë³„ UI

```tsx
const RemoteErrorFallback = ({ error, name }: Props) => {
  if (error instanceof RemoteLoadError) {
    if (error.type === ''NETWORK_ERROR'') {
      return (
        <div className="error-network">
          <h2>ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì„ í™•ì¸í•´ì£¼ì„¸ìš”</h2>
          <p>{name} ì„œë²„ì— ì—°ê²°í•  ìˆ˜ ì—†ìŒ</p>
        </div>
      );
    }

    if (error.type === ''CHUNK_LOAD_FAILED'') {
      return (
        <div className="error-version">
          <h2>ìƒˆ ë²„ì „ì´ ë°°í¬ë˜ì—ˆìŒ</h2>
          <p>í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨ í•´ì£¼ì„¸ìš”</p>
          <button onClick={() => window.location.reload()}>
            ìƒˆë¡œê³ ì¹¨
          </button>
        </div>
      );
    }
  }

  return (
    <div className="error-generic">
      <h2>ë¬¸ì œê°€ ë°œìƒí–ˆìŒ</h2>
      <p>ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”</p>
    </div>
  );
};
```

## 6. ì—ëŸ¬ ë¡œê¹…

### ì¤‘ì•™ ì§‘ì¤‘ì‹ ì—ëŸ¬ ìˆ˜ì§‘

```tsx
class ErrorBoundary extends React.Component {
  componentDidCatch(error: Error, errorInfo: ErrorInfo) {
    // ì—ëŸ¬ ë¡œê¹… ì„œë¹„ìŠ¤ë¡œ ì „ì†¡
    logErrorToService({
      error: {
        message: error.message,
        stack: error.stack,
      },
      componentStack: errorInfo.componentStack,
      timestamp: new Date().toISOString(),
      url: window.location.href,
      userAgent: navigator.userAgent,
    });
  }
}
```

### í”„ë¡œë•ì…˜ ì—ëŸ¬ ì¶”ì 

```typescript
// src/utils/errorLogger.ts
export const logErrorToService = async (errorData: ErrorData) => {
  if (process.env.NODE_ENV !== ''production'') {
    console.error(''Error logged:'', errorData);
    return;
  }

  try {
    await fetch(''/api/errors'', {
      method: ''POST'',
      body: JSON.stringify(errorData),
    });
  } catch {
    // ë¡œê¹… ì‹¤íŒ¨ëŠ” ë¬´ì‹œ
    console.error(''Failed to log error'');
  }
};
```

### ê³ ì°°: ì—ëŸ¬ ëª¨ë‹ˆí„°ë§ì˜ ì¤‘ìš”ì„±

í”„ë¡œë•ì…˜ì—ì„œ ì—ëŸ¬ê°€ ë°œìƒí•˜ë©´ ì•Œì•„ì•¼ í•¨.

ìœ ì €ê°€ ì‹ ê³ í•˜ê¸° ì „ì— ìš°ë¦¬ê°€ ë¨¼ì € ì•Œë©´ ë” ì¢‹ìŒ.

**Sentry, LogRocket ê°™ì€ ì„œë¹„ìŠ¤ ì¶”ì²œ.**

## 7. ë„¤íŠ¸ì›Œí¬ ì—ëŸ¬ ì²˜ë¦¬

### Remote ê°€ìš©ì„± ì²´í¬

```typescript
const checkRemoteAvailability = async (remoteUrl: string): Promise<boolean> => {
  try {
    const response = await fetch(remoteUrl, {
      method: ''HEAD'',
      mode: ''no-cors'',
    });
    return true;
  } catch {
    return false;
  }
};
```

### ì¡°ê±´ë¶€ ë Œë”ë§

```tsx
const RemoteWrapper = ({ url, children, fallback }: Props) => {
  const [isAvailable, setIsAvailable] = useState<boolean | null>(null);

  useEffect(() => {
    checkRemoteAvailability(url).then(setIsAvailable);
  }, [url]);

  if (isAvailable === null) {
    return <Loading />;
  }

  if (!isAvailable) {
    return fallback;
  }

  return children;
};
```

## 8. ë³µêµ¬ ì „ëµ

### ìë™ ì¬ì‹œë„

```tsx
const useRemoteWithRetry = (
  loadRemote: () => Promise<any>,
  maxRetries = 3
) => {
  const [component, setComponent] = useState<ComponentType | null>(null);
  const [error, setError] = useState<Error | null>(null);
  const [retryCount, setRetryCount] = useState(0);

  useEffect(() => {
    const load = async () => {
      try {
        const mod = await loadRemote();
        setComponent(() => mod);
      } catch (err) {
        if (retryCount < maxRetries) {
          setTimeout(() => {
            setRetryCount((c) => c + 1);
          }, 1000 * Math.pow(2, retryCount));  // ì§€ìˆ˜ ë°±ì˜¤í”„
        } else {
          setError(err as Error);
        }
      }
    };

    load();
  }, [retryCount]);

  return { component, error, retryCount };
};
```

### ì§€ìˆ˜ ë°±ì˜¤í”„

```
1ì°¨ ì‹œë„ ì‹¤íŒ¨ â†’ 1ì´ˆ í›„ ì¬ì‹œë„
2ì°¨ ì‹œë„ ì‹¤íŒ¨ â†’ 2ì´ˆ í›„ ì¬ì‹œë„
3ì°¨ ì‹œë„ ì‹¤íŒ¨ â†’ 4ì´ˆ í›„ ì¬ì‹œë„
3ì°¨ê¹Œì§€ ì‹¤íŒ¨ â†’ ì—ëŸ¬ í‘œì‹œ
```

**ì™œ ì§€ìˆ˜ ë°±ì˜¤í”„?**

ì¼ì‹œì ì¸ ë¬¸ì œëŠ” ì‹œê°„ì´ ì§€ë‚˜ë©´ í•´ê²°ë  ìˆ˜ ìˆìŒ.
ë„ˆë¬´ ë¹ ë¥´ê²Œ ì¬ì‹œë„í•˜ë©´ ì„œë²„ì— ë¶€í•˜ë§Œ ì¤Œ.

## 9. ì‚½ì§ˆ ê¸°ë¡

### ì‚½ì§ˆ 1: Error Boundaryê°€ ì•ˆ ì¡ëŠ” ì—ëŸ¬

**ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì—ëŸ¬:**
```tsx
<button onClick={() => {
  throw new Error(''í´ë¦­ ì—ëŸ¬'');  // Error Boundaryê°€ ëª» ì¡ìŒ!
}}>
```

**í•´ê²°:**
```tsx
<button onClick={() => {
  try {
    // ìœ„í—˜í•œ ì½”ë“œ
  } catch (error) {
    // ì§ì ‘ ì²˜ë¦¬
  }
}}>
```

**ë¹„ë™ê¸° ì—ëŸ¬:**
```tsx
useEffect(() => {
  fetchData().catch((error) => {
    // Error Boundaryê°€ ëª» ì¡ìŒ!
  });
}, []);
```

**í•´ê²°:** ìƒíƒœë¡œ ì—ëŸ¬ ê´€ë¦¬
```tsx
const [error, setError] = useState<Error | null>(null);

useEffect(() => {
  fetchData().catch(setError);
}, []);

if (error) throw error;  // ì´ì œ Error Boundaryê°€ ì¡ìŒ
```

### ì‚½ì§ˆ 2: ê°œë°œ ì¤‘ ì—ëŸ¬ ì˜¤ë²„ë ˆì´

React ê°œë°œ ëª¨ë“œì—ì„œëŠ” ì—ëŸ¬ ì˜¤ë²„ë ˆì´ê°€ ëœ¸.

Error Boundaryê°€ ì˜ ë™ì‘í•˜ëŠ”ì§€ í™•ì¸í•˜ë ¤ë©´:
- ESC ëˆŒëŸ¬ì„œ ì˜¤ë²„ë ˆì´ ë‹«ê¸°
- ë˜ëŠ” production ë¹Œë“œë¡œ í…ŒìŠ¤íŠ¸

### ì‚½ì§ˆ 3: ë¬´í•œ ì—ëŸ¬ ë£¨í”„

```tsx
// âŒ ì—ëŸ¬ â†’ ë¦¬ë Œë” â†’ ì—ëŸ¬ â†’ ë¦¬ë Œë” â†’ ...
useEffect(() => {
  if (someCondition) {
    throw new Error(''ë¬¸ì œ!'');
  }
}, [someCondition]);
```

**í•´ê²°:** ì—ëŸ¬ ìƒíƒœë¡œ ê´€ë¦¬

## 10. ìµœì¢… ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ErrorBoundary (ì•± ì „ì²´)                     â”‚
â”‚   fallback: ì™„ì „ í¬ë˜ì‹œ í˜ì´ì§€                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    Layout                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              ErrorBoundary (ì½˜í…ì¸ )                      â”‚
â”‚   fallback: ì½˜í…ì¸  ì—ëŸ¬ í˜ì´ì§€                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚ Suspense    â”‚  â”‚ Suspense    â”‚  â”‚ Suspense    â”‚    â”‚
â”‚   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚
â”‚   â”‚ â”‚ ErrorB  â”‚ â”‚  â”‚ â”‚ ErrorB  â”‚ â”‚  â”‚ â”‚ ErrorB  â”‚ â”‚    â”‚
â”‚   â”‚ â”‚ Remote1 â”‚ â”‚  â”‚ â”‚ Remote2 â”‚ â”‚  â”‚ â”‚ Remote3 â”‚ â”‚    â”‚
â”‚   â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 11. ë°°ìš´ ê²ƒë“¤

### ê¸°ìˆ ì  êµí›ˆ

1. **Error Boundary = ì—ëŸ¬ ê²©ë¦¬**
2. **ê³„ì¸µë³„ë¡œ Error Boundary ë°°ì¹˜**
3. **ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬, ë¹„ë™ê¸°ëŠ” ë³„ë„ ì²˜ë¦¬ í•„ìš”**
4. **ì¬ì‹œë„ ë¡œì§ì€ ì§€ìˆ˜ ë°±ì˜¤í”„ë¡œ**

### ì„¤ê³„ êµí›ˆ

1. **ê²©ë¦¬ëŠ” MFAì˜ í•µì‹¬ ê°€ì¹˜**
2. **í•˜ë‚˜ì˜ ì‹¤íŒ¨ê°€ ì „ì²´ì— ì˜í–¥ ì£¼ë©´ ì•ˆ ë¨**
3. **ìœ ì €ì—ê²Œ í•­ìƒ í”¼ë“œë°± ì œê³µ**
4. **ë³µêµ¬ ê°€ëŠ¥í•œ ì—ëŸ¬ëŠ” ë³µêµ¬ ìˆ˜ë‹¨ ì œê³µ**

### ê³ ì°°: ì‹¤íŒ¨ë¥¼ ì¸ì •í•˜ëŠ” ì„¤ê³„

ì‹œìŠ¤í…œì€ ë°˜ë“œì‹œ ì‹¤íŒ¨í•¨.

- ë„¤íŠ¸ì›Œí¬ëŠ” ëŠê¹€
- ì„œë²„ëŠ” ë‹¤ìš´ë¨
- ì½”ë“œì—ëŠ” ë²„ê·¸ê°€ ìˆìŒ

**ì‹¤íŒ¨ë¥¼ ë§‰ìœ¼ë ¤ í•˜ì§€ ë§ê³ , ì‹¤íŒ¨ë¥¼ ìš°ì•„í•˜ê²Œ ì²˜ë¦¬í•˜ëŠ” ê²Œ ì¤‘ìš”í•¨.**

ì—ëŸ¬ ì²˜ë¦¬ëŠ” ë¶€ê°€ ê¸°ëŠ¥ì´ ì•„ë‹˜. **í•µì‹¬ ê¸°ëŠ¥ì„.**

---

*Written by ì†í˜¸ì„±*',
  'MFAì—ì„œ í•˜ë‚˜ì˜ Remote ì—ëŸ¬ê°€ ì „ì²´ ì•±ì„ ì£½ì´ì§€ ì•Šê²Œ í•˜ëŠ” ë°©ë²•. Error Boundary, ì—ëŸ¬ ê²©ë¦¬, ë³µêµ¬ ì „ëµ.',
  'published',
  true,
  false,
  '9878b01c-1d9e-4b54-8323-f77735445b39',
  now(),
  now(),
  now()
);

-- í¬ìŠ¤íŠ¸ 8: ê³µí†µ ë¼ì´ë¸ŒëŸ¬ë¦¬
INSERT INTO blog_posts (
  title,
  slug,
  content,
  excerpt,
  status,
  is_featured,
  is_pinned,
  user_id,
  published_at,
  created_at,
  updated_at
) VALUES (
  'NPMì— ë‚´ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼?! - MFA ê³µí†µ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ê³„ì™€ ë°°í¬',
  'mfa-shared-library-npm-' || extract(epoch from now())::bigint,
  '# NPMì— ë‚´ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼?! - MFA ê³µí†µ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ê³„ì™€ ë°°í¬

## ì„œë¡ : ì¤‘ë³µ ì½”ë“œì˜ ê³µí¬

MFA ê°œë°œ 3ê°œì›”ì°¨.

ì„¸ ê°œì˜ Remoteì— ë˜‘ê°™ì€ ì½”ë“œê°€ ìˆì—ˆìŒ.

```tsx
// remote1/src/components/Button.tsx
export const Button = ({ ... }) => { ... };

// remote2/src/components/Button.tsx
export const Button = ({ ... }) => { ... };  // ë³µë¶™

// remote3/src/components/Button.tsx
export const Button = ({ ... }) => { ... };  // ë˜ ë³µë¶™
```

**ë²„íŠ¼ ìŠ¤íƒ€ì¼ ë°”ê¾¸ë ¤ë©´ ì„¸ ê³³ ë‹¤ ìˆ˜ì •.**

ì§€ì˜¥ì´ì—ˆìŒ.

### ê³ ì°°: DRY ì›ì¹™

"Don''t Repeat Yourself"

ëª¨ë“  ê°œë°œìê°€ ì•„ëŠ” ì›ì¹™ì¸ë°, MFAì—ì„œëŠ” ì ìš©ì´ ê¹Œë‹¤ë¡œì›€.

ê° ì•±ì´ ë…ë¦½ì ì´ë‹ˆê¹Œ, ìì—°ìŠ¤ëŸ½ê²Œ ì½”ë“œê°€ ì¤‘ë³µë¨.

**ë…ë¦½ì„±ì„ ìœ ì§€í•˜ë©´ì„œ ê³µí†µ ì½”ë“œë¥¼ ê³µìœ í•˜ëŠ” ë°©ë²•ì´ í•„ìš”í–ˆìŒ.**

## 1. ì„ íƒì§€ ë¶„ì„

### ì˜µì…˜ 1: ë³µë¶™

ì¥ì : ë‹¨ìˆœí•¨
ë‹¨ì : ìœ ì§€ë³´ìˆ˜ ì§€ì˜¥

**ê¸°ê°.**

### ì˜µì…˜ 2: Git Submodule

```
mfa/
â”œâ”€â”€ host/
â”œâ”€â”€ remote1/
â”œâ”€â”€ remote2/
â””â”€â”€ lib/  â† submodule
```

ì¥ì : ë²„ì „ ê´€ë¦¬ë¨
ë‹¨ì : Git ê´€ë¦¬ ë³µì¡, ì—…ë°ì´íŠ¸ ë²ˆê±°ë¡œì›€

**ê¸°ê°.**

### ì˜µì…˜ 3: NPM íŒ¨í‚¤ì§€

```bash
npm install @sonhoseong/mfa-lib
```

ì¥ì : ë²„ì „ ê´€ë¦¬, ì‰¬ìš´ ì—…ë°ì´íŠ¸, í‘œì¤€ ë°©ì‹
ë‹¨ì : NPM ë°°í¬ í•„ìš”, ì´ˆê¸° ì„¤ì • í•„ìš”

**ì„ íƒ!**

### ê³ ì°°: í‘œì¤€ì„ ë”°ë¥´ì

NPM íŒ¨í‚¤ì§€ê°€ í‘œì¤€ì ì¸ ë°©ë²•ì„.

ì²˜ìŒì—ëŠ” "NPMì— ë°°í¬ê¹Œì§€ í•´ì•¼ í•´?"ë¼ê³  ìƒê°í–ˆìŒ.

ê·¸ëŸ°ë° í•´ë³´ë‹ˆê¹Œ ë³„ê±° ì•„ë‹ˆì—ˆìŒ. ì˜¤íˆë ¤ ê¹”ë”í•´ì¡ŒìŒ.

**í‘œì¤€ì„ ë”°ë¥´ëŠ” ê²Œ ê²°êµ­ í¸í•¨.**

## 2. ë¼ì´ë¸ŒëŸ¬ë¦¬ êµ¬ì¡° ì„¤ê³„

### í´ë” êµ¬ì¡°

```
lib/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ Button/
â”‚   â”‚   â”‚   â”œâ”€â”€ Button.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Button.styles.ts
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â”œâ”€â”€ useAuth.ts
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”œâ”€â”€ storage.ts
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”œâ”€â”€ types/
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â””â”€â”€ index.ts
â”œâ”€â”€ dist/              â† ë¹Œë“œ ê²°ê³¼ë¬¼
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â””â”€â”€ rollup.config.js
```

### ë‚´ë³´ë‚´ê¸° êµ¬ì¡°

```typescript
// src/index.ts
export * from ''./components'';
export * from ''./hooks'';
export * from ''./utils'';
export * from ''./types'';
```

```typescript
// src/components/index.ts
export { Button } from ''./Button'';
export { LnbMenu } from ''./LnbMenu'';
export { Loading } from ''./Loading'';
```

### ì‚¬ìš© ì˜ˆì‹œ

```typescript
// Remoteì—ì„œ
import { Button, useAuth, storage } from ''@sonhoseong/mfa-lib'';
```

## 3. ë­˜ ê³µí†µí™”í•  ê²ƒì¸ê°€

### ê³µí†µí™” ê¸°ì¤€

**ê³µí†µí™” O:**
- ëª¨ë“  ì•±ì—ì„œ ì‚¬ìš©í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ (Button, Input, Loading ë“±)
- ì¸ì¦ ê´€ë ¨ ìœ í‹¸ë¦¬í‹° (storage, useAuth)
- ê³µí†µ íƒ€ì… ì •ì˜
- LNB ë©”ë‰´ êµ¬ì¡°

**ê³µí†µí™” X:**
- íŠ¹ì • ì•±ì—ì„œë§Œ ì“°ëŠ” ì»´í¬ë„ŒíŠ¸
- ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
- API í˜¸ì¶œ (ì•±ë§ˆë‹¤ ë‹¤ë¦„)

### ê³ ì°°: ê³¼ë„í•œ ê³µí†µí™”ì˜ ìœ„í—˜

ì²˜ìŒì—ëŠ” ëª¨ë“  ê±¸ ê³µí†µí™”í•˜ë ¤ê³  í–ˆìŒ.

```typescript
// âŒ ì´ëŸ° ê²ƒê¹Œì§€?
export const BlogPostCard = () => { ... };
```

ì´ê±´ ë¸”ë¡œê·¸ì—ì„œë§Œ ì“°ëŠ” ê±´ë° ì™œ ê³µí†µ ë¼ì´ë¸ŒëŸ¬ë¦¬ì—?

**ê³µí†µí™”ëŠ” "ì—¬ëŸ¬ ê³³ì—ì„œ ì •ë§ë¡œ ì“°ëŠ” ê²ƒ"ë§Œ.**

ê³¼ë„í•œ ê³µí†µí™” = ë¶ˆí•„ìš”í•œ ì˜ì¡´ì„± = ê²°í•©ë„ ì¦ê°€

## 4. Rollup ì„¤ì •

### ì™œ Rollup?

- ë¼ì´ë¸ŒëŸ¬ë¦¬ ë²ˆë“¤ë§ì— ìµœì í™”
- Tree Shaking ì§€ì›
- ESM, CJS ë™ì‹œ ì¶œë ¥

### ì„¤ì • íŒŒì¼

```javascript
// rollup.config.js
import resolve from ''@rollup/plugin-node-resolve'';
import commonjs from ''@rollup/plugin-commonjs'';
import typescript from ''@rollup/plugin-typescript'';
import peerDepsExternal from ''rollup-plugin-peer-deps-external'';

export default {
  input: ''src/index.ts'',

  output: [
    {
      file: ''dist/index.js'',
      format: ''cjs'',
      sourcemap: true,
    },
    {
      file: ''dist/index.esm.js'',
      format: ''esm'',
      sourcemap: true,
    },
  ],

  plugins: [
    peerDepsExternal(),  // peer deps ë²ˆë“¤ì—ì„œ ì œì™¸
    resolve(),
    commonjs(),
    typescript({
      tsconfig: ''./tsconfig.json'',
      declaration: true,
      declarationDir: ''dist/types'',
    }),
  ],
};
```

### peerDepsExternalì˜ ì¤‘ìš”ì„±

```json
// package.json
{
  "peerDependencies": {
    "react": "^19.0.0",
    "react-dom": "^19.0.0"
  }
}
```

**peerDependencies = "ì´ íŒ¨í‚¤ì§€ í•„ìš”í•˜ì§€ë§Œ ë‚´ê°€ í¬í•¨ ì•ˆ í•¨"**

ì™œ? Reactê°€ libì—ë„ ìˆê³ , ì‚¬ìš©í•˜ëŠ” ì•±ì—ë„ ìˆìœ¼ë©´ ì¶©ëŒ.

libëŠ” ì‚¬ìš©í•˜ëŠ” ì•±ì˜ Reactë¥¼ ì“°ê² ë‹¤ëŠ” ì˜ë¯¸.

## 5. TypeScript ì„¤ì •

### tsconfig.json

```json
{
  "compilerOptions": {
    "target": "ES2020",
    "module": "ESNext",
    "moduleResolution": "node",
    "declaration": true,
    "declarationDir": "dist/types",
    "outDir": "dist",
    "strict": true,
    "jsx": "react-jsx",
    "esModuleInterop": true,
    "skipLibCheck": true,
    "forceConsistentCasingInFileNames": true
  },
  "include": ["src/**/*"],
  "exclude": ["node_modules", "dist"]
}
```

### íƒ€ì… ë‚´ë³´ë‚´ê¸°

```typescript
// src/types/index.ts
export interface LnbMenuItem {
  id: string;
  label: string;
  path: string;
  icon?: ReactNode;
}

export interface User {
  id: string;
  email: string;
  name?: string;
}
```

## 6. package.json ì„¤ì •

```json
{
  "name": "@sonhoseong/mfa-lib",
  "version": "1.3.8",
  "main": "dist/index.js",
  "module": "dist/index.esm.js",
  "types": "dist/types/index.d.ts",
  "files": ["dist"],
  "scripts": {
    "build": "rollup -c",
    "prepublishOnly": "npm run build"
  },
  "peerDependencies": {
    "react": "^19.0.0",
    "react-dom": "^19.0.0",
    "react-router-dom": "^7.0.0"
  },
  "devDependencies": {
    "@rollup/plugin-commonjs": "^25.0.0",
    "@rollup/plugin-node-resolve": "^15.0.0",
    "@rollup/plugin-typescript": "^11.0.0",
    "rollup": "^4.0.0",
    "rollup-plugin-peer-deps-external": "^2.2.4",
    "typescript": "^5.0.0"
  }
}
```

### í•µì‹¬ í•„ë“œ

- **main**: CommonJS ì§„ì…ì 
- **module**: ESM ì§„ì…ì  (ë²ˆë“¤ëŸ¬ìš©)
- **types**: íƒ€ì… ì •ì˜ íŒŒì¼
- **files**: NPMì— í¬í•¨í•  íŒŒì¼

## 7. NPM ë°°í¬

### ì²« ë°°í¬

```bash
# NPM ë¡œê·¸ì¸
npm login

# ìŠ¤ì½”í”„ íŒ¨í‚¤ì§€ ë°°í¬ (publicìœ¼ë¡œ!)
npm publish --access public
```

**--access public** ì¤‘ìš”!

ìŠ¤ì½”í”„ íŒ¨í‚¤ì§€(@xxx/yyy)ëŠ” ê¸°ë³¸ì´ privateì„. publicìœ¼ë¡œ í•´ì•¼ ë¬´ë£Œ.

### ë²„ì „ ì—…ë°ì´íŠ¸

```bash
# íŒ¨ì¹˜ ë²„ì „ ì—… (1.3.7 â†’ 1.3.8)
npm version patch

# ë°°í¬
npm publish
```

### ë²„ì „ ê´€ë¦¬ ì „ëµ

- **patch** (1.0.1): ë²„ê·¸ ìˆ˜ì •
- **minor** (1.1.0): ìƒˆ ê¸°ëŠ¥ (í˜¸í™˜)
- **major** (2.0.0): ë¸Œë ˆì´í‚¹ ì²´ì¸ì§€

## 8. ì‚¬ìš©í•˜ëŠ” ìª½ ì„¤ì •

### ì„¤ì¹˜

```bash
npm install @sonhoseong/mfa-lib
```

### ì‚¬ìš©

```tsx
// remote2/src/App.tsx
import { Button, useAuth, storage, LnbMenuItem } from ''@sonhoseong/mfa-lib'';

const App = () => {
  const user = useAuth();

  return (
    <Button onClick={() => console.log(storage.isHostApp())}>
      í´ë¦­
    </Button>
  );
};
```

### ì—…ë°ì´íŠ¸

```bash
npm update @sonhoseong/mfa-lib
```

## 9. ì‚½ì§ˆ ê¸°ë¡

### ì‚½ì§ˆ 1: íƒ€ì… íŒŒì¼ ìœ„ì¹˜

ì²˜ìŒì— íƒ€ì…ì´ ì œëŒ€ë¡œ ì•ˆ ì¡í˜”ìŒ.

```
Cannot find module ''@sonhoseong/mfa-lib'' or its corresponding type declarations.
```

**ì›ì¸:** package.jsonì˜ `types` ê²½ë¡œê°€ ì˜ëª»ë¨

**í•´ê²°:**
```json
{
  "types": "dist/types/index.d.ts"
}
```

### ì‚½ì§ˆ 2: React ì¤‘ë³µ

libì—ì„œ Reactë¥¼ dependenciesë¡œ ë„£ì—ˆë”ë‹ˆ:

```
Invalid hook call. You might have more than one copy of React.
```

**í•´ê²°:** peerDependenciesë¡œ ì´ë™

### ì‚½ì§ˆ 3: ESM/CJS í˜¼ìš©

ì–´ë–¤ í™˜ê²½ì—ì„œëŠ” CJS, ì–´ë–¤ í™˜ê²½ì—ì„œëŠ” ESMì´ í•„ìš”í•¨.

**í•´ê²°:** ë‘˜ ë‹¤ ë¹Œë“œ
```javascript
output: [
  { file: ''dist/index.js'', format: ''cjs'' },
  { file: ''dist/index.esm.js'', format: ''esm'' },
]
```

### ì‚½ì§ˆ 4: dist í´ë” ì»¤ë°‹

ì²˜ìŒì— distë¥¼ .gitignoreì— ë„£ì—ˆìŒ.

NPM ë°°í¬í•  ë•Œ distê°€ ì—†ì–´ì„œ ë¹ˆ íŒ¨í‚¤ì§€ê°€ ë¨.

**í•´ê²°:** files í•„ë“œë¡œ í¬í•¨í•  íŒŒì¼ ëª…ì‹œ
```json
{
  "files": ["dist"]
}
```

## 10. LnbItems ë…¸ì¶œ íŒ¨í„´

### ê° Remoteì—ì„œ LNB ì •ë³´ ë…¸ì¶œ

```typescript
// remote2/src/exposes/LnbItems.ts
import { LnbMenuItem } from ''@sonhoseong/mfa-lib'';

export const pathPrefix = ''/blog'';

export const lnbItems = {
  hasPrefixList: [
    { id: ''blog-list'', label: ''ê¸€ ëª©ë¡'', path: ''/'' },
    { id: ''blog-new'', label: ''ê¸€ ì‘ì„±'', path: ''/post/new'' },
  ] as LnbMenuItem[],
};
```

### Hostì—ì„œ í†µí•©

```typescript
// hostì—ì„œ
import { lnbItems as blogLnbItems } from ''@blog/LnbItems'';
import { lnbItems as resumeLnbItems } from ''@resume/LnbItems'';

const allLnbItems = [
  ...blogLnbItems.hasPrefixList,
  ...resumeLnbItems.hasPrefixList,
];
```

### ê³ ì°°: ê³„ì•½ ê¸°ë°˜ í†µí•©

Hostì™€ Remote ì‚¬ì´ì— "ê³„ì•½"ì´ ìˆìŒ.

**ê³„ì•½: "RemoteëŠ” lnbItemsë¥¼ ì´ í˜•íƒœë¡œ ë…¸ì¶œí•œë‹¤"**

```typescript
interface RemoteLnbItems {
  hasPrefixList: LnbMenuItem[];
  hasPrefixAuthList?: LnbMenuItem[];
}
```

íƒ€ì…ìœ¼ë¡œ ê³„ì•½ì„ ëª…ì‹œí•˜ë©´ ì‹¤ìˆ˜ê°€ ì¤„ì–´ë“¦.

## 11. ìµœì¢… ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              NPM Registry                 â”‚
â”‚         @sonhoseong/mfa-lib               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“ npm install
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Host    â”‚  â”‚  Remote1  â”‚  â”‚  Remote2  â”‚
â”‚           â”‚  â”‚           â”‚  â”‚           â”‚
â”‚  import   â”‚  â”‚  import   â”‚  â”‚  import   â”‚
â”‚  {Button} â”‚  â”‚  {Button} â”‚  â”‚  {Button} â”‚
â”‚  from lib â”‚  â”‚  from lib â”‚  â”‚  from lib â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 12. ë°°ìš´ ê²ƒë“¤

### ê¸°ìˆ ì  êµí›ˆ

1. **NPM ë°°í¬ = ìƒê°ë³´ë‹¤ ì‰¬ì›€**
2. **Rollup = ë¼ì´ë¸ŒëŸ¬ë¦¬ ë²ˆë“¤ë§ ìµœì **
3. **peerDependencies = ì˜ì¡´ì„± ì¶©ëŒ ë°©ì§€**
4. **ESM + CJS ë™ì‹œ ì§€ì› í•„ìš”**

### ì„¤ê³„ êµí›ˆ

1. **ê³µí†µí™”ëŠ” í•„ìš”í•œ ê²ƒë§Œ**
2. **ê³¼ë„í•œ ê³µí†µí™” = ê³¼ë„í•œ ê²°í•©**
3. **íƒ€ì…ìœ¼ë¡œ ê³„ì•½ ëª…ì‹œ**
4. **ë²„ì „ ê´€ë¦¬ëŠ” semantic versioning**

### ê³ ì°°: ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ê³„ì˜ ì–´ë ¤ì›€

ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” "ì‚¬ìš©í•˜ëŠ” ìª½"ì„ ìƒê°í•´ì•¼ í•¨.

- APIê°€ ì§ê´€ì ì¸ê°€?
- í•„ìš”í•œ ê²ƒë§Œ ì œê³µí•˜ëŠ”ê°€?
- ì—…ë°ì´íŠ¸ê°€ ì‰¬ìš´ê°€?

**ì¢‹ì€ ë¼ì´ë¸ŒëŸ¬ë¦¬ = ì‚¬ìš©í•˜ê¸° ì‰¬ìš´ ë¼ì´ë¸ŒëŸ¬ë¦¬**

ì´ê±¸ ë§Œë“¤ê¸°ê°€ ìƒê°ë³´ë‹¤ ì–´ë ¤ì› ìŒ.

---

*Written by ì†í˜¸ì„±*',
  'MFA í”„ë¡œì íŠ¸ì—ì„œ ê³µí†µ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ NPM íŒ¨í‚¤ì§€ë¡œ ë°°í¬í•˜ëŠ” ê³¼ì •. Rollup ì„¤ì •, peerDependencies, ë²„ì „ ê´€ë¦¬ê¹Œì§€.',
  'published',
  true,
  false,
  '9878b01c-1d9e-4b54-8323-f77735445b39',
  now(),
  now(),
  now()
);

-- í¬ìŠ¤íŠ¸ 9: LNB í†µí•©
INSERT INTO blog_posts (
  title,
  slug,
  content,
  excerpt,
  status,
  is_featured,
  is_pinned,
  user_id,
  published_at,
  created_at,
  updated_at
) VALUES (
  'ë©”ë‰´ê°€ 3ê°œì¸ë° ê´€ë¦¬ í¬ì¸íŠ¸ë„ 3ê°œ? - MFA LNB í†µí•© ì‹œìŠ¤í…œ êµ¬ì¶•',
  'mfa-lnb-integration-' || extract(epoch from now())::bigint,
  '# ë©”ë‰´ê°€ 3ê°œì¸ë° ê´€ë¦¬ í¬ì¸íŠ¸ë„ 3ê°œ? - MFA LNB í†µí•© ì‹œìŠ¤í…œ êµ¬ì¶•

## ì„œë¡ : ë©”ë‰´ ê´€ë¦¬ì˜ ê³ í†µ

MFA í”„ë¡œì íŠ¸ì—ëŠ” ì„¸ ê°œì˜ Remoteê°€ ìˆìŒ.

```
- ì´ë ¥ì„œ (Remote1)
- ë¸”ë¡œê·¸ (Remote2)
- í¬íŠ¸í´ë¦¬ì˜¤ (Remote3)
```

ê° Remoteì—ëŠ” ìì²´ ë©”ë‰´(LNB, Left Navigation Bar)ê°€ ìˆìŒ.

ë¬¸ì œëŠ”... **Hostì—ì„œ ì´ ë©”ë‰´ë“¤ì„ ì–´ë–»ê²Œ ë³´ì—¬ì¤„ ê²ƒì¸ê°€?**

### ì´ˆê¸° ì ‘ê·¼: í•˜ë“œì½”ë”©

```tsx
// Host/src/components/Sidebar.tsx
const menuItems = [
  { label: ''ì´ë ¥ì„œ'', path: ''/resume'' },
  { label: ''ë¸”ë¡œê·¸'', path: ''/blog'' },
  { label: ''í¬íŠ¸í´ë¦¬ì˜¤'', path: ''/portfolio'' },
];
```

ê°„ë‹¨í•´ ë³´ì˜€ìŒ. ê·¸ëŸ°ë°...

### ë¬¸ì œ ë°œìƒ

ë¸”ë¡œê·¸ì— í•˜ìœ„ ë©”ë‰´ë¥¼ ì¶”ê°€í•˜ê³  ì‹¶ìŒ:
- ê¸€ ëª©ë¡
- ê¸€ ì‘ì„±
- ì¹´í…Œê³ ë¦¬

**Remote2ë¥¼ ìˆ˜ì •í•˜ê³ , Hostë„ ìˆ˜ì •í•´ì•¼ í•¨.**

```tsx
// Hostì—ì„œ ë˜ ìˆ˜ì •
const menuItems = [
  { label: ''ì´ë ¥ì„œ'', path: ''/resume'' },
  { label: ''ë¸”ë¡œê·¸'', path: ''/blog'', children: [
    { label: ''ê¸€ ëª©ë¡'', path: ''/blog'' },
    { label: ''ê¸€ ì‘ì„±'', path: ''/blog/post/new'' },
  ]},
];
```

**Remoteì˜ ë©”ë‰´ êµ¬ì¡°ë¥¼ Hostê°€ ì•Œì•„ì•¼ í•¨.**

ì´ê±´ MFAì˜ "ë…ë¦½ì„±" ì›ì¹™ì— ë°˜í•¨. Remoteë¥¼ ìˆ˜ì •í•  ë•Œë§ˆë‹¤ Hostë„ ìˆ˜ì •? ì˜ë¯¸ê°€ ì—†ìŒ.

## 1. í•´ê²° ë°©í–¥

### í•µì‹¬ ì•„ì´ë””ì–´

**Remoteê°€ ìì‹ ì˜ ë©”ë‰´ ì •ë³´ë¥¼ ë…¸ì¶œí•˜ê³ , Hostê°€ ìˆ˜ì§‘í•´ì„œ ë Œë”ë§**

```
Remote1 â†’ "ë‚˜ì˜ ë©”ë‰´ ì •ë³´"
Remote2 â†’ "ë‚˜ì˜ ë©”ë‰´ ì •ë³´"
Remote3 â†’ "ë‚˜ì˜ ë©”ë‰´ ì •ë³´"
              â†“
           Hostê°€ ìˆ˜ì§‘
              â†“
           LNB ë Œë”ë§
```

### ê³„ì•½ ì •ì˜ (Contract)

```typescript
// lib/src/types/lnb.ts
export interface LnbMenuItem {
  id: string;
  label: string;
  path: string;
  icon?: ReactNode;
  children?: LnbMenuItem[];
}

export interface RemoteLnbItems {
  hasPrefixList: LnbMenuItem[];      // prefix ì ìš© í•„ìš”í•œ ë©”ë‰´
  hasPrefixAuthList?: LnbMenuItem[]; // ë¡œê·¸ì¸ í•„ìš”í•œ ë©”ë‰´
}
```

**ëª¨ë“  RemoteëŠ” ì´ í˜•íƒœë¡œ ë©”ë‰´ ì •ë³´ë¥¼ ë…¸ì¶œí•¨.**

## 2. Remoteì—ì„œ ë©”ë‰´ ë…¸ì¶œ

### Module Federation exposes ì„¤ì •

```javascript
// remote2/webpack.common.js
new ModuleFederationPlugin({
  name: ''blog'',
  filename: ''remoteEntry.js'',
  exposes: {
    ''./App'': ''./src/App'',
    ''./LnbItems'': ''./src/exposes/LnbItems'',  // ì¶”ê°€!
  },
})
```

### LnbItems êµ¬í˜„

```typescript
// remote2/src/exposes/LnbItems.ts
import { LnbMenuItem } from ''@sonhoseong/mfa-lib'';

export const pathPrefix = ''/blog'';

export const lnbItems = {
  hasPrefixList: [
    {
      id: ''blog-list'',
      label: ''ê¸€ ëª©ë¡'',
      path: ''/'',
    },
    {
      id: ''blog-categories'',
      label: ''ì¹´í…Œê³ ë¦¬'',
      path: ''/categories'',
    },
  ] as LnbMenuItem[],

  hasPrefixAuthList: [
    {
      id: ''blog-new'',
      label: ''ê¸€ ì‘ì„±'',
      path: ''/post/new'',
    },
  ] as LnbMenuItem[],
};

export default lnbItems;
```

### hasPrefixList vs hasPrefixAuthList

- **hasPrefixList**: ëˆ„êµ¬ë‚˜ ë³¼ ìˆ˜ ìˆëŠ” ë©”ë‰´
- **hasPrefixAuthList**: ë¡œê·¸ì¸í•œ ì‚¬ìš©ìë§Œ ë³¼ ìˆ˜ ìˆëŠ” ë©”ë‰´

## 3. Hostì—ì„œ ë©”ë‰´ ìˆ˜ì§‘

### Host íƒ€ì… ì„ ì–¸

```typescript
// host/src/types/remote.d.ts
import { LnbMenuItem } from ''@sonhoseong/mfa-lib'';

interface RemoteLnbItems {
  hasPrefixList: LnbMenuItem[];
  hasPrefixAuthList?: LnbMenuItem[];
}

declare module ''@blog/LnbItems'' {
  export const pathPrefix: string;
  export const lnbItems: RemoteLnbItems;
  export default lnbItems;
}

declare module ''@resume/LnbItems'' {
  export const pathPrefix: string;
  export const lnbItems: RemoteLnbItems;
  export default lnbItems;
}
```

### ë™ì  import

```typescript
// host/src/utils/loadRemoteLnb.ts
interface RemoteConfig {
  name: string;
  prefix: string;
  loader: () => Promise<any>;
}

const remoteConfigs: RemoteConfig[] = [
  {
    name: ''ì´ë ¥ì„œ'',
    prefix: ''/resume'',
    loader: () => import(''@resume/LnbItems''),
  },
  {
    name: ''ë¸”ë¡œê·¸'',
    prefix: ''/blog'',
    loader: () => import(''@blog/LnbItems''),
  },
  {
    name: ''í¬íŠ¸í´ë¦¬ì˜¤'',
    prefix: ''/portfolio'',
    loader: () => import(''@portfolio/LnbItems''),
  },
];

export const loadAllLnbItems = async () => {
  const results = await Promise.allSettled(
    remoteConfigs.map(async (config) => {
      const module = await config.loader();
      return {
        name: config.name,
        prefix: config.prefix,
        items: module.lnbItems,
      };
    })
  );

  return results
    .filter((r) => r.status === ''fulfilled'')
    .map((r) => (r as PromiseFulfilledResult<any>).value);
};
```

### Promise.allSettled ì‚¬ìš© ì´ìœ 

```typescript
// Promise.allì€ í•˜ë‚˜ë¼ë„ ì‹¤íŒ¨í•˜ë©´ ì „ì²´ ì‹¤íŒ¨
await Promise.all([...]);  // ë¸”ë¡œê·¸ ì£½ìœ¼ë©´ ì „ì²´ ë©”ë‰´ ì•ˆ ë‚˜ì˜´

// Promise.allSettledëŠ” ì‹¤íŒ¨í•´ë„ ê²°ê³¼ ë°˜í™˜
await Promise.allSettled([...]);  // ë¸”ë¡œê·¸ ì£½ì–´ë„ ë‹¤ë¥¸ ë©”ë‰´ëŠ” ë‚˜ì˜´
```

**ê²©ë¦¬ ì›ì¹™!** í•˜ë‚˜ì˜ Remote ì‹¤íŒ¨ê°€ ì „ì²´ì— ì˜í–¥ ì£¼ë©´ ì•ˆ ë¨.

## 4. LNB ì»´í¬ë„ŒíŠ¸ êµ¬í˜„

### Sidebar ì»´í¬ë„ŒíŠ¸

```tsx
// host/src/components/Sidebar.tsx
const Sidebar = () => {
  const [menuGroups, setMenuGroups] = useState<MenuGroup[]>([]);
  const [isLoading, setIsLoading] = useState(true);
  const user = useAuth();

  useEffect(() => {
    loadAllLnbItems()
      .then(setMenuGroups)
      .finally(() => setIsLoading(false));
  }, []);

  if (isLoading) {
    return <SidebarSkeleton />;
  }

  return (
    <nav className="sidebar">
      {menuGroups.map((group) => (
        <MenuSection
          key={group.prefix}
          title={group.name}
          items={group.items.hasPrefixList}
          authItems={user ? group.items.hasPrefixAuthList : undefined}
          prefix={group.prefix}
        />
      ))}
    </nav>
  );
};
```

### MenuSection ì»´í¬ë„ŒíŠ¸

```tsx
const MenuSection = ({ title, items, authItems, prefix }) => {
  const location = useLocation();

  const renderItem = (item: LnbMenuItem) => {
    const fullPath = `${prefix}${item.path}`;
    const isActive = location.pathname === fullPath ||
                     location.pathname.startsWith(fullPath + ''/'');

    return (
      <Link
        key={item.id}
        to={fullPath}
        className={`menu-item ${isActive ? ''active'' : ''''}`}
      >
        {item.icon && <span className="icon">{item.icon}</span>}
        <span className="label">{item.label}</span>
      </Link>
    );
  };

  return (
    <div className="menu-section">
      <h3 className="section-title">{title}</h3>
      <div className="menu-items">
        {items.map(renderItem)}
        {authItems?.map(renderItem)}
      </div>
    </div>
  );
};
```

## 5. ë™ì  PREFIX ì²˜ë¦¬

### ë¬¸ì œ: Remote ë‹¨ë… ì‹¤í–‰ ì‹œ

```
Host í†µí•© ì‹¤í–‰: /blog/post/new
Remote ë‹¨ë… ì‹¤í–‰: /post/new
```

ê°™ì€ ë©”ë‰´ì¸ë° ê²½ë¡œê°€ ë‹¤ë¦„.

### í•´ê²°: ë™ì  PREFIX

```typescript
// remote2/src/exposes/LnbItems.ts
import { storage } from ''@sonhoseong/mfa-lib'';

const getPrefix = () => storage.isHostApp() ? '''' : ''/blog'';

export const getLnbItems = () => ({
  hasPrefixList: [
    {
      id: ''blog-list'',
      label: ''ê¸€ ëª©ë¡'',
      path: getPrefix() + ''/'',
    },
    // ...
  ],
});
```

### ê³ ì°°: ì •ì  vs ë™ì 

ì²˜ìŒì—ëŠ” ì •ì ìœ¼ë¡œ í–ˆìŒ:
```typescript
export const lnbItems = { ... };  // ëª¨ë“ˆ ë¡œë“œ ì‹œ í•œ ë²ˆ í‰ê°€
```

ë¬¸ì œ: storage.isHostApp()ì´ falseì¸ ìƒíƒœì—ì„œ í‰ê°€ë¨.

í•´ê²°: í•¨ìˆ˜ë¡œ ë§Œë“¤ì–´ì„œ í˜¸ì¶œ ì‹œì ì— í‰ê°€.

## 6. ì—ëŸ¬ ì²˜ë¦¬

### Remote ë¡œë”© ì‹¤íŒ¨ ì‹œ

```typescript
const loadAllLnbItems = async () => {
  const results = await Promise.allSettled(
    remoteConfigs.map(async (config) => {
      try {
        const module = await config.loader();
        return { ...config, items: module.lnbItems, error: null };
      } catch (error) {
        console.warn(`Failed to load LNB for ${config.name}:`, error);
        return { ...config, items: null, error };
      }
    })
  );

  // ì„±ê³µí•œ ê²ƒë§Œ í•„í„°ë§
  return results
    .map((r, i) => (r.status === ''fulfilled'' ? r.value : null))
    .filter(Boolean);
};
```

### ì‹¤íŒ¨í•œ ë©”ë‰´ í‘œì‹œ

```tsx
{menuGroups.map((group) => (
  group.error ? (
    <div className="menu-error">
      {group.name} ë©”ë‰´ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŒ
    </div>
  ) : (
    <MenuSection {...group} />
  )
))}
```

## 7. ì„±ëŠ¥ ìµœì í™”

### ë©”ë‰´ ìºì‹±

```typescript
let cachedMenuGroups: MenuGroup[] | null = null;

export const loadAllLnbItems = async (forceRefresh = false) => {
  if (cachedMenuGroups && !forceRefresh) {
    return cachedMenuGroups;
  }

  const results = await Promise.allSettled([...]);
  cachedMenuGroups = results...;

  return cachedMenuGroups;
};
```

### Preload

```tsx
// App ë§ˆìš´íŠ¸ ì‹œ ë¯¸ë¦¬ ë¡œë“œ
useEffect(() => {
  loadAllLnbItems();  // ìºì‹œì— ì €ì¥
}, []);
```

## 8. KOMCA íŒ¨í„´ ì ìš©

### ì‹¤ë¬´ì—ì„œ ë°°ìš´ íŒ¨í„´

KOMCA í”„ë¡œì íŠ¸ì—ì„œ ë¹„ìŠ·í•œ êµ¬ì¡°ë¥¼ ê²½í—˜í–ˆìŒ.

```typescript
// KOMCA íŒ¨í„´: prefix ëª…ì‹œ
export const pathPrefix = ''/admin'';

export const lnbItems = {
  hasPrefixList: [...],      // prefix ë¶™ì—¬ì•¼ í•˜ëŠ” ë©”ë‰´
  noPrefixList: [...],       // prefix ì•ˆ ë¶™ì´ëŠ” ë©”ë‰´
  hasPrefixAuthList: [...],  // ì¸ì¦ í•„ìš” ë©”ë‰´
};
```

### ë‚´ í”„ë¡œì íŠ¸ì— ì ìš©

```typescript
// ì•½ê°„ ë‹¨ìˆœí™”
export const lnbItems = {
  hasPrefixList: [...],       // ì¼ë°˜ ë©”ë‰´
  hasPrefixAuthList: [...],   // ì¸ì¦ í•„ìš” ë©”ë‰´
};
```

noPrefixListëŠ” í•„ìš” ì—†ì–´ì„œ ì œì™¸.

### ê³ ì°°: ì‹¤ë¬´ íŒ¨í„´ì˜ ê°€ì¹˜

ì‹¤ë¬´ì—ì„œ ê²€ì¦ëœ íŒ¨í„´ì€ ë¯¿ì„ ë§Œí•¨.

í˜¼ì ê³ ë¯¼í•´ì„œ ë§Œë“  ê²ƒë³´ë‹¤, **ì´ë¯¸ ë™ì‘í•˜ëŠ” ì½”ë“œ**ë¥¼ ì°¸ê³ í•˜ëŠ” ê²Œ ë‚˜ìŒ.

ë¬¼ë¡  ê·¸ëŒ€ë¡œ ë³µì‚¬í•˜ë©´ ì•ˆ ë˜ê³ , ë‚´ ìƒí™©ì— ë§ê²Œ ì¡°ì •í•´ì•¼ í•¨.

## 9. ì‚½ì§ˆ ê¸°ë¡

### ì‚½ì§ˆ 1: íƒ€ì… ì„ ì–¸ ìœ„ì¹˜

```typescript
// âŒ src/types/remote.d.tsì— ë„£ì—ˆë”ë‹ˆ ì¸ì‹ ì•ˆ ë¨
```

```typescript
// âœ… tsconfig.jsonì— í¬í•¨
{
  "include": ["src/**/*", "src/types/**/*.d.ts"]
}
```

### ì‚½ì§ˆ 2: ë©”ë‰´ ê¹œë¹¡ì„

ì²˜ìŒì— ë©”ë‰´ê°€ ë¡œë“œë  ë•Œ ê¹œë¹¡ì„ì´ ìˆì—ˆìŒ.

```tsx
// âŒ
if (!menuGroups.length) return null;
```

```tsx
// âœ… ìŠ¤ì¼ˆë ˆí†¤ í‘œì‹œ
if (isLoading) return <SidebarSkeleton />;
```

### ì‚½ì§ˆ 3: Active ìƒíƒœ íŒë‹¨

```tsx
// âŒ ì™„ì „ ì¼ì¹˜ë§Œ ì²´í¬
const isActive = location.pathname === fullPath;
// /blog/post/123 ì—ì„œ /blog ë©”ë‰´ê°€ active ì•ˆ ë¨
```

```tsx
// âœ… ì‹œì‘ ë¶€ë¶„ë„ ì²´í¬
const isActive = location.pathname === fullPath ||
                 location.pathname.startsWith(fullPath + ''/'');
```

## 10. ìµœì¢… ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Host                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚               Sidebar                        â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚  â”‚     loadAllLnbItems()                â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â”‚Resume  â”‚ Blog   â”‚Portfo  â”‚        â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â”‚LnbItemsâ”‚LnbItemsâ”‚LnbItemsâ”‚        â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚   â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†‘              â†‘              â†‘
    import()       import()       import()
         â†‘              â†‘              â†‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Remote1   â”‚  â”‚   Remote2   â”‚  â”‚   Remote3   â”‚
â”‚ exposes:    â”‚  â”‚ exposes:    â”‚  â”‚ exposes:    â”‚
â”‚ ./LnbItems  â”‚  â”‚ ./LnbItems  â”‚  â”‚ ./LnbItems  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 11. ë°°ìš´ ê²ƒë“¤

### ê¸°ìˆ ì  êµí›ˆ

1. **Module Federation exposesë¡œ ë°ì´í„°ë„ ë…¸ì¶œ ê°€ëŠ¥**
2. **Promise.allSettledë¡œ ë¶€ë¶„ ì‹¤íŒ¨ ì²˜ë¦¬**
3. **íƒ€ì… ì„ ì–¸ìœ¼ë¡œ ê³„ì•½ ëª…ì‹œ**
4. **ë™ì  í•¨ìˆ˜ë¡œ íƒ€ì´ë° ì´ìŠˆ í•´ê²°**

### ì„¤ê³„ êµí›ˆ

1. **RemoteëŠ” ìì‹ ì˜ ì •ë³´ë§Œ ê´€ë¦¬**
2. **HostëŠ” ìˆ˜ì§‘í•˜ê³  ë Œë”ë§ë§Œ**
3. **ê³„ì•½ ê¸°ë°˜ í†µí•© = ëŠìŠ¨í•œ ê²°í•©**
4. **í•˜ë‚˜ì˜ ì‹¤íŒ¨ê°€ ì „ì²´ì— ì˜í–¥ ì£¼ë©´ ì•ˆ ë¨**

### ê³ ì°°: ë¶„ì—…ì˜ ì›ì¹™

**ê°ì ìê¸° ì¼ë§Œ ì˜ í•˜ë©´ ë¨.**

- Remote: ë‚´ ë©”ë‰´ ì •ë³´ ì œê³µ
- Host: ë©”ë‰´ ìˆ˜ì§‘í•´ì„œ ë³´ì—¬ì£¼ê¸°

ì„œë¡œ ë‚´ë¶€ êµ¬í˜„ì„ ëª°ë¼ë„ ë¨. ê³„ì•½ë§Œ ì§€í‚¤ë©´ ë¨.

**ì´ê²Œ ì¢‹ì€ ì•„í‚¤í…ì²˜ì˜ í•µì‹¬ì„.**

---

*Written by ì†í˜¸ì„±*',
  'MFAì—ì„œ ì—¬ëŸ¬ Remoteì˜ ë©”ë‰´ë¥¼ Hostì—ì„œ í†µí•©í•˜ì—¬ í‘œì‹œí•˜ëŠ” ë°©ë²•. Module Federation exposes, ë™ì  ë¡œë”©, ì—ëŸ¬ ê²©ë¦¬.',
  'published',
  true,
  false,
  '9878b01c-1d9e-4b54-8323-f77735445b39',
  now(),
  now(),
  now()
);

-- í¬ìŠ¤íŠ¸ 10: ë°°í¬
INSERT INTO blog_posts (
  title,
  slug,
  content,
  excerpt,
  status,
  is_featured,
  is_pinned,
  user_id,
  published_at,
  created_at,
  updated_at
) VALUES (
  'ë°°í¬í•˜ë©´ ì™œ ì•ˆ ë¼? - MFA Vercel ë°°í¬ ì‚½ì§ˆê¸°',
  'mfa-vercel-deployment-' || extract(epoch from now())::bigint,
  '# ë°°í¬í•˜ë©´ ì™œ ì•ˆ ë¼? - MFA Vercel ë°°í¬ ì‚½ì§ˆê¸°

## ì„œë¡ : ë¡œì»¬ì—ì„  ëëŠ”ë°...

ê°œë°œìê°€ ê°€ì¥ ì‹«ì–´í•˜ëŠ” ë§:

**"ë¡œì»¬ì—ì„  ë˜ëŠ”ë°ìš”?"**

MFA ë°°í¬í•  ë•Œ ì´ ë§ì„ ì§„ì§œ ë§ì´ í–ˆìŒ.

ë¡œì»¬: Host, Remote1, Remote2, Remote3 ëª¨ë‘ ì˜ ë™ì‘
ë°°í¬ í›„: í°í™”ë©´, CORS ì—ëŸ¬, 404... ì§€ì˜¥ì´ì—ˆìŒ.

## 1. ë°°í¬ ì „ëµ ê²°ì •

### ì˜µì…˜ 1: ëª¨ë…¸ë ˆí¬ ë‹¨ì¼ ë°°í¬

```
mfa/
â”œâ”€â”€ host/
â”œâ”€â”€ remote1/
â”œâ”€â”€ remote2/
â””â”€â”€ remote3/
```

ëª¨ë‘ í•œ ë²ˆì— ë¹Œë“œí•˜ê³  ë°°í¬.

**ë¬¸ì œ:**
- í•˜ë‚˜ ìˆ˜ì •í•´ë„ ì „ì²´ ë°°í¬
- MFAì˜ ì˜ë¯¸ê°€ ì—†ìŒ

**ê¸°ê°.**

### ì˜µì…˜ 2: ê°ê° ë…ë¦½ ë°°í¬

```
host.vercel.app      â†’ Host
resume.vercel.app    â†’ Remote1
blog.vercel.app      â†’ Remote2
portfolio.vercel.app â†’ Remote3
```

**ì¥ì :**
- ë…ë¦½ ë°°í¬ ê°€ëŠ¥
- í•˜ë‚˜ë§Œ ìˆ˜ì •í•˜ë©´ í•˜ë‚˜ë§Œ ë°°í¬

**ì±„íƒ!**

### ê³ ì°°: ë°°í¬ ë‹¨ìœ„ = ë…ë¦½ ë‹¨ìœ„

MFAì˜ í•µì‹¬ì€ "ë…ë¦½ì„±"ì„.

ì½”ë“œë§Œ ë…ë¦½í•˜ë©´ ë­ í•˜ë‚˜. ë°°í¬ë„ ë…ë¦½í•´ì•¼ ì§„ì§œ MFA.

## 2. Vercel í”„ë¡œì íŠ¸ ì„¤ì •

### ê° ì•±ë³„ Vercel í”„ë¡œì íŠ¸ ìƒì„±

```
í”„ë¡œì íŠ¸ 1: mfa-host
  - Root Directory: host
  - Build Command: npm run build
  - Output Directory: dist

í”„ë¡œì íŠ¸ 2: mfa-resume
  - Root Directory: remote1
  - Build Command: npm run build
  - Output Directory: dist

í”„ë¡œì íŠ¸ 3: mfa-blog
  - Root Directory: remote2
  - Build Command: npm run build
  - Output Directory: dist
```

### vercel.json ì„¤ì •

```json
// host/vercel.json
{
  "rewrites": [
    { "source": "/(.*)", "destination": "/" }
  ],
  "headers": [
    {
      "source": "/(.*)",
      "headers": [
        { "key": "Access-Control-Allow-Origin", "value": "*" }
      ]
    }
  ]
}
```

### rewrites vs redirects

**rewrites**: URL ìœ ì§€, ë‚´ë¶€ì ìœ¼ë¡œ ë‹¤ë¥¸ ê³³ìœ¼ë¡œ ë¼ìš°íŒ…
**redirects**: URL ë³€ê²½, ë¸Œë¼ìš°ì €ê°€ ìƒˆ URLë¡œ ì´ë™

SPAì—ì„œëŠ” **rewrites** ì‚¬ìš©. ëª¨ë“  ê²½ë¡œê°€ index.htmlë¡œ ê°€ì•¼ í•¨.

## 3. í™˜ê²½ë³€ìˆ˜ ì„¤ì •

### ë¬¸ì œ: Remote URLì´ ë‹¬ë¼ì§

```javascript
// ë¡œì»¬
remotes: {
  blog: ''blog@http://localhost:3002/remoteEntry.js''
}

// í”„ë¡œë•ì…˜
remotes: {
  blog: ''blog@https://mfa-blog.vercel.app/remoteEntry.js''
}
```

### í•´ê²°: í™˜ê²½ë³€ìˆ˜

```javascript
// host/webpack.prod.js
const REMOTE_URLS = {
  resume: process.env.REMOTE_RESUME_URL || ''http://localhost:3001'',
  blog: process.env.REMOTE_BLOG_URL || ''http://localhost:3002'',
  portfolio: process.env.REMOTE_PORTFOLIO_URL || ''http://localhost:3003'',
};

new ModuleFederationPlugin({
  remotes: {
    resume: `resume@${REMOTE_URLS.resume}/remoteEntry.js`,
    blog: `blog@${REMOTE_URLS.blog}/remoteEntry.js`,
    portfolio: `portfolio@${REMOTE_URLS.portfolio}/remoteEntry.js`,
  },
})
```

### Vercel í™˜ê²½ë³€ìˆ˜ ì„¤ì •

```
Vercel Dashboard > Settings > Environment Variables

REMOTE_RESUME_URL=https://mfa-resume.vercel.app
REMOTE_BLOG_URL=https://mfa-blog.vercel.app
REMOTE_PORTFOLIO_URL=https://mfa-portfolio.vercel.app
```

## 4. CORS ë¬¸ì œ

### ì¦ìƒ

```
Access to script at ''https://mfa-blog.vercel.app/remoteEntry.js''
from origin ''https://mfa-host.vercel.app'' has been blocked by CORS policy
```

Hostì—ì„œ Remoteì˜ remoteEntry.jsë¥¼ ë¡œë“œí•  ë•Œ CORS ì—ëŸ¬.

### ì›ì¸

ë¸Œë¼ìš°ì € ë³´ì•ˆ ì •ì±…. ë‹¤ë¥¸ Originì—ì„œ ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ ì‹œ CORS í—¤ë” í•„ìš”.

### í•´ê²°: Remoteì— CORS í—¤ë” ì¶”ê°€

```json
// remote2/vercel.json
{
  "headers": [
    {
      "source": "/remoteEntry.js",
      "headers": [
        { "key": "Access-Control-Allow-Origin", "value": "*" },
        { "key": "Access-Control-Allow-Methods", "value": "GET" }
      ]
    },
    {
      "source": "/(.*).js",
      "headers": [
        { "key": "Access-Control-Allow-Origin", "value": "*" }
      ]
    }
  ]
}
```

### ê³ ì°°: CORSì˜ ì´í•´

CORSëŠ” "ë¸Œë¼ìš°ì €"ê°€ ë§‰ëŠ” ê²ƒì„.

curlë¡œ ìš”ì²­í•˜ë©´ ì˜ ë¨. ë¸Œë¼ìš°ì €ë§Œ ë§‰ìŒ.

**ë³´ì•ˆì„ ìœ„í•œ ê²ƒì´ì§€ë§Œ, ê°œë°œí•  ë•ŒëŠ” ì§œì¦ë‚˜ëŠ” ì¡´ì¬.**

## 5. publicPath ë¬¸ì œ

### ì¦ìƒ

remoteEntry.jsëŠ” ë¡œë“œë˜ëŠ”ë°, ì‹¤ì œ ì»´í¬ë„ŒíŠ¸ ì²­í¬ê°€ 404.

```
GET https://mfa-host.vercel.app/123.js 404
(ì‹¤ì œë¡œëŠ” https://mfa-blog.vercel.app/123.js ì—¬ì•¼ í•¨)
```

### ì›ì¸

ì²­í¬ íŒŒì¼ì˜ ê²½ë¡œê°€ Host ê¸°ì¤€ìœ¼ë¡œ ì„¤ì •ë¨.

### í•´ê²°: publicPath ì„¤ì •

```javascript
// remote2/webpack.prod.js
module.exports = merge(common, {
  output: {
    publicPath: ''https://mfa-blog.vercel.app/'',
  },
});
```

ë˜ëŠ” í™˜ê²½ë³€ìˆ˜ë¡œ:
```javascript
output: {
  publicPath: process.env.PUBLIC_URL || ''/'',
}
```

### ë” ë‚˜ì€ í•´ê²°: publicPath: ''auto''

```javascript
output: {
  publicPath: ''auto'',  // Webpackì´ ì•Œì•„ì„œ ê³„ì‚°
}
```

remoteEntry.jsê°€ ë¡œë“œëœ ìœ„ì¹˜ ê¸°ì¤€ìœ¼ë¡œ ìë™ ê³„ì‚°.

## 6. SPA ë¼ìš°íŒ… ë¬¸ì œ

### ì¦ìƒ

ìƒˆë¡œê³ ì¹¨í•˜ë©´ 404.

```
https://mfa-host.vercel.app/blog/post/hello-world
â†’ 404 Not Found
```

### ì›ì¸

Vercelì´ /blog/post/hello-world íŒŒì¼ì„ ì°¾ìœ¼ë ¤ê³  í•¨.
ê·¸ëŸ° íŒŒì¼ ì—†ìŒ. index.htmlë§Œ ìˆìŒ.

### í•´ê²°: rewrites ì„¤ì •

```json
// host/vercel.json
{
  "rewrites": [
    { "source": "/(.*)", "destination": "/" }
  ]
}
```

ëª¨ë“  ê²½ë¡œ ìš”ì²­ì„ / (index.html)ë¡œ ë³´ëƒ„.
React Routerê°€ ë‚˜ë¨¸ì§€ ì²˜ë¦¬.

## 7. ìºì‹± ë¬¸ì œ

### ì¦ìƒ

Remote ì—…ë°ì´íŠ¸í–ˆëŠ”ë° Hostì—ì„œ ì´ì „ ë²„ì „ì´ ë³´ì„.

### ì›ì¸

ë¸Œë¼ìš°ì €ê°€ remoteEntry.jsë¥¼ ìºì‹œí•¨.

### í•´ê²° 1: Cache-Control í—¤ë”

```json
{
  "headers": [
    {
      "source": "/remoteEntry.js",
      "headers": [
        { "key": "Cache-Control", "value": "no-cache, no-store, must-revalidate" }
      ]
    }
  ]
}
```

remoteEntry.jsëŠ” í•­ìƒ ìƒˆë¡œ ë°›ì•„ì˜¤ê²Œ.

### í•´ê²° 2: íŒŒì¼ëª…ì— í•´ì‹œ

```javascript
// webpack.prod.js
new ModuleFederationPlugin({
  filename: ''remoteEntry.[contenthash].js'',  // í•´ì‹œ í¬í•¨
})
```

**ë¬¸ì œ:** Hostê°€ í•´ì‹œëœ íŒŒì¼ëª…ì„ ì•Œì•„ì•¼ í•¨. ë³µì¡í•´ì§.

ì²« ë²ˆì§¸ í•´ê²°ì±…ì´ ë” ë‹¨ìˆœí•¨.

## 8. ë°°í¬ ìˆœì„œ

### ë¬¸ì œ: ì˜ì¡´ì„± ìˆëŠ” ë°°í¬

Hostê°€ Remoteë¥¼ ì°¸ì¡°í•¨.
Remote ë¨¼ì € ë°°í¬í•´ì•¼ Hostê°€ ë™ì‘.

```
1. Remote1 ë°°í¬
2. Remote2 ë°°í¬
3. Remote3 ë°°í¬
4. Host ë°°í¬ (Remote URL í™˜ê²½ë³€ìˆ˜ í•„ìš”)
```

### í•´ê²°: CI/CD íŒŒì´í”„ë¼ì¸

```yaml
# .github/workflows/deploy.yml
jobs:
  deploy-remotes:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        app: [remote1, remote2, remote3]
    steps:
      - name: Deploy ${{ matrix.app }}
        run: vercel deploy --prod

  deploy-host:
    runs-on: ubuntu-latest
    needs: deploy-remotes  # Remote ë¨¼ì €!
    steps:
      - name: Deploy host
        run: vercel deploy --prod
```

### ê³ ì°°: ë…ë¦½ ë°°í¬ì˜ í•¨ì •

"ë…ë¦½ ë°°í¬"ë¼ê³  í–ˆì§€ë§Œ, ì‚¬ì‹¤ ì™„ì „ ë…ë¦½ì€ ì•„ë‹˜.

ìƒˆ Remoteë¥¼ ì¶”ê°€í•˜ë©´ Hostë„ ì—…ë°ì´íŠ¸í•´ì•¼ í•¨.
ìƒˆ ê¸°ëŠ¥ì„ ì—°ë™í•˜ë ¤ë©´ Hostë„ ì•Œì•„ì•¼ í•¨.

**ì™„ì „í•œ ë…ë¦½ì€ ì—†ìŒ.** ê²°í•©ë„ë¥¼ ë‚®ì¶œ ë¿.

## 9. í™˜ê²½ë³„ ì„¤ì •

### ê°œë°œ vs ìŠ¤í…Œì´ì§• vs í”„ë¡œë•ì…˜

```javascript
// webpack.config.js
const getRemoteUrls = () => {
  const env = process.env.DEPLOY_ENV || ''development'';

  const urls = {
    development: {
      blog: ''http://localhost:3002'',
    },
    staging: {
      blog: ''https://mfa-blog-staging.vercel.app'',
    },
    production: {
      blog: ''https://mfa-blog.vercel.app'',
    },
  };

  return urls[env];
};
```

### Vercel Preview ë°°í¬

```
main ë¸Œëœì¹˜ â†’ í”„ë¡œë•ì…˜
ë‹¤ë¥¸ ë¸Œëœì¹˜ â†’ Preview URL (ëœë¤ URL)
```

**Previewì—ì„œì˜ ë¬¸ì œ:**
Host Preview â†’ Remote Production ì°¸ì¡°
ë²„ì „ì´ ì•ˆ ë§ì„ ìˆ˜ ìˆìŒ.

**í•´ê²°:** Preview ì „ìš© Remote ì„¸íŠ¸ êµ¬ì„± (ë³µì¡í•¨)
ë˜ëŠ” Previewì—ì„œëŠ” Remote ë¡œë”© ì‹¤íŒ¨ ê°ìˆ˜ (í˜„ì‹¤ì )

## 10. ëª¨ë‹ˆí„°ë§

### ë°°í¬ í›„ í™•ì¸ ì‚¬í•­

1. **Remote ë¡œë”© í™•ì¸**
   - DevTools > Network > remoteEntry.js 200?

2. **ì½˜ì†” ì—ëŸ¬ í™•ì¸**
   - CORS ì—ëŸ¬?
   - ëª¨ë“ˆ ë¡œë”© ì—ëŸ¬?

3. **ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸**
   - ê° Remote í˜ì´ì§€ ì ‘ê·¼ ê°€ëŠ¥?
   - ìƒˆë¡œê³ ì¹¨í•´ë„ ë™ì‘?

### ì—ëŸ¬ ì•Œë¦¼

```typescript
// ì—ëŸ¬ ë°œìƒ ì‹œ Slack ì•Œë¦¼
const notifyError = async (error: Error) => {
  await fetch(SLACK_WEBHOOK_URL, {
    method: ''POST'',
    body: JSON.stringify({
      text: `ğŸš¨ MFA Error: ${error.message}`,
    }),
  });
};
```

## 11. ì‚½ì§ˆ ê¸°ë¡

### ì‚½ì§ˆ 1: ë¹Œë“œ ëª…ë ¹ì–´

```bash
# âŒ ë©”ëª¨ë¦¬ ë¶€ì¡±
npm run build

# âœ… ë©”ëª¨ë¦¬ ëŠ˜ë ¤ì„œ
npx cross-env NODE_OPTIONS=--max_old_space_size=4096 webpack --config webpack.prod.js
```

Vercel ë¬´ë£Œ í”Œëœì€ ë©”ëª¨ë¦¬ ì œí•œ ìˆìŒ. ë¹Œë“œ ìµœì í™” í•„ìš”.

### ì‚½ì§ˆ 2: Root Directory

```
mfa/
â”œâ”€â”€ host/
â”‚   â””â”€â”€ package.json
```

Vercelì—ì„œ Root Directoryë¥¼ `host`ë¡œ ì„¤ì •í•´ì•¼ í•¨.
ì•ˆ í•˜ë©´ mfa ë£¨íŠ¸ì—ì„œ npm run build ì‹œë„ â†’ ì‹¤íŒ¨.

### ì‚½ì§ˆ 3: í™˜ê²½ë³€ìˆ˜ íƒ€ì´ë°

```
ë¹Œë“œ ì‹œ í™˜ê²½ë³€ìˆ˜ â‰  ëŸ°íƒ€ì„ í™˜ê²½ë³€ìˆ˜
```

Webpackì€ ë¹Œë“œ ì‹œ process.envë¥¼ ì¹˜í™˜í•¨.
ëŸ°íƒ€ì„ì— ë°”ê¿”ë„ ì ìš© ì•ˆ ë¨.

**í™˜ê²½ë³€ìˆ˜ ë°”ê¾¸ë©´ ì¬ë°°í¬ í•„ìš”.**

## 12. ìµœì¢… ì²´í¬ë¦¬ìŠ¤íŠ¸

```markdown
## ë°°í¬ ì „ ì²´í¬ë¦¬ìŠ¤íŠ¸

### Remote
- [ ] vercel.json CORS í—¤ë” ì„¤ì •
- [ ] publicPath: ''auto'' ë˜ëŠ” í”„ë¡œë•ì…˜ URL
- [ ] remoteEntry.js Cache-Control ì„¤ì •
- [ ] í™˜ê²½ë³€ìˆ˜ ì„¤ì • (Supabase ë“±)

### Host
- [ ] Remote URL í™˜ê²½ë³€ìˆ˜ ì„¤ì •
- [ ] vercel.json rewrites ì„¤ì •
- [ ] CORS í—¤ë” ì„¤ì •

### ê³µí†µ
- [ ] ë¹Œë“œ ì„±ê³µ í™•ì¸
- [ ] Root Directory ì„¤ì •
- [ ] í™˜ê²½ë³€ìˆ˜ Production/Preview êµ¬ë¶„
```

## 13. ë°°ìš´ ê²ƒë“¤

### ê¸°ìˆ ì  êµí›ˆ

1. **CORS í—¤ë”ëŠ” Remoteì— ì„¤ì •**
2. **publicPath: autoê°€ ê°€ì¥ í¸í•¨**
3. **SPA rewrites í•„ìˆ˜**
4. **remoteEntry.js ìºì‹œ ì£¼ì˜**

### ë°°í¬ êµí›ˆ

1. **ê° ì•± ë…ë¦½ ë°°í¬ = ì§„ì •í•œ MFA**
2. **í™˜ê²½ë³€ìˆ˜ë¡œ í™˜ê²½ êµ¬ë¶„**
3. **ë°°í¬ ìˆœì„œ ì¤‘ìš” (Remote ë¨¼ì €)**
4. **Preview í™˜ê²½ ê³ ë ¤ í•„ìš”**

### ê³ ì°°: ë°°í¬ëŠ” ê°œë°œì˜ ì—°ì¥

"ì½”ë“œë§Œ ì˜ ì§œë©´ ë¼"ë¼ê³  ìƒê°í•  ìˆ˜ ìˆìŒ.

**ì•„ë‹˜.**

ë°°í¬ê¹Œì§€ ì™„ë£Œí•´ì•¼ ì§„ì§œ ì™„ë£Œ.
ë°°í¬ í™˜ê²½ì„ ê³ ë ¤í•˜ì§€ ì•Šì€ ì½”ë“œëŠ” ë¯¸ì™„ì„±.

**ê°œë°œí•  ë•Œë¶€í„° ë°°í¬ë¥¼ ìƒê°í•´ì•¼ í•¨.**

---

*Written by ì†í˜¸ì„±*',
  'MFA í”„ë¡œì íŠ¸ë¥¼ Vercelì— ë°°í¬í•˜ë©´ì„œ ê²ªì€ ì‚½ì§ˆë“¤. CORS, publicPath, SPA ë¼ìš°íŒ…, ìºì‹± ë¬¸ì œì™€ í•´ê²°ì±….',
  'published',
  true,
  false,
  '9878b01c-1d9e-4b54-8323-f77735445b39',
  now(),
  now(),
  now()
);

-- í¬ìŠ¤íŠ¸ 11: TypeScript
INSERT INTO blog_posts (
  title,
  slug,
  content,
  excerpt,
  status,
  is_featured,
  is_pinned,
  user_id,
  published_at,
  created_at,
  updated_at
) VALUES (
  'Remote ëª¨ë“ˆ íƒ€ì…ì´ ì—†ë‹¤ê³ ? - MFA TypeScript íƒ€ì… ì‹œìŠ¤í…œ êµ¬ì¶•',
  'mfa-typescript-types-' || extract(epoch from now())::bigint,
  '# Remote ëª¨ë“ˆ íƒ€ì…ì´ ì—†ë‹¤ê³ ? - MFA TypeScript íƒ€ì… ì‹œìŠ¤í…œ êµ¬ì¶•

## ì„œë¡ : anyì˜ ìœ í˜¹

MFAë¥¼ TypeScriptë¡œ ê°œë°œí•˜ë©´ì„œ ê°€ì¥ í˜ë“¤ì—ˆë˜ ê±´ íƒ€ì…ì´ì—ˆìŒ.

```tsx
import BlogApp from ''@blog/App'';
// Error: Cannot find module ''@blog/App'' or its corresponding type declarations.
```

ì²˜ìŒì—” ì´ë ‡ê²Œ í•´ê²°í–ˆìŒ:

```tsx
// @ts-ignore
import BlogApp from ''@blog/App'';
```

**anyì˜ ìœ í˜¹ì— ë¹ ì¡ŒìŒ.** ë¹ ë¥´ê²Œ ë™ì‘í•˜ë‹ˆê¹Œ.

ê·¸ëŸ°ë° 3ê°œì›” í›„, íƒ€ì… ì—ëŸ¬ê°€ ëŸ°íƒ€ì„ì—ì„œ í„°ì§€ê¸° ì‹œì‘í•¨.

**íƒ€ì… ì•ˆì „ì„±ì„ í¬ê¸°í•œ ëŒ€ê°€ì˜€ìŒ.**

## 1. ë¬¸ì œ ì´í•´

### Module Federationê³¼ TypeScript

Module Federationì€ ëŸ°íƒ€ì„ì— ëª¨ë“ˆì„ ë¡œë“œí•¨.

```javascript
// ëŸ°íƒ€ì„ì— ì‹¤í–‰ë¨
const module = await import(''@blog/App'');
```

TypeScriptëŠ” ì»´íŒŒì¼ íƒ€ì„ì— íƒ€ì…ì„ ì²´í¬í•¨.

**ëŸ°íƒ€ì„ ëª¨ë“ˆ â†” ì»´íŒŒì¼ íƒ€ì„ íƒ€ì…**

ì´ ê°„ê·¹ì„ ë©”ì›Œì•¼ í•¨.

### Remote ëª¨ë“ˆì˜ íƒ€ì…ì´ ì—†ëŠ” ì´ìœ 

```
ì»´íŒŒì¼ ì‹œì :
- Host ë¹Œë“œ ì¤‘
- RemoteëŠ” ì•„ì§ ì•ˆ ë¶ˆëŸ¬ì˜´
- @blog/App ëª¨ë“ˆ ì—†ìŒ
- íƒ€ì… ì •ë³´ ì—†ìŒ
- Error!
```

**ì»´íŒŒì¼í•  ë•Œ Remote ì½”ë“œê°€ ì—†ìœ¼ë‹ˆê¹Œ íƒ€ì…ì„ ì•Œ ìˆ˜ ì—†ìŒ.**

## 2. í•´ê²° ë°©ë²•: íƒ€ì… ì„ ì–¸ íŒŒì¼

### ê¸°ë³¸ ì ‘ê·¼

Remote ëª¨ë“ˆì˜ íƒ€ì…ì„ **ì§ì ‘ ì„ ì–¸**í•˜ë©´ ë¨.

```typescript
// host/src/types/remote.d.ts
declare module ''@blog/App'' {
  import { ComponentType } from ''react'';
  const App: ComponentType<Record<string, never>>;
  export default App;
}
```

### d.ts íŒŒì¼ì´ë€

`.d.ts` = íƒ€ì… ì„ ì–¸ íŒŒì¼ (Declaration file)

```typescript
// êµ¬í˜„ ì—†ì´ íƒ€ì…ë§Œ ì„ ì–¸
declare module ''@blog/App'' {
  // íƒ€ì… ì •ë³´ë§Œ
}
```

TypeScript ì»´íŒŒì¼ëŸ¬ì—ê²Œ "ì´ ëª¨ë“ˆì€ ì´ëŸ° íƒ€ì…ì´ì•¼"ë¼ê³  ì•Œë ¤ì¤Œ.

### tsconfig.json ì„¤ì •

```json
{
  "compilerOptions": {
    // ...
  },
  "include": [
    "src/**/*",
    "src/types/**/*.d.ts"  // íƒ€ì… ì„ ì–¸ íŒŒì¼ í¬í•¨
  ]
}
```

## 3. Remote íƒ€ì… ì„ ì–¸

### App ì»´í¬ë„ŒíŠ¸

```typescript
// host/src/types/remote.d.ts

declare module ''@resume/App'' {
  import { ComponentType } from ''react'';
  const App: ComponentType<Record<string, never>>;
  export default App;
}

declare module ''@blog/App'' {
  import { ComponentType } from ''react'';
  const App: ComponentType<Record<string, never>>;
  export default App;
}

declare module ''@portfolio/App'' {
  import { ComponentType } from ''react'';
  const App: ComponentType<Record<string, never>>;
  export default App;
}
```

### LnbItems ëª¨ë“ˆ

```typescript
import { LnbMenuItem } from ''@sonhoseong/mfa-lib'';

interface RemoteLnbItems {
  hasPrefixList: LnbMenuItem[];
  hasPrefixAuthList?: LnbMenuItem[];
}

declare module ''@resume/LnbItems'' {
  export const pathPrefix: string;
  export const lnbItems: RemoteLnbItems;
  export default lnbItems;
}

declare module ''@blog/LnbItems'' {
  export const pathPrefix: string;
  export const lnbItems: RemoteLnbItems;
  export default lnbItems;
}
```

### Record<string, never> ì˜ë¯¸

```typescript
ComponentType<Record<string, never>>
```

**Record<string, never>** = ë¹ˆ ê°ì²´ íƒ€ì…

"ì´ ì»´í¬ë„ŒíŠ¸ëŠ” propsë¥¼ ë°›ì§€ ì•ŠìŒ"ì„ ëª…ì‹œ.

```tsx
// âœ… í—ˆìš©
<BlogApp />

// âŒ íƒ€ì… ì—ëŸ¬
<BlogApp someProp="value" />
```

## 4. ê³µí†µ íƒ€ì… ë¼ì´ë¸ŒëŸ¬ë¦¬

### libì—ì„œ íƒ€ì… ê´€ë¦¬

```typescript
// lib/src/types/index.ts

export interface LnbMenuItem {
  id: string;
  label: string;
  path: string;
  icon?: React.ReactNode;
  children?: LnbMenuItem[];
}

export interface User {
  id: string;
  email: string;
  name?: string;
  avatar_url?: string;
}

export interface ApiResponse<T> {
  success: boolean;
  data?: T;
  error?: string;
}
```

### ëª¨ë“  ì•±ì—ì„œ ì‚¬ìš©

```typescript
// Remoteì—ì„œ
import { LnbMenuItem, User } from ''@sonhoseong/mfa-lib'';

export const lnbItems: LnbMenuItem[] = [
  { id: ''1'', label: ''ëª©ë¡'', path: ''/'' },
];
```

### ê³ ì°°: íƒ€ì…ë„ ê³µìœ í•´ì•¼ í•¨

ì½”ë“œ ê³µìœ ë§Œ ìƒê°í–ˆëŠ”ë°, **íƒ€ì… ê³µìœ ë„ ì¤‘ìš”**í–ˆìŒ.

ê°™ì€ ì¸í„°í˜ì´ìŠ¤ë¥¼ ê° ì•±ì—ì„œ ì¤‘ë³µ ì •ì˜í•˜ë©´?
- ë²„ì „ ë¶ˆì¼ì¹˜ ìœ„í—˜
- ìœ ì§€ë³´ìˆ˜ ì§€ì˜¥

**íƒ€ì…ì€ libì—ì„œ ì¤‘ì•™ ê´€ë¦¬.**

## 5. ì œë„¤ë¦­ í™œìš©

### API ì‘ë‹µ íƒ€ì…

```typescript
// lib/src/types/api.ts
export interface ApiResponse<T> {
  success: boolean;
  data?: T;
  error?: string;
}

export interface PaginatedResponse<T> {
  items: T[];
  total: number;
  page: number;
  pageSize: number;
  hasMore: boolean;
}
```

### ì‚¬ìš© ì˜ˆì‹œ

```typescript
// remote2/src/network/apis/post.ts
import { ApiResponse, PaginatedResponse } from ''@sonhoseong/mfa-lib'';

interface Post {
  id: string;
  title: string;
  content: string;
}

export async function getPosts(): Promise<ApiResponse<PaginatedResponse<Post>>> {
  // ...
}
```

### íƒ€ì… ì¶”ë¡ ì˜ í˜

```typescript
const response = await getPosts();

if (response.success && response.data) {
  response.data.items.forEach((post) => {
    console.log(post.title);  // íƒ€ì… ì¶”ë¡ ë¨!
  });
}
```

## 6. ìœ í‹¸ë¦¬í‹° íƒ€ì… í™œìš©

### Partial, Required, Pick, Omit

```typescript
interface Post {
  id: string;
  title: string;
  content: string;
  status: ''draft'' | ''published'';
  createdAt: Date;
}

// ìƒì„± ì‹œ (ì¼ë¶€ í•„ë“œë§Œ)
type CreatePostInput = Pick<Post, ''title'' | ''content''>;

// ìˆ˜ì • ì‹œ (ëª¨ë“  í•„ë“œ ì„ íƒì )
type UpdatePostInput = Partial<Omit<Post, ''id'' | ''createdAt''>>;
```

### ì‹¤ì œ í™œìš©

```typescript
export async function createPost(input: CreatePostInput): Promise<ApiResponse<Post>> {
  // title, contentë§Œ í•„ìˆ˜
}

export async function updatePost(id: string, input: UpdatePostInput): Promise<ApiResponse<Post>> {
  // ëª¨ë“  í•„ë“œ ì„ íƒì 
}
```

## 7. íƒ€ì… ê°€ë“œ

### ë¬¸ì œ: ëŸ°íƒ€ì„ íƒ€ì… ì²´í¬

```typescript
const data: unknown = await fetchSomething();

// dataê°€ Post íƒ€ì…ì¸ì§€ ì–´ë–»ê²Œ í™•ì¸?
```

### íƒ€ì… ê°€ë“œ í•¨ìˆ˜

```typescript
function isPost(value: unknown): value is Post {
  return (
    typeof value === ''object'' &&
    value !== null &&
    ''id'' in value &&
    ''title'' in value &&
    ''content'' in value
  );
}

// ì‚¬ìš©
if (isPost(data)) {
  console.log(data.title);  // íƒ€ì… ì•ˆì „!
}
```

### API ì‘ë‹µ ê²€ì¦

```typescript
function isApiResponse<T>(
  value: unknown,
  isT: (v: unknown) => v is T
): value is ApiResponse<T> {
  if (typeof value !== ''object'' || value === null) return false;
  if (!(''success'' in value)) return false;

  const obj = value as { success: boolean; data?: unknown };
  if (!obj.success) return true;  // ì—ëŸ¬ ì‘ë‹µë„ ìœ íš¨

  return obj.data === undefined || isT(obj.data);
}
```

## 8. ì—„ê²©í•œ íƒ€ì… ì„¤ì •

### tsconfig.json ì¶”ì²œ ì„¤ì •

```json
{
  "compilerOptions": {
    "strict": true,                    // ì—„ê²© ëª¨ë“œ
    "noImplicitAny": true,             // ì•”ì‹œì  any ê¸ˆì§€
    "strictNullChecks": true,          // null ì²´í¬ ê°•ì œ
    "noImplicitReturns": true,         // ì•”ì‹œì  return ê¸ˆì§€
    "noFallthroughCasesInSwitch": true, // switch fallthrough ê¸ˆì§€
    "exactOptionalPropertyTypes": true  // ì •í™•í•œ optional íƒ€ì…
  }
}
```

### strictNullChecksì˜ ì¤‘ìš”ì„±

```typescript
// strictNullChecks: false
const user: User = getUser();
console.log(user.name);  // ëŸ°íƒ€ì„ì— í„°ì§ˆ ìˆ˜ ìˆìŒ

// strictNullChecks: true
const user: User | null = getUser();
if (user) {
  console.log(user.name);  // ì•ˆì „
}
```

## 9. íƒ€ì… ì„ ì–¸ì˜ í•œê³„

### ë™ê¸°í™” ë¬¸ì œ

Remoteë¥¼ ìˆ˜ì •í•˜ë©´ Hostì˜ íƒ€ì… ì„ ì–¸ë„ ìˆ˜ì •í•´ì•¼ í•¨.

```typescript
// Remoteì—ì„œ props ì¶”ê°€
const App = ({ theme }: { theme: string }) => { ... };

// Host íƒ€ì… ì„ ì–¸ ì—…ë°ì´íŠ¸ í•„ìš”!
declare module ''@blog/App'' {
  const App: ComponentType<{ theme: string }>;  // ìˆ˜ì •!
  export default App;
}
```

**ìë™ ë™ê¸°í™” ì•ˆ ë¨.** ìˆ˜ë™ìœ¼ë¡œ ë§ì¶°ì•¼ í•¨.

### í•´ê²°ì±…: ê³„ì•½ ìµœì†Œí™”

```typescript
// Props ì—†ì´ ì„¤ê³„
const App = () => { ... };

// í•„ìš”í•œ ë°ì´í„°ëŠ” ë‚´ë¶€ì—ì„œ Contextë¡œ ë°›ìŒ
```

Remote App ì»´í¬ë„ŒíŠ¸ëŠ” props ì—†ì´ ì„¤ê³„.
í•„ìš”í•œ ë°ì´í„°ëŠ” Contextë‚˜ ì „ì—­ ìƒíƒœë¡œ.

**ê³„ì•½(ì¸í„°í˜ì´ìŠ¤)ì´ ë‹¨ìˆœí• ìˆ˜ë¡ ìœ ì§€ë³´ìˆ˜ ì‰¬ì›€.**

## 10. ì‚½ì§ˆ ê¸°ë¡

### ì‚½ì§ˆ 1: d.ts íŒŒì¼ ì¸ì‹ ì•ˆ ë¨

```
Cannot find module ''@blog/App''
```

**ì›ì¸:** tsconfig.jsonì˜ includeì— d.ts ê²½ë¡œ ëˆ„ë½

**í•´ê²°:**
```json
{
  "include": ["src/**/*", "src/types/*.d.ts"]
}
```

### ì‚½ì§ˆ 2: íƒ€ì… ì¶©ëŒ

```
Duplicate identifier ''LnbMenuItem''
```

**ì›ì¸:** libì™€ localì—ì„œ ê°™ì€ ì´ë¦„ì˜ íƒ€ì… ì •ì˜

**í•´ê²°:** libì—ì„œë§Œ ì •ì˜í•˜ê³  importí•´ì„œ ì‚¬ìš©

### ì‚½ì§ˆ 3: React íƒ€ì… ì¶©ëŒ

```
TS2742: The inferred type of ''App'' cannot be named without a reference to ...
```

**ì›ì¸:** ì—¬ëŸ¬ ë²„ì „ì˜ @types/react ì¡´ì¬

**í•´ê²°:**
```json
{
  "resolutions": {
    "@types/react": "^19.0.0"
  }
}
```

## 11. ìµœì¢… íƒ€ì… êµ¬ì¡°

```
lib/
â”œâ”€â”€ src/
â”‚   â””â”€â”€ types/
â”‚       â”œâ”€â”€ index.ts       // ëª¨ë“  ê³µí†µ íƒ€ì…
â”‚       â”œâ”€â”€ lnb.ts         // LNB ê´€ë ¨ íƒ€ì…
â”‚       â”œâ”€â”€ user.ts        // ìœ ì € ê´€ë ¨ íƒ€ì…
â”‚       â””â”€â”€ api.ts         // API ê´€ë ¨ íƒ€ì…

host/
â”œâ”€â”€ src/
â”‚   â””â”€â”€ types/
â”‚       â””â”€â”€ remote.d.ts    // Remote ëª¨ë“ˆ íƒ€ì… ì„ ì–¸

remote2/
â”œâ”€â”€ src/
â”‚   â””â”€â”€ types/
â”‚       â””â”€â”€ post.ts        // ì´ ì•± ì „ìš© íƒ€ì…
```

## 12. ë°°ìš´ ê²ƒë“¤

### ê¸°ìˆ ì  êµí›ˆ

1. **d.ts íŒŒì¼ë¡œ ëŸ°íƒ€ì„ ëª¨ë“ˆ íƒ€ì… ì„ ì–¸**
2. **ê³µí†µ íƒ€ì…ì€ libì—ì„œ ì¤‘ì•™ ê´€ë¦¬**
3. **ì œë„¤ë¦­ìœ¼ë¡œ ì¬ì‚¬ìš© ê°€ëŠ¥í•œ íƒ€ì…**
4. **íƒ€ì… ê°€ë“œë¡œ ëŸ°íƒ€ì„ íƒ€ì… ì•ˆì „ì„±**

### ì„¤ê³„ êµí›ˆ

1. **íƒ€ì… ê³„ì•½ì€ ë‹¨ìˆœí•˜ê²Œ**
2. **anyëŠ” ê¸°ìˆ  ë¶€ì±„**
3. **strict ëª¨ë“œ ì‚¬ìš©**
4. **íƒ€ì… ë™ê¸°í™” ë¹„ìš© ê³ ë ¤**

### ê³ ì°°: íƒ€ì…ì€ ë¬¸ì„œë‹¤

íƒ€ì…ì„ ì˜ ì‘ì„±í•˜ë©´ ì½”ë“œê°€ ë¬¸ì„œê°€ ë¨.

```typescript
// íƒ€ì…ë§Œ ë´ë„ ì´í•´ë¨
function createPost(input: CreatePostInput): Promise<ApiResponse<Post>>
```

- ì…ë ¥: CreatePostInput
- ì¶œë ¥: Promise<ApiResponse<Post>>
- ë¹„ë™ê¸° í•¨ìˆ˜

**íƒ€ì…ì´ ê³§ ë¬¸ì„œ.** ì£¼ì„ë³´ë‹¤ ì •í™•í•˜ê³  ê°•ì œë¨.

---

*Written by ì†í˜¸ì„±*',
  'MFAì—ì„œ Remote ëª¨ë“ˆì˜ íƒ€ì…ì„ ì–´ë–»ê²Œ ê´€ë¦¬í•  ê²ƒì¸ê°€. d.ts íŒŒì¼, ê³µí†µ íƒ€ì… ë¼ì´ë¸ŒëŸ¬ë¦¬, íƒ€ì… ê°€ë“œê¹Œì§€.',
  'published',
  true,
  false,
  '9878b01c-1d9e-4b54-8323-f77735445b39',
  now(),
  now(),
  now()
);

-- í¬ìŠ¤íŠ¸ 12: ì‹¤ì „ ì´ìŠˆ ì´ì •ë¦¬
INSERT INTO blog_posts (
  title,
  slug,
  content,
  excerpt,
  status,
  is_featured,
  is_pinned,
  user_id,
  published_at,
  created_at,
  updated_at
) VALUES (
  '6ê°œì›”ê°„ì˜ ì‚½ì§ˆ ì´ì •ë¦¬ - MFA ì‹¤ì „ ì´ìŠˆì™€ í•´ê²°ì±…',
  'mfa-real-world-issues-' || extract(epoch from now())::bigint,
  '# 6ê°œì›”ê°„ì˜ ì‚½ì§ˆ ì´ì •ë¦¬ - MFA ì‹¤ì „ ì´ìŠˆì™€ í•´ê²°ì±…

## ì„œë¡ : ì´ë¡ ê³¼ í˜„ì‹¤ì˜ ê°„ê·¹

MFA ê´€ë ¨ ê¸€ë“¤ì„ ë§ì´ ì½ì—ˆìŒ.

"Module Federationìœ¼ë¡œ ë§ˆì´í¬ë¡œ í”„ë¡ íŠ¸ì—”ë“œ êµ¬ì¶•í•˜ê¸°"
"5ë¶„ ë§Œì— ì‹œì‘í•˜ëŠ” MFA"

**ì´ë¡ ì€ ê¹”ë”í–ˆìŒ. í˜„ì‹¤ì€ ë‹¬ëìŒ.**

6ê°œì›”ê°„ ì‚½ì§ˆí•˜ë©´ì„œ ë°°ìš´ "ì§„ì§œ" ì´ìŠˆë“¤ì„ ì •ë¦¬í•¨.

## 1. ë²„ì „ ê´€ë¦¬ ì§€ì˜¥

### ë¬¸ì œ

lib ë²„ì „ ì—…ë°ì´íŠ¸í–ˆìŒ. 1.3.7 â†’ 1.3.8

```bash
# Host
npm update @sonhoseong/mfa-lib  # 1.3.8

# Remote1
# ì•„ì§ 1.3.7

# Remote2
# ì•„ì§ 1.3.7
```

ê²°ê³¼: ë²„ì „ ë¶ˆì¼ì¹˜ë¡œ íƒ€ì… ì—ëŸ¬, ëŸ°íƒ€ì„ ì—ëŸ¬.

### ë” ì‹¬ê°í•œ ìƒí™©

libì—ì„œ ì¸í„°í˜ì´ìŠ¤ ë³€ê²½:

```typescript
// 1.3.7
interface LnbMenuItem {
  id: string;
  label: string;
  path: string;
}

// 1.3.8
interface LnbMenuItem {
  id: string;
  label: string;
  path: string;
  icon?: ReactNode;  // ì¶”ê°€!
}
```

HostëŠ” iconì„ ê¸°ëŒ€í•˜ëŠ”ë° RemoteëŠ” icon ì—†ì´ ë³´ëƒ„.

### í•´ê²°ì±…

**1. ë²„ì „ ê³ ì •**
```json
{
  "dependencies": {
    "@sonhoseong/mfa-lib": "1.3.8"  // ì •í™•íˆ ê³ ì •
  }
}
```

**2. ëª¨ë“  ì•± ë™ì‹œ ì—…ë°ì´íŠ¸**
lib ì—…ë°ì´íŠ¸ ì‹œ ëª¨ë“  ì•± í•¨ê»˜ ì—…ë°ì´íŠ¸.

**3. í•˜ìœ„ í˜¸í™˜ì„± ìœ ì§€**
Breaking change ìµœì†Œí™”. ì¶”ê°€ë§Œ í•˜ê³  ì‚­ì œëŠ” ì•ˆ í•¨.

### ê³ ì°°

**"ë…ë¦½ ë°°í¬"ì˜ í•¨ì •.**

ë…ë¦½ ë°°í¬ ê°€ëŠ¥í•˜ë‹¤ê³  í–ˆì§€ë§Œ, ê³µìœ  ì˜ì¡´ì„± ìˆìœ¼ë©´ ì™„ì „íˆ ë…ë¦½ì€ ì•„ë‹˜.

**ë²„ì „ ê´€ë¦¬ ì „ëµì´ í•„ìˆ˜.**

## 2. ê°œë°œ í™˜ê²½ ë³µì¡ë„

### ë¬¸ì œ

ê°œë°œí•˜ë ¤ë©´ 4ê°œ ì•±ì„ ë‹¤ ì¼œì•¼ í•¨.

```bash
# í„°ë¯¸ë„ 1
cd host && npm start

# í„°ë¯¸ë„ 2
cd remote1 && npm start

# í„°ë¯¸ë„ 3
cd remote2 && npm start

# í„°ë¯¸ë„ 4
cd remote3 && npm start
```

**ë§¤ë²ˆ ì´ê±° í•´ì•¼ í•¨?**

### í•´ê²°ì±…

**1. concurrently ì‚¬ìš©**
```json
// mfa/package.json
{
  "scripts": {
    "dev": "concurrently \"npm run dev:host\" \"npm run dev:remote1\" \"npm run dev:remote2\""
  }
}
```

**2. í•„ìš”í•œ ê²ƒë§Œ ì‹¤í–‰**
ë¸”ë¡œê·¸ë§Œ ê°œë°œí•  ë•Œ:
```bash
cd remote2 && npm start
# ë‹¨ë… ì‹¤í–‰ ëª¨ë“œë¡œ ê°œë°œ
```

**3. Docker Compose (ì„ íƒ)**
```yaml
services:
  host:
    build: ./host
    ports:
      - "3000:3000"
  remote1:
    build: ./remote1
    ports:
      - "3001:3001"
```

### ê³ ì°°

**ë³µì¡ë„ ì¦ê°€ëŠ” MFAì˜ ëŒ€ê°€.**

ëª¨ë†€ë¦¬ì‹ì´ë©´ `npm start` í•œ ë²ˆì´ë©´ ë.

**ë³µì¡ë„ë¥¼ ê°ìˆ˜í•  ê°€ì¹˜ê°€ ìˆëŠ”ì§€ íŒë‹¨í•´ì•¼ í•¨.**

## 3. Hot Reload ë¬¸ì œ

### ë¬¸ì œ

Remote ì½”ë“œ ìˆ˜ì • â†’ Hostì—ì„œ ë°˜ì˜ ì•ˆ ë¨.

Host ìƒˆë¡œê³ ì¹¨í•´ì•¼ ë³€ê²½ ë³´ì„.

### ì›ì¸

Module Federationì€ remoteEntry.jsë¥¼ ìºì‹œí•¨.

### í•´ê²°ì±…

**1. ê°œë°œ ì„œë²„ livereload ì„¤ì •**
```javascript
// webpack.dev.js
devServer: {
  hot: true,
  liveReload: true,
}
```

**2. Host ìë™ ìƒˆë¡œê³ ì¹¨ (ì„ì‹œë°©í¸)**
```javascript
// Hostì—ì„œ
if (process.env.NODE_ENV === ''development'') {
  // Remote ë³€ê²½ ê°ì§€ ì‹œ ìƒˆë¡œê³ ì¹¨
}
```

### ê³ ì°°

**ì™„ë²½í•œ HMRì€ ì–´ë ¤ì›€.** ì–´ëŠ ì •ë„ íƒ€í˜‘ í•„ìš”.

Remote ë‹¨ë… ê°œë°œ ì‹œì—ëŠ” HMR ì˜ ë¨. í†µí•© í…ŒìŠ¤íŠ¸ ë•Œë§Œ ë¶ˆí¸.

## 4. ë¹Œë“œ ì‹œê°„

### ë¬¸ì œ

í”„ë¡œì íŠ¸ ì»¤ì§€ë‹ˆê¹Œ ë¹Œë“œ ì‹œê°„ë„ ëŠ˜ì–´ë‚¨.

```
Host: 45ì´ˆ
Remote1: 30ì´ˆ
Remote2: 40ì´ˆ (TipTap ë•Œë¬¸ì— ë¬´ê±°ì›€)
Remote3: 25ì´ˆ

ì „ì²´: 2ë¶„ 20ì´ˆ
```

í•˜ë‚˜ ìˆ˜ì •í•˜ê³  2ë¶„ ê¸°ë‹¤ë¦¼?

### í•´ê²°ì±…

**1. ë³€ê²½ëœ ì•±ë§Œ ë¹Œë“œ**
```bash
# ë¸”ë¡œê·¸ë§Œ ìˆ˜ì •í–ˆìœ¼ë©´
npm run build --workspace=remote2
```

**2. ìºì‹œ í™œìš©**
```javascript
// webpack.config.js
cache: {
  type: ''filesystem'',
  buildDependencies: {
    config: [__filename],
  },
},
```

**3. ë³‘ë ¬ ë¹Œë“œ**
```bash
npm run build:all  # 4ê°œ ë™ì‹œ ë¹Œë“œ
```

### ë¹Œë“œ ì‹œê°„ ë¹„êµ

```
ìˆœì°¨ ë¹Œë“œ: 2ë¶„ 20ì´ˆ
ë³‘ë ¬ ë¹Œë“œ: 50ì´ˆ (ê°€ì¥ ëŠë¦° ì•± ê¸°ì¤€)
ìºì‹œ ìˆìœ¼ë©´: 15ì´ˆ
```

## 5. í…ŒìŠ¤íŠ¸ ì „ëµ

### ë¬¸ì œ

í…ŒìŠ¤íŠ¸ë¥¼ ì–´ë–»ê²Œ í•  ê²ƒì¸ê°€?

- ë‹¨ìœ„ í…ŒìŠ¤íŠ¸: ê° ì•±ì—ì„œ
- í†µí•© í…ŒìŠ¤íŠ¸: ???

### í•´ê²°ì±…

**1. ê° ì•±ë³„ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸**
```bash
cd remote2 && npm test
```

**2. í†µí•© í…ŒìŠ¤íŠ¸: E2E**
```javascript
// e2e/integration.spec.ts
test(''Hostì—ì„œ ë¸”ë¡œê·¸ ì ‘ê·¼'', async ({ page }) => {
  await page.goto(''http://localhost:3000'');
  await page.click(''text=ë¸”ë¡œê·¸'');
  await expect(page).toHaveURL(''/blog'');
});
```

**3. Contract í…ŒìŠ¤íŠ¸**
Remoteê°€ ì•½ì†í•œ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì§€í‚¤ëŠ”ì§€ í…ŒìŠ¤íŠ¸.

### ê³ ì°°

**í†µí•© í…ŒìŠ¤íŠ¸ê°€ ì¤‘ìš”í•´ì§.**

ëª¨ë†€ë¦¬ì‹ì´ë©´ í•˜ë‚˜ë§Œ í…ŒìŠ¤íŠ¸í•˜ë©´ ëìŒ.

MFAëŠ” ì•± ê°„ í†µí•©ì´ ì˜ ë˜ëŠ”ì§€ í™•ì¸í•´ì•¼ í•¨.

## 6. ë””ë²„ê¹…ì˜ ì–´ë ¤ì›€

### ë¬¸ì œ

ì—ëŸ¬ ë°œìƒ: "ì–´ë””ì„œ í„°ì§„ ê±°ì•¼?"

- Host? Remote1? Remote2? Remote3?
- ì½˜ì†”ì—ëŠ” ë²ˆë“¤ëœ ì½”ë“œ ìŠ¤íƒë§Œ

### í•´ê²°ì±…

**1. Source Map**
```javascript
// webpack.dev.js
devtool: ''inline-source-map'',
```

**2. ì•±ë³„ ë¡œê·¸ prefix**
```typescript
// Remote2
const log = (...args: any[]) => console.log(''[Blog]'', ...args);
```

**3. Error Boundaryì—ì„œ ì •ë³´ ìˆ˜ì§‘**
```typescript
componentDidCatch(error: Error, errorInfo: ErrorInfo) {
  console.error(''[Remote2 Error]'', {
    error,
    componentStack: errorInfo.componentStack,
    url: window.location.href,
  });
}
```

### ê³ ì°°

**ë””ë²„ê¹… í™˜ê²½ êµ¬ì¶•ì— ì‹œê°„ íˆ¬ìí•´ì•¼ í•¨.**

"ì¼ë‹¨ ëŒì•„ê°€ë‹ˆê¹Œ" ë„˜ì–´ê°€ë©´ ë‚˜ì¤‘ì— ê³ ìƒí•¨.

## 7. ì˜ì¡´ì„± ì¶©ëŒ

### ë¬¸ì œ

```
Host: react@19.2.3
Remote1: react@19.2.1
Remote2: react@19.2.3
```

ë²„ì „ ë‹¤ë¥´ë©´ hooks ì—ëŸ¬.

### í•´ê²°ì±…

**1. singleton ì„¤ì •**
```javascript
shared: {
  react: {
    singleton: true,
    requiredVersion: ''^19.2.3'',
  },
}
```

**2. ë²„ì „ í†µì¼**
```bash
# ëª¨ë“  ì•±ì—ì„œ
npm install react@19.2.3
```

**3. package.json ê´€ë¦¬ ìë™í™”**
```javascript
// ìŠ¤í¬ë¦½íŠ¸ë¡œ ë²„ì „ ì²´í¬
const versions = apps.map((app) => app.dependencies.react);
if (new Set(versions).size > 1) {
  console.error(''React ë²„ì „ ë¶ˆì¼ì¹˜!'');
}
```

## 8. ë©”ëª¨ë¦¬ ë¬¸ì œ

### ë¬¸ì œ

ë¹Œë“œ ì‹œ ë©”ëª¨ë¦¬ ë¶€ì¡±.

```
FATAL ERROR: Ineffective mark-compacts near heap limit
Allocation failed - JavaScript heap out of memory
```

### í•´ê²°ì±…

```bash
# ë©”ëª¨ë¦¬ ëŠ˜ë¦¬ê¸°
NODE_OPTIONS=--max_old_space_size=4096 npm run build
```

```json
// package.json
{
  "scripts": {
    "build": "cross-env NODE_OPTIONS=--max_old_space_size=4096 webpack"
  }
}
```

## 9. ìŠ¤íƒ€ì¼ ì¶©ëŒ

### ë¬¸ì œ

Remote1ì˜ CSSê°€ Remote2ì— ì˜í–¥.

```css
/* Remote1 */
.card { background: red; }

/* Remote2ì˜ .cardë„ ë¹¨ê°„ìƒ‰ ë¨ */
```

### í•´ê²°ì±…

**1. CSS Modules**
```tsx
import styles from ''./Card.module.css'';

<div className={styles.card} />
```

**2. BEM ë„¤ì´ë°**
```css
.blog-post-card { ... }
.resume-skill-card { ... }
```

**3. Scoped CSS (CSS-in-JS)**
```tsx
const Card = styled.div`
  background: white;
`;
```

### ê³ ì°°

**ìŠ¤íƒ€ì¼ ê²©ë¦¬ëŠ” í•„ìˆ˜.**

ê° ì•±ì´ ë…ë¦½ì ì´ë ¤ë©´ ìŠ¤íƒ€ì¼ë„ ë…ë¦½ì ì´ì–´ì•¼ í•¨.

## 10. ëª¨ë‹ˆí„°ë§

### ë¬¸ì œ

í”„ë¡œë•ì…˜ì—ì„œ ë¬¸ì œ ìƒê¸°ë©´ ì–´ë–»ê²Œ ì•Œì§€?

### í•´ê²°ì±…

**1. ì—ëŸ¬ ì¶”ì  ì„œë¹„ìŠ¤**
- Sentry
- LogRocket

**2. ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§**
```typescript
// Remote ë¡œë”© ì‹œê°„ ì¸¡ì •
const start = performance.now();
await import(''@blog/App'');
const duration = performance.now() - start;
console.log(`Blog ë¡œë”©: ${duration}ms`);
```

**3. Health Check**
```typescript
// ê° Remote ìƒíƒœ ì²´í¬
const checkRemotes = async () => {
  const results = await Promise.allSettled([
    fetch(''https://mfa-blog.vercel.app/health''),
    fetch(''https://mfa-resume.vercel.app/health''),
  ]);

  results.forEach((r, i) => {
    if (r.status === ''rejected'') {
      alert(`Remote ${i} ë‹¤ìš´!`);
    }
  });
};
```

## 11. íšŒê³ : 6ê°œì›”ì˜ êµí›ˆ

### ê¸°ìˆ ì ìœ¼ë¡œ ë°°ìš´ ê²ƒ

1. **Module Federation ë™ì‘ ì›ë¦¬ ì´í•´**
2. **shared ì˜ì¡´ì„± ê´€ë¦¬ì˜ ì¤‘ìš”ì„±**
3. **íƒ€ì… ì‹œìŠ¤í…œ êµ¬ì¶• ë°©ë²•**
4. **ì—ëŸ¬ ê²©ë¦¬ íŒ¨í„´**
5. **ë°°í¬ íŒŒì´í”„ë¼ì¸ êµ¬ì¶•**

### ë§ˆì¸ë“œì…‹ìœ¼ë¡œ ë°°ìš´ ê²ƒ

1. **ë³µì¡ë„ ì¦ê°€ëŠ” ëŒ€ê°€ì„**
   - MFAëŠ” ê³µì§œê°€ ì•„ë‹˜
   - ê´€ë¦¬ í¬ì¸íŠ¸ê°€ ëŠ˜ì–´ë‚¨
   - ê·¸ë§Œí•œ ê°€ì¹˜ê°€ ìˆì„ ë•Œë§Œ ì„ íƒ

2. **ì™„ë²½í•œ ë…ë¦½ì€ ì—†ìŒ**
   - ê³µìœ  ì˜ì¡´ì„±ì´ ìˆìœ¼ë©´ ì™„ì „ ë…ë¦½ ë¶ˆê°€
   - ê³„ì•½(ì¸í„°í˜ì´ìŠ¤)ìœ¼ë¡œ ê²°í•©
   - ê²°í•©ë„ë¥¼ ë‚®ì¶œ ë¿, ì—†ì•¨ ìˆœ ì—†ìŒ

3. **ì´ë¡ ê³¼ í˜„ì‹¤ì€ ë‹¤ë¦„**
   - íŠœí† ë¦¬ì–¼ì€ í•´í”¼ ì¼€ì´ìŠ¤ë§Œ
   - ì‹¤ì „ì—ì„œëŠ” ì˜ˆìƒ ëª»í•œ ë¬¸ì œ ë§ìŒ
   - ì‚½ì§ˆì´ ì§„ì§œ í•™ìŠµ

4. **ë„êµ¬ëŠ” ë¬¸ì œ í•´ê²° ìˆ˜ë‹¨**
   - MFAê°€ ëª©ì ì´ ì•„ë‹˜
   - ë¬¸ì œ í•´ê²°ì´ ëª©ì 
   - ì í•©í•˜ì§€ ì•Šìœ¼ë©´ ì•ˆ ì“°ëŠ” ê²Œ ë‚˜ìŒ

### ì´ í”„ë¡œì íŠ¸ë¥¼ ë‹¤ì‹œ í•œë‹¤ë©´

**1. ì²˜ìŒë¶€í„° ëª¨ë‹ˆí„°ë§ êµ¬ì¶•**
ë‚˜ì¤‘ì— ë¶™ì´ë ¤ë‹ˆ ê·€ì°®ì•˜ìŒ. ì²˜ìŒë¶€í„° í•˜ì.

**2. ë” ì—„ê²©í•œ ë²„ì „ ê´€ë¦¬**
ë²„ì „ ë¶ˆì¼ì¹˜ ì´ìŠˆê°€ ë§ì•˜ìŒ. ìë™í™”í•˜ì.

**3. ê³„ì•½ ë¬¸ì„œí™”**
Remoteê°€ ë…¸ì¶œí•˜ëŠ” ê²ƒë“¤ì„ ë¬¸ì„œí™”í•˜ì.

**4. E2E í…ŒìŠ¤íŠ¸ í•„ìˆ˜**
í†µí•© í…ŒìŠ¤íŠ¸ ì—†ìœ¼ë©´ ë°°í¬ ë•Œ ë–¨ë¦¼.

## 12. ë§ˆë¬´ë¦¬

6ê°œì›”ê°„ MFAë¥¼ ì‚½ì§ˆí•˜ë©´ì„œ ì •ë§ ë§ì´ ë°°ì› ìŒ.

- ë¼ìš°íŒ… 2ì£¼ ì‚½ì§ˆ
- Webpack ì„¤ì • 3ì¼ ì‚½ì§ˆ
- ë°°í¬ 1ì£¼ ì‚½ì§ˆ
- íƒ€ì… ë¬¸ì œ ì§€ì†ì  ì‚½ì§ˆ

**ì‚½ì§ˆ = í•™ìŠµ**

ì‚½ì§ˆ ì—†ì´ ì–»ì€ ì§€ì‹ì€ í”¼ìƒì ì„.
ì§ì ‘ ë¶€ë”ªí˜€ë´ì•¼ ì§„ì§œ ì´í•´í•¨.

ì´ ê¸€ë“¤ì´ ëˆ„êµ°ê°€ì˜ ì‚½ì§ˆ ì‹œê°„ì„ ì¤„ì—¬ì¤¬ìœ¼ë©´ ì¢‹ê² ìŒ.

**í™”ì´íŒ…!**

---

*Written by ì†í˜¸ì„±*',
  'MFA í”„ë¡œì íŠ¸ 6ê°œì›”ê°„ì˜ ì‚½ì§ˆì„ ì´ì •ë¦¬. ë²„ì „ ê´€ë¦¬, ê°œë°œ í™˜ê²½, í…ŒìŠ¤íŠ¸, ë””ë²„ê¹…, ìŠ¤íƒ€ì¼ ì¶©ëŒ ë“± ì‹¤ì „ ì´ìŠˆì™€ í•´ê²°ì±….',
  'published',
  true,
  true,
  '9878b01c-1d9e-4b54-8323-f77735445b39',
  now(),
  now(),
  now()
);

-- ìµœì¢… í™•ì¸
SELECT id, title, slug, status FROM blog_posts ORDER BY created_at DESC;
